title,definition
3cx_supply_chain_attack_network_indicators_filter,search *
_unix_alert_threshold_CPU_Exceeds_Percent_by_Host,99
_unix_alert_threshold_CPU_Under_Percent_by_Host,30
_unix_alert_threshold_Disk_Used_Exceeds_Percent_by_Host,90
_unix_alert_threshold_IO_Utilization_Exceeds_Threshold,95
_unix_alert_threshold_IO_Wait_Exceeds_Threshold,10
_unix_alert_threshold_Load_Exceeds_by_Host,5
_unix_alert_threshold_Memory_Exceeds_MB_by_Host,2048
_unix_alert_threshold_Memory_Exceeds_MB_by_Process,1024
_unix_alert_threshold_Memory_Exceeds_Percent_by_Host,90
_unix_alert_threshold_Open_Files_Exceeds_by_Process,200
_unix_alert_threshold_Processes_Exceeds_by_Host,100
_unix_alert_threshold_Threads_Exceeds_by_Host,250
abnormally_high_aws_instances_launched_by_user___mltk_filter,search *
abnormally_high_aws_instances_launched_by_user_filter,search *
abnormally_high_aws_instances_terminated_by_user___mltk_filter,search *
abnormally_high_aws_instances_terminated_by_user_filter,search *
abnormally_high_number_of_cloud_infrastructure_api_calls_filter,search *
abnormally_high_number_of_cloud_instances_destroyed_filter,search *
abnormally_high_number_of_cloud_instances_launched_filter,search *
abnormally_high_number_of_cloud_security_group_api_calls_filter,search *
access_lsass_memory_for_dump_creation_filter,search *
access_to_vulnerable_ivanti_connect_secure_bookmark_endpoint_filter,search *
account_discovery_with_net_app_filter,search *
active_directory_lateral_movement_identified_filter,search *
active_directory_privilege_escalation_identified_filter,search *
active_setup_registry_autostart_filter,search *
add_defaultuser_and_password_in_registry_filter,search *
add_dm_object_name(1),"rename * as ""$object$.*"""
add_or_set_windows_defender_exclusion_filter,search *
Addresses_by_Host(1),"`os_index` `netstat_sourcetype` host=$host$ | head 1 | multikv fields ForeignAddress | rex field=ForeignAddress ""(?<hostOnly>^.*)[:\.].+$"" | fields + hostOnly | where hostOnly != ""*"" | rename hostOnly as Address | chart count by Address | sort count desc | rename count as ""# of Connections to This Address"""
admon,source=ActiveDirectory
adobe_coldfusion_access_control_bypass_filter,search *
adobe_coldfusion_unauthenticated_arbitrary_file_read_filter,search *
adsisearcher_account_discovery_filter,search *
alert_detail_cpu_basesearch(1),"`os_index` `cpu_sourcetype`  host=$HOST$ | search CPU=""all"" | convert mktime(_time) as time | table _time, time, host, sourcetype, pctUser, pctSystem"
alert_detail_lsof_basesearch(1),"`os_index` `lsof_sourcetype` host=$HOST$ | convert mktime(_time) as time | table _time, time, COMMAND, PID, USER, FD, TYPE, DEVICE, NAME, SIZE"
alert_detail_memory_basesearch(1),"`os_index` `memory_sourcetype` host=$HOST$ | convert mktime(_time) as time | eval memUsed=memUsedMB*1000000 | eval memFree=memFreeMB*1000000 | table _time, time, sourcetype, host, memFreePct, memUsedPct, memFree, memUsed, processes, threads"
alert_detail_netstat_basesearch(1),"`os_index` `netstat_sourcetype` host=$HOST$ | convert mktime(_time) as time | table _time, time, Proto, Recv_Q, Send_Q, LocalAddress, ForeignAddress, State"
alert_detail_ps_basesearch(1),"`os_index` `ps_sourcetype` host=$HOST$ | eval RSZ=RSZ_KB * 1024 | eval VSZ=VSZ_KB * 1024 | convert mktime(_time) as time | table _time, time, USER, PID, PSR, pctCPU, CPUTIME, pctMEM, RSZ, VSZ, S, ELAPSED, COMMAND, ARGS"
alert_events,"index=unix_summary | stats first(hosts) as hosts first(host_count) as host_count by severity sid time_fired search_name | rename time_fired as trigger_time | rename search_name as ss_name | join ss_name [| rest /services/unix/alert_overlay splunk_server=local| fillnull value="""" business_impact description escalation remediation | fields - eai:* | rename title as ss_name ] | eval severity=case(severity==1, ""Low"", severity==2, ""Medium"", severity==3, ""Medium"", severity==4, ""Medium"", severity==5, ""High"") | makemv hosts | mvexpand hosts | sort +trigger_time"
allow_file_and_printing_sharing_in_firewall_filter,search *
allow_inbound_traffic_by_firewall_rule_registry_filter,search *
allow_inbound_traffic_in_firewall_rule_filter,search *
allow_network_discovery_in_firewall_filter,search *
allow_operation_with_consent_admin_filter,search *
amazon_eks_kubernetes_cluster_scan_detection_filter,search *
amazon_eks_kubernetes_pod_scan_detection_filter,search *
amazon_security_lake,sourcetype=aws:asl
anomalous_usage_of_7zip_filter,search *
any_powershell_downloadfile_filter,search *
any_powershell_downloadstring_filter,search *
asl_aws_concurrent_sessions_from_different_ips_filter,search *
asl_aws_createaccesskey_filter,search *
asl_aws_defense_evasion_delete_cloudtrail_filter,search *
asl_aws_defense_evasion_delete_cloudwatch_log_group_filter,search *
asl_aws_defense_evasion_impair_security_services_filter,search *
asl_aws_excessive_security_scanning_filter,search *
asl_aws_iam_delete_policy_filter,search *
asl_aws_multi_factor_authentication_disabled_filter,search *
asl_aws_new_mfa_method_registered_for_user_filter,search *
asl_aws_password_policy_changes_filter,search *
attacker_tools_on_endpoint_filter,search *
attempt_to_add_certificate_to_untrusted_store_filter,search *
attempt_to_stop_security_service_filter,search *
attempted_credential_dump_from_registry_via_reg_exe_filter,search *
audit_rexsearch,"rex ""search='(?<search>.*?)', autojoin"""
audit_searches,index=_audit sourcetype=audittrail action=search
audit_searchlocal,"`audit_searchlocal(""search_id!=rt_*"")`"
audit_searchlocal(1),"search index=_audit action=search (id=* OR search_id=*) | eval search_id = if(isnull(search_id), id, search_id) | replace '*' with * in search_id | search $filter$"
audittrail,index=_audit sourcetype=audittrail
auto_admin_logon_registry_entry_filter,search *
aws-account-index,index=summary sourcetype=aws:addon:account source=Splunk_TA_aws
aws-input-index,index=summary sourcetype=aws:addon:input source=Splunk_TA_aws
aws_ami_atttribute_modification_for_exfiltration_filter,search *
aws_cloud_provisioning_from_previously_unseen_city_filter,search *
aws_cloud_provisioning_from_previously_unseen_country_filter,search *
aws_cloud_provisioning_from_previously_unseen_ip_address_filter,search *
aws_cloud_provisioning_from_previously_unseen_region_filter,search *
aws_cloudwatchlogs_eks,"sourcetype=""aws:cloudwatchlogs:eks"""
aws_concurrent_sessions_from_different_ips_filter,search *
aws_config,sourcetype=aws:config
aws_console_login_failed_during_mfa_challenge_filter,search *
aws_create_policy_version_to_allow_all_resources_filter,search *
aws_createaccesskey_filter,search *
aws_createloginprofile_filter,search *
aws_credential_access_failed_login_filter,search *
aws_credential_access_getpassworddata_filter,search *
aws_credential_access_rds_password_reset_filter,search *
aws_cross_account_activity_from_previously_unseen_account_filter,search *
aws_defense_evasion_delete_cloudtrail_filter,search *
aws_defense_evasion_delete_cloudwatch_log_group_filter,search *
aws_defense_evasion_impair_security_services_filter,search *
aws_defense_evasion_putbucketlifecycle_filter,search *
aws_defense_evasion_stop_logging_cloudtrail_filter,search *
aws_defense_evasion_update_cloudtrail_filter,search *
aws_description,"sourcetype=""aws:description"""
aws_detect_attach_to_role_policy_filter,search *
aws_detect_permanent_key_creation_filter,search *
aws_detect_role_creation_filter,search *
aws_detect_sts_assume_role_abuse_filter,search *
aws_detect_sts_get_session_token_abuse_filter,search *
aws_detect_users_creating_keys_with_encrypt_policy_without_mfa_filter,search *
aws_detect_users_with_kms_keys_performing_encryption_s3_filter,search *
aws_disable_bucket_versioning_filter,search *
aws_ec2_snapshot_shared_externally_filter,search *
aws_ecr_container_scanning_findings_high_filter,search *
aws_ecr_container_scanning_findings_low_informational_unknown_filter,search *
aws_ecr_container_scanning_findings_medium_filter,search *
aws_ecr_container_upload_outside_business_hours_filter,search *
aws_ecr_container_upload_unknown_user_filter,search *
aws_ecr_users,userName IN (user)
aws_eks_kubernetes_cluster_sensitive_object_access_filter,search *
aws_excessive_security_scanning_filter,search *
aws_exfiltration_via_anomalous_getobject_api_activity_filter,search *
aws_exfiltration_via_batch_service_filter,search *
aws_exfiltration_via_bucket_replication_filter,search *
aws_exfiltration_via_datasync_task_filter,search *
aws_exfiltration_via_ec2_snapshot_filter,search *
aws_high_number_of_failed_authentications_for_user_filter,search *
aws_high_number_of_failed_authentications_from_ip_filter,search *
aws_iam_accessdenied_discovery_events_filter,search *
aws_iam_assume_role_policy_brute_force_filter,search *
aws_iam_delete_policy_filter,search *
aws_iam_failure_group_deletion_filter,search *
aws_iam_successful_group_deletion_filter,search *
aws_lambda_updatefunctioncode_filter,search *
aws_multi_factor_authentication_disabled_filter,search *
aws_multiple_failed_mfa_requests_for_user_filter,search *
aws_multiple_users_failing_to_authenticate_from_ip_filter,search *
aws_network_access_control_list_created_with_all_open_ports_filter,search *
aws_network_access_control_list_deleted_filter,search *
aws_new_mfa_method_registered_for_user_filter,search *
aws_password_policy_changes_filter,search *
aws_s3_accesslogs,sourcetype=aws:s3:accesslogs
aws_s3_exfiltration_behavior_identified_filter,search *
aws_saml_access_by_provider_user_and_principal_filter,search *
aws_saml_update_identity_provider_filter,search *
aws_securityhub_finding,"sourcetype=""aws:securityhub:finding"""
aws_securityhub_firehose,"sourcetype=""aws:securityhub:firehose"""
aws_setdefaultpolicyversion_filter,search *
aws_successful_console_authentication_from_multiple_ips_filter,search *
aws_successful_single_factor_authentication_filter,search *
aws_unusual_number_of_failed_authentications_from_ip_filter,search *
aws_updateloginprofile_filter,search *
azure_active_directory_high_risk_sign_in_filter,search *
azure_ad_application_administrator_role_assigned_filter,search *
azure_ad_authentication_failed_during_mfa_challenge_filter,search *
azure_ad_block_user_consent_for_risky_apps_disabled_filter,search *
azure_ad_concurrent_sessions_from_different_ips_filter,search *
azure_ad_device_code_authentication_filter,search *
azure_ad_external_guest_user_invited_filter,search *
azure_ad_global_administrator_role_assigned_filter,search *
azure_ad_high_number_of_failed_authentications_for_user_filter,search *
azure_ad_high_number_of_failed_authentications_from_ip_filter,search *
azure_ad_multi_factor_authentication_disabled_filter,search *
azure_ad_multi_source_failed_authentications_spike_filter,search *
azure_ad_multiple_appids_and_useragents_authentication_spike_filter,search *
azure_ad_multiple_denied_mfa_requests_for_user_filter,search *
azure_ad_multiple_failed_mfa_requests_for_user_filter,search *
azure_ad_multiple_users_failing_to_authenticate_from_ip_filter,search *
azure_ad_new_custom_domain_added_filter,search *
azure_ad_new_federated_domain_added_filter,search *
azure_ad_new_mfa_method_registered_filter,search *
azure_ad_new_mfa_method_registered_for_user_filter,search *
azure_ad_oauth_application_consent_granted_by_user_filter,search *
azure_ad_pim_role_assigned_filter,search *
azure_ad_pim_role_assignment_activated_filter,search *
azure_ad_privileged_authentication_administrator_role_assigned_filter,search *
azure_ad_privileged_role_assigned_filter,search *
azure_ad_privileged_role_assigned_to_service_principal_filter,search *
azure_ad_service_principal_created_filter,search *
azure_ad_service_principal_new_client_credentials_filter,search *
azure_ad_service_principal_owner_added_filter,search *
azure_ad_successful_authentication_from_different_ips_filter,search *
azure_ad_successful_powershell_authentication_filter,search *
azure_ad_successful_single_factor_authentication_filter,search *
azure_ad_tenant_wide_admin_consent_granted_filter,search *
azure_ad_unusual_number_of_failed_authentications_from_ip_filter,search *
azure_ad_user_consent_blocked_for_risky_application_filter,search *
azure_ad_user_consent_denied_for_oauth_application_filter,search *
azure_ad_user_enabled_and_password_reset_filter,search *
azure_ad_user_immutableid_attribute_updated_filter,search *
azure_audit,sourcetype=mscs:azure:audit
azure_automation_account_created_filter,search *
azure_automation_runbook_created_filter,search *
azure_monitor_aad,sourcetype=azure:monitor:aad
azure_runbook_webhook_created_filter,search *
azuread,sourcetype=mscs:azure:eventhub
base64decode(1),"eval b64x_split=split($b64in$,"""") | lookup char_conversion_matrix base64char as b64x_split OUTPUT base64bin as b64x_bin | eval b64x_join=mvjoin(b64x_bin,"""") | rex field=b64x_join ""(?<b64x_by8>.{8})"" max_match=0 | lookup char_conversion_matrix bin as b64x_by8 output ascii as b64x_out | eval $b64in$_decode=mvjoin(b64x_out,"""") | fields - b64x_* | eval $b64in$_decode = replace(replace($b64in$_decode,"":NUL:"",""""),"":SPACE:"","" "") | rex field=$b64in$_decode mode=sed ""s/\x00//g"""
batch_file_write_to_system32_filter,search *
bcdedit_command_back_to_normal_mode_boot_filter,search *
bcdedit_failure_recovery_modification_filter,search *
bits_job_persistence_filter,search *
bitsadmin_download_file_filter,search *
bootloader_inventory,sourcetype = PwSh:bootloader
brand_abuse_dns,lookup update=true brandMonitoring_lookup domain as query OUTPUT domain_abuse | search domain_abuse=true
brand_abuse_email,lookup update=true brandMonitoring_lookup domain as src_user OUTPUT domain_abuse | search domain_abuse=true
brand_abuse_web,lookup update=true brandMonitoring_lookup domain as urls OUTPUT domain_abuse | search domain_abuse=true
cam_action_modes,inputlookup append=T cam_action_mode_lookup | eval action_mode=lower(action_mode) | dedup action_mode | sort + action_mode
cam_action_statuses,inputlookup append=T cam_action_status_lookup | eval action_status=lower(action_status) | dedup action_status | sort + action_status
cam_categories,inputlookup append=T cam_category_lookup | dedup category | sort + category
cam_subjects,inputlookup append=T cam_subject_lookup | eval subject=lower(subject) | dedup subject | sort + subject
cam_tasks,inputlookup append=T cam_task_lookup | eval task=lower(task) | dedup task | sort + task
cam_workers,"inputlookup append=T cam_worker_lookup | append[| makeresults | eval worker_set=""local"",cam_workers=""[\""local\""]""] | dedup worker_set | spath input=cam_workers | where isnotnull('{}') | table worker_set,cam_workers | sort + worker_set"
capi2_operational,(source=XmlWinEventLog:Microsoft-Windows-CAPI2/Operational)
certificateservices_lifecycle,(source=XmlWinEventLog:Microsoft-Windows-CertificateServicesClient-Lifecycle-System/Operational OR source=XmlWinEventLog:Microsoft-Windows-CertificateServicesClient-Lifecycle-User/Operational)
certutil_download_with_urlcache_and_split_arguments_filter,search *
certutil_download_with_verifyctl_and_split_arguments_filter,search *
certutil_exe_certificate_extraction_filter,search *
certutil_with_decode_argument_filter,search *
change_default_file_association_filter,search *
change_to_safe_mode_with_network_config_filter,search *
chcp_command_execution_filter,search *
check_elevated_cmd_using_whoami_filter,search *
child_processes_of_spoolsv_exe_filter,search *
cim_access_actions,inputlookup append=T cim_access_action_lookup | eval action=lower(action) | dedup action
cim_Alerts_indexes,(index=botsv* earliest=0)
cim_Application_State_indexes,(index=botsv* earliest=0)
cim_Authentication_indexes,(index=botsv* earliest=0)
cim_Certificates_indexes,(index=botsv* earliest=0)
cim_Change_Analysis_indexes,()
cim_Change_indexes,(index=botsv* earliest=0)
cim_Compute_Inventory_indexes,()
cim_corporate_email_domain_search(1),[| `cim_corporate_email_domains` | rename domain as $field$ | format | fields search]
cim_corporate_email_domains,inputlookup append=T cim_corporate_email_domain_lookup
cim_corporate_web_domain_search(1),[| `cim_corporate_web_domains` | rename domain as $field$ | format | fields search]
cim_corporate_web_domains,inputlookup append=T cim_corporate_web_domain_lookup
cim_Data_Access_indexes,(index=botsv* earliest=0)
cim_Databases_indexes,(index=botsv* earliest=0)
cim_datamodelinfo,"rest /services/admin/summarization by_tstats=t splunk_server=local count=0 | eval key=replace('title',""tstats:DM_"".'eai:acl.app'.""_"",""""),datamodel=replace('summary.id',""DM_"".'eai:acl.app'.""_"","""") | join type=left key [| rest /services/data/models splunk_server=local count=0 | table title acceleration.cron_schedule eai:digest | rename title as key | rename acceleration.cron_schedule AS cron] | table datamodel eai:acl.app summary.access_time summary.is_inprogress summary.size summary.latest_time summary.complete summary.buckets_size summary.buckets cron summary.last_error summary.time_range summary.id summary.mod_time eai:digest summary.earliest_time summary.last_sid summary.access_count | rename summary.id AS summary_id, summary.time_range AS retention, summary.earliest_time as earliest, summary.latest_time as latest, eai:digest as digest | rename summary.* AS *, eai:acl.* AS * | sort datamodel"
cim_dlp_actions,inputlookup append=T cim_dlp_action_lookup | eval action=lower(action) | dedup action | sort + action
cim_DLP_indexes,(index=botsv* earliest=0)
cim_dlp_object_categories,inputlookup append=T cim_dlp_object_category_lookup | eval object_category=lower(object_category) | dedup object_category | sort + object_category
cim_dlp_types,inputlookup append=T cim_dlp_type_lookup | eval dlp_type=lower(dlp_type) | dedup dlp_type | sort + dlp_type
cim_dns_reply_codes,inputlookup append=T cim_dns_reply_code_lookup | dedup reply_code | sort + reply_code
cim_Email_indexes,(index=botsv* earliest=0)
cim_email_protocols,inputlookup append=T cim_email_protocol_lookup | sort + protocol
cim_endpoint_actions,inputlookup append=T cim_endpoint_action_lookup | eval action=lower(action) | dedup action | sort + action
cim_Endpoint_indexes,(index=botsv* earliest=0)
cim_endpoint_object_categories,inputlookup append=T cim_endpoint_object_category_lookup | eval object_category=lower(object_category) | dedup object_category | sort + object_category
cim_endpoint_severities,inputlookup append=T cim_endpoint_severity_lookup | eval severity=lower(severity) | dedup severity
cim_endpoint_statuses,inputlookup append=T cim_endpoint_status_lookup | eval status=lower(status) | dedup status | sort + status
cim_endpoint_user_types,inputlookup append=T cim_endpoint_user_type_lookup | eval user_type=lower(user_type) | dedup user_type | sort + user_type
cim_Event_Signatures_indexes,(index=botsv* earliest=0)
cim_filter_known_scanners,"NOT (host_category=""known_scanner"" OR orig_host_category=""known_scanner"" OR dvc_category=""known_scanner"" OR src_category=""known_scanner"" OR dest_category=""known_scanner"")"
cim_filter_known_scanners(1),"NOT ($object$.host_category=""known_scanner"" OR $object$.orig_host_category=""known_scanner"" OR $object$.dvc_category=""known_scanner"" OR $object$.src_category=""known_scanner"" OR $object$.dest_category=""known_scanner"")"
cim_filter_unknown_values(1),"($field$!=""-"" $field$!=""n/a"" $field$!=""unknown"")"
cim_filter_vuln_severity,"(severity!=""informational"" AND severity!=""low"")"
cim_filter_vuln_severity(1),"($object$.severity!=""informational"" AND $object$.severity!=""low"")"
cim_http_methods,inputlookup append=T cim_http_method_lookup | eval http_method=lower(http_method) | dedup http_method
cim_http_statuses,inputlookup append=T cim_http_status_lookup
cim_ids_severities,inputlookup append=T cim_ids_severity_lookup | eval severity=lower(severity) | dedup severity
cim_ids_types,inputlookup append=T cim_ids_type_lookup | eval ids_type=lower(ids_type) | dedup ids_type | sort + ids_type
cim_Interprocess_Messaging_indexes,(index=botsv* earliest=0)
cim_Intrusion_Detection_indexes,(index=botsv* earliest=0)
cim_JVM_indexes,(index=botsv* earliest=0)
cim_malware_actions,inputlookup append=T cim_malware_action_lookup | eval action=lower(action) | dedup action | sort + action
cim_Malware_indexes,(index=botsv* earliest=0)
cim_Network_Resolution_indexes,(index=botsv* earliest=0)
cim_Network_Sessions_indexes,(index=botsv* earliest=0)
cim_Network_Traffic_indexes,(index=botsv* earliest=0)
cim_Performance_indexes,()
cim_Ticket_Management_indexes,()
cim_traffic_actions,inputlookup append=T cim_traffic_action_lookup | eval action=lower(action) | dedup action | sort + action
cim_transport_protocols,inputlookup append=T cim_transport_protocol_lookup | eval transport=lower(transport) | dedup transport | sort + transport
cim_update_statii,inputlookup append=T cim_update_status_lookup | eval status=lower(status) | dedup status | sort + status
cim_Updates_indexes,()
cim_vendor_product_tracker,inputlookup append=T cim_vendor_product_tracker
cim_vuln_severities,inputlookup append=T cim_vuln_severity_lookup | eval severity=lower(severity) | dedup severity
cim_Vulnerabilities_indexes,(index=botsv* earliest=0)
cim_Web_indexes,(index=botsv* earliest=0)
circle_ci_disable_security_job_filter,search *
circle_ci_disable_security_step_filter,search *
circleci,sourcetype=circleci
cisco_ios_xe_implant_access_filter,search *
cisco_networks,eventtype=cisco_ios
citrix_adc_and_gateway_unauthorized_data_disclosure_filter,search *
citrix_adc_exploitation_cve_2023_3519_filter,search *
citrix_sharefile_exploitation_cve_2023_24489_filter,search *
clear_unallocated_sector_using_cipher_app_filter,search *
clients_connecting_to_multiple_dns_servers_filter,search *
clop_common_exec_parameter_filter,search *
clop_ransomware_known_service_name_filter,search *
cloud_api_calls_from_previously_unseen_user_roles_activity_window,"""-70m@m"""
cloud_api_calls_from_previously_unseen_user_roles_filter,search *
cloud_compute_instance_created_by_previously_unseen_user_filter,search *
cloud_compute_instance_created_in_previously_unused_region_filter,search *
cloud_compute_instance_created_with_previously_unseen_image_filter,search *
cloud_compute_instance_created_with_previously_unseen_instance_type_filter,search *
cloud_domain_search(1),[| `cloud_domains` | rename domain as $field$ | fields $field$ | format | fields search]
cloud_domains,inputlookup append=T cim_cloud_domain_lookup
cloud_email_search(1),[| `cloud_domains` | search is_email=true | rename domain as $field$ | fields $field$ | format | fields search]
cloud_instance_modified_by_previously_unseen_user_filter,search *
cloud_network_access_control_list_deleted_filter,search *
cloud_provisioning_activity_from_previously_unseen_city_filter,search *
cloud_provisioning_activity_from_previously_unseen_country_filter,search *
cloud_provisioning_activity_from_previously_unseen_ip_address_filter,search *
cloud_provisioning_activity_from_previously_unseen_region_filter,search *
cloud_storage_search(1),[| `cloud_domains` | search is_storage=true | rename domain as $field$ | fields $field$ | format | fields search]
cloudtrail,sourcetype=aws:cloudtrail
cloudwatch_eks,"sourcetype=""aws:cloudwatchlogs:eks"""
cloudwatch_vpc,sourcetype=aws:cloudwatchlogs:vpcflow
cloudwatchlogs_vpcflow,sourcetype=aws:cloudwatchlogs:vpcflow
cmd_carry_out_string_command_parameter_filter,search *
cmd_echo_pipe___escalation_filter,search *
cmdline_tool_not_executed_in_cmd_shell_filter,search *
cmlua_or_cmstplua_uac_bypass_filter,search *
cobalt_strike_named_pipes_filter,search *
code42_alertlog,eventtype=code42_alertlog
code42_api,eventtype=code42_api
code42_cloud_file_activities_detail(1),"eventtype=code42_security eventType=""PERSONAL_CLOUD_FILE_ACTIVITY"" user=""$selected_username$"" |`code42_parse_security(""formattedTimestamp user productName eventUid csp_path"")`| search NOT f0=""DELETE""| stats last(formattedTimestamp) as ""Detected At"" values(user) as User values(productName) as Product values(f0) as Event sum(f1) as length values(f2) as fileName values(f32) as fullPath values(csp_path) as ""Location Path"" by eventUid md5 | rename fileName AS ""File Name"" fullPath as Path |eventstats dc(md5) as ""Total Files"" sum(length) as ""Total Bytes"" by eventUid | table eventUid ""Detected At"" ""Total Files"" ""Total Bytes"" User Product Event md5 ""File Name"" ""Location Path"""
code42_computer,eventtype=code42_computer
code42_configured_inputs,metadata type=hosts sourcetype=code42:* | stats count by host| rename host as hostname
code42_ctc_backup_counts,"(eventtype=code42_idx sourcetype=""code42:computer"" active=""true"")| stats latest(*) as * by guid  | rename backupUsage{}.* as * | fields lastCompletedBackup guid active | eval time_since_backup=if(isnull(strptime(lastCompletedBackup,""%Y-%m-%dT%H:%M:%S.%3N%:z"")), -1,(now() - strptime(lastCompletedBackup,""%Y-%m-%dT%H:%M:%S.%3N%:z""))) | eval tsb=if(isnull(time_since_backup),0,time_since_backup)| rangemap field=tsb default=high low=1-86400 low-mid=86401-259200 mid=432000-2591999 mid-high=2592000-9999999 | rename range as Severity | eval Severity=case((Severity == ""low""),""< 24 hours"",(Severity == ""low-mid""),""24-72 hours"",(Severity == ""mid""),""5-29 days"",(Severity == ""mid-high""),""> 29 days"",(Severity == ""high""),""Never completed"") | stats count by Severity | eval idx=1 | append [| makeresults | eval Severity=mvappend(""< 24 hours"",""24-72 hours"",""5-29 days"",""> 29 days"",""Never completed"") | mvexpand Severity | fields - _time | eval idx=0, count=0] | sort Severity idx | selfjoin max=1 overwrite=1 keepsingle=1 Severity | fields - idx | sort - count"
code42_devices_appeared(1),"eventtype=code42_security eventType=""DEVICE_APPEARED"" user=""$selected_username$"" | rename detectionDevice.* as * | rename busType as ""Device Type"", capacity as ""Capacity"", deviceName as ""Device Name"", serialNumber as ""Serial Number"", deviceAddress as ""IP Address"", user as User, vendorName as Vendor formattedTimestamp as ""Detected At"" | fields ""Detected At"" User ""IP Address"" ""Device Type"" ""Vendor"" ""Device Name"" ""Serial Number"" Capacity | fields - _* | table *"
code42_devices_file_activities_detail(1),"eventtype=code42_security eventType=""DEVICE_FILE_ACTIVITY"" user=""$selected_username$"" | `code42_parse_security(""formattedTimestamp user deviceAddress eventUid"")`| search NOT f0=""DELETE""| stats last(formattedTimestamp) as ""Detected At"" values(user) as User last(deviceAddress) as ""IP Address"" values(f0) as Event sum(f1) as length values(f2) as fileName values(f32) as fullPath  by eventUid md5| rename fileName AS ""File Name"" fullPath as Path |eventstats dc(md5) as ""Total Files"" sum(length) as ""Total Bytes"" by eventUid | table eventUid ""Detected At"" ""Total Files"" ""Total Bytes"" User ""IP Address"" Event md5 ""File Name"" Path"
code42_error,eventtype=code42_error | table *
code42_error_panel_base,`code42_error` | table *
code42_file_open_detail(1),"eventtype=code42_security eventType=""FILE_OPENED"" user=""$selected_username$"" | `code42_parse_security(""formattedTimestamp eventUid user deviceAddress processName"")`| search NOT f0=""DELETE""| stats last(formattedTimestamp) as ""Detected At"" values(user) as User values(processName) as ProcessName values(f0) as Event sum(f1) as length values(f2) as fileName values(f32) as fullPath by eventUid md5| rename fileName AS ""File Name"" fullPath as Path |eventstats dc(md5) as ""Total Files"" sum(length) as ""Total Bytes"" by eventUid | table eventUid ""Detected At"" ""Total Files"" ""Total Bytes"" User Event md5 ""File Name"" ProcessName"
code42_generate_alert_lookup,"eventtype=code42_alertlog | stats latest(status) AS status by type,description,server,severity | outputlookup code42_alertlog"
code42_generate_computer_lookup,eventtype=code42_computer | stats latest(*) as * by source computerId |fields source computerId name | outputlookup code42_computers
code42_generate_user_lookup,eventtype=code42_user | stats latest(*) as * by source userUid | fields source userId userUid username | outputlookup code42_users
code42_idx,eventtype=code42_idx
code42_incomplete_backups,"eventtype=code42_idx sourcetype=""code42:computer"" ""backupUsage{}.percentComplete""<100.0| rename backupUsage{}.* as backupUsage_* | rename user AS ""User"" ""name"" AS ""Computer Name"" active AS Active backupUsage_percentComplete AS ""Pct Complete"" backupUsage_lastBackup AS ""Last Backup"" backupUsage_lastCompletedBackup AS ""Last Completed Backup"" | table User,""Computer Name"",Active,""Pct Complete"",""Last Backup"",""Last Completed Backup"""
code42_instance_detail_events(1),`code42_computer` $selected_computer$ | stats latest(name) AS name latest(status) AS status latest(blocked) AS blocked latest(alertStates{}) AS alertState latest(backupUsage{}.archiveBytes) AS archiveBytes latest(creationDate) AS creationDate latest(backupUsage{}.lastConnected) AS lastConnected latest(backupUsage{}.lastBackup) AS lastBackup latest(backupUsage{}.lastCompletedBackup) AS lastCompletedBackup latest(backupUsage{}.percentComplete) AS percentComplete latest(backupUsage{}.targetComputerName) AS backupTarget latest(user) as User by guid
code42_instance_restore_details(1),"eventtype=code42_restore user=""$selected_username$"" | eval gb_bytes = round(restoreBytes/1024/1024/1024,3) | stats sum(restoreFiles) as ""Total Files"" sum(gb_bytes) as ""Total GigaBytes"" latest(*) AS * by restoreId | lookup code42_computers source computerId AS acceptingDeviceId OUTPUT name AS ""Computer Name""| fields user startDate completedDate Total* ""Computer Name"""
code42_last_5_checkpoints_by_event_type(1),"`code42_api` host=""$selected_host$""  | head 5 | rename timestamp AS ""Checkpoint Time""  total_events AS ""Total Events"" | table ""Checkpoint Time"", host, endpoint, ""Total Events"""
code42_last_backup_by_client_by_computer(1),"(eventtype=code42_idx sourcetype=""code42:computer"" $selected_computer$ active=""true"")| stats latest(*) as * by guid  | rename backupUsage{}.* as * | fields lastCompletedBackup guid active, name, user | eval time_since_backup=if(isnull(strptime(lastCompletedBackup,""%Y-%m-%dT%H:%M:%S.%3N%:z"")),""Never Completed"",(now() - strptime(lastCompletedBackup,""%Y-%m-%dT%H:%M:%S.%3N%:z""))) | eval tsbs=if((time_since_backup == ""Never Completed""),""Never Completed"",tostring(time_since_backup,""duration""))| rex mode=sed field=tsbs ""s/\+/ days, /"" | rex mode=sed field=tsbs ""s/\:/ hours, /"" | rex mode=sed field=tsbs ""s/\:/ minutes and /"" | rex mode=sed field=tsbs ""s/$/ seconds/"" | rex mode=sed field=tsbs ""s/\Q00 hours, \E//"" | rex mode=sed field=tsbs ""s/\Q00 minutes \E//"" | rex mode=sed field=tsbs ""s/\Q 0\E/ /g"" | rex mode=sed field=tsbs ""s/^\Q0\E//"" | rex mode=sed field=tsbs ""s/^\Qand \E//"" | rangemap field=tsb default=Critical OK=1-259200 Warning=259200-2591999 | eval tsbs=if((tsbs == ""Never Completed seconds""),rtrim(tsbs,""seconds""),tsbs) | fields - tsb, guid, active, lastCompletedBackup, time_since_backup | rename name as ""Computer Name"", range as Severity, tsbs as ""Duration Since Last Backup"", username as User"
code42_last_checkpoint,"`code42_api` | stats latest(timestamp) as timestamp by host  |rename timestamp AS ""Checkpoint Time"" | table host, ""Checkpoint Time"""
code42_mc_health_check_api,"`code42_error_panel_base` | eval is_recent = now() - (3600 * 24 * 5), is_recent = if(_time > is_recent,""true"", ""false"")| search is_recent=""true""| stats count AS total_failures, latest(message) as message values(is_recent) as ir values(_time) as time by host | eval severity_level = case(total_failures == 0, 0, total_failures > 0, 3)| rename host AS instance | fields instance total_failures message severity_level"
code42_org,eventtype=code42_org
code42_parse_security(1),"rename files{}.* as files_* cloudStorageProvider.dataLocation.path AS csp_path cloudStorageProvider.productName as productName| eval f0 = mvzip(files_fileEventType, files_length), f1 = mvzip(f0, files_fileName), f2 = mvzip(f1, files_fullPath), final_product_zipped = mvzip(f2, files_md5)| fields final_product_zipped $fields$| mvexpand final_product_zipped | eval t = split(final_product_zipped,"",""), f0 = mvindex(t,0), f1 = mvindex(t,1), f2 = mvindex(t,2), f32 = mvindex(t,3), md5 = mvindex(t,4)"
code42_restore,eventtype=code42_restore
code42_restore_details(1),"eventtype=code42_security eventType=""RESTORE_FILE"" user=""$selected_username$"" | `code42_parse_security(""formattedTimestamp user eventUid"")` | stats latest(formattedTimestamp) as ""Detected At"" values(f0) as Event sum(f1) as length values(f2) as fileName values(f32) as fullPath values(user) as User by eventUid md5 | rename fileName AS ""File Name"" fullPath as ""Full Path"" | eventstats dc(md5) as ""Total Files"" sum(length) as ""Total Bytes""| sort 0 eventUid md5 | table eventUid ""Detected At"" ""Total Bytes"" ""Total Files"" User md5 ""File Name"" ""Full Path"""
code42_security,eventtype=code42_security
code42_user,eventtype=code42_user
code42_zero_cursors,"`code42_zero_kvstore_data(""mi_code42_cursor"")`"
code42_zero_kvstore_data(1),inputlookup $kvstore$ | where nuttzin > 1 | outputlookup $kvstore$
comment(1),""""""
common_ransomware_extensions_filter,search *
common_ransomware_notes_filter,search *
compute-ingestion-stats,"eval temp=1/300.0, event_size=len(_raw) | eval event_size_temp=len(_raw)/300.0 | stats sparkline(sum(temp), 5m) as ""Events per second"", sparkline(sum(event_size_temp), 5m) as ""Event throughput (kbps)"", sum(event_size) as TotalBytes, sum(temp) as tempsum by sourcetype | eval ""Total MB""=round(TotalBytes/1024.0/1024.0,2) | addinfo | eval APS=tempsum/(info_max_time-info_min_time) | eval ""Average events per second""=round(APS*300.0,2) | fields sourcetype ""Events per second"" ""Event throughput (kbps)"" ""Average events per second"" ""Total MB"""
confluence_cve_2023_22515_trigger_vulnerability_filter,search *
confluence_data_center_and_server_privilege_escalation_filter,search *
confluence_pre_auth_rce_via_ognl_injection_cve_2023_22527_filter,search *
confluence_unauthenticated_remote_code_execution_cve_2022_26134_filter,search *
conti_common_exec_parameter_filter,search *
control_loading_from_world_writable_directory_filter,search *
convert_memk(2),"rex field=$sizeField$ ""(?<_terabytes>.*)[tT]"" | eval _size=if(_terabytes >= 0, (_terabytes*1024).""G"", $sizeField$) | convert memk(_size) as $bytesField$"
correlation_by_repository_and_risk_filter,search *
correlation_by_user_and_risk_filter,search *
CPU_Exceeds_Percent_by_Host(1),"`os_index` `cpu_sourcetype` host=* CPU=""all"" | stats avg(pctIdle) as pctIdle by host | eval Percent_CPU_Load = 100 - pctIdle | where Percent_CPU_Load > $threshold$ | eval title=""CPU_Exceeds_Percent_by_Host"" | `unix_alert_decoration` | fields Percent_CPU_Load, host, hosts, host_count, severity, sid, time_fired, _time"
cpu_sourcetype,sourcetype=cpu
CPU_Sum_by_Command_for_Host(1),"`os_index` `ps_sourcetype` host=$host$ | bin _time | stats avg(pctCPU) as pctCPU by _time, PID, COMMAND, host | timechart sum(pctCPU) by COMMAND"
CPU_Under_Percent_by_Host(1),"`os_index` `cpu_sourcetype` host=* CPU=""all"" | stats avg(pctIdle) as pctIdle by host | eval Percent_CPU_Load = 100 - pctIdle | where Percent_CPU_Load < $threshold$ | eval title=""CPU_Under_Percent_by_Host"" | `unix_alert_decoration` | fields Percent_CPU_Load, host, hosts, host_count, severity, sid, time_fired, _time"
CPU_Usage_by_Command_for_Host(1),"`os_index` `ps_sourcetype` host=$host$ | stats sum(pctCPU) as pctCPU by _time,COMMAND | timechart avg(pctCPU) by COMMAND"
CPU_Usage_by_State_for_Host(1),"`os_index` `cpu_sourcetype` host=$host$ | eval pctNice=if(isnull(pctNice), 0, pctNice) | timechart avg(pctUser), avg(pctNice), avg(pctSystem), avg(pctIowait), avg(pctIdle)"
CPU_Usage_by_User_for_Host(1),`os_index` `ps_sourcetype` host=$host$ | timechart avg(pctCPU) by USER
create_local_admin_accounts_using_net_exe_filter,search *
create_or_delete_windows_shares_using_net_exe_filter,search *
create_remote_thread_in_shell_application_filter,search *
create_remote_thread_into_lsass_filter,search *
creation_of_lsass_dump_with_taskmgr_filter,search *
creation_of_shadow_copy_filter,search *
creation_of_shadow_copy_with_wmic_and_powershell_filter,search *
credential_dumping_via_copy_command_from_shadow_copy_filter,search *
credential_dumping_via_symlink_to_shadow_copy_filter,search *
cs_fdr_data_get_index,index=fdr_s3_data OR index=crowdstrike
cs_fdr_data_input(1),"`cs_fdr_data_get_index` ""ta_data.Input""=$input$"
cs_fdrv2_aidmaster_get_index,index=*
cs_fdrv2_appinfo_get_index,index=*
cs_fdrv2_managed_get_index,index=*
cs_fdrv2_notmanaged_get_index,index=*
cs_fdrv2_userinfo_get_index,index=*
csc_net_on_the_fly_compilation_filter,search *
curl_download_and_bash_execution_filter,search *
datamodel(2),datamodel $model$ $object$ search
defender_atp_index,(index=main OR index=*)
defender_index,(index=main OR index=*)
delete_shadowcopy_with_powershell_filter,search *
deleting_of_net_users_filter,search *
deleting_shadow_copies_filter,search *
detect_activity_related_to_pass_the_hash_attacks_filter,search *
detect_api_activity_from_users_without_mfa_filter,search *
detect_arp_poisoning_filter,search *
detect_attackers_scanning_for_vulnerable_jboss_servers_filter,search *
detect_aws_api_activities_from_unapproved_accounts_filter,search *
detect_aws_console_login_by_new_user_filter,search *
detect_aws_console_login_by_user_from_new_city_filter,search *
detect_aws_console_login_by_user_from_new_country_filter,search *
detect_aws_console_login_by_user_from_new_region_filter,search *
detect_azurehound_command_line_arguments_filter,search *
detect_azurehound_file_modifications_filter,search *
detect_baron_samedit_cve_2021_3156_filter,search *
detect_baron_samedit_cve_2021_3156_segfault_filter,search *
detect_baron_samedit_cve_2021_3156_via_osquery_filter,search *
detect_certify_command_line_arguments_filter,search *
detect_certify_with_powershell_script_block_logging_filter,search *
detect_certipy_file_modifications_filter,search *
detect_computer_changed_with_anonymous_account_filter,search *
detect_copy_of_shadowcopy_with_script_block_logging_filter,search *
detect_credential_dumping_through_lsass_access_filter,search *
detect_dga_domains_using_pretrained_model_in_dsdl_filter,search *
detect_dns_data_exfiltration_using_pretrained_model_in_dsdl_filter,search *
detect_dns_requests_to_phishing_sites_leveraging_evilginx2_filter,search *
detect_empire_with_powershell_script_block_logging_filter,search *
detect_excessive_account_lockouts_from_endpoint_filter,search *
detect_excessive_user_account_lockouts_filter,search *
detect_exchange_web_shell_filter,search *
detect_f5_tmui_rce_cve_2020_5902_filter,search *
detect_gcp_storage_access_from_a_new_ip_filter,search *
detect_hosts_connecting_to_dynamic_domain_providers_filter,search *
detect_html_help_renamed_filter,search *
detect_html_help_spawn_child_process_filter,search *
detect_html_help_url_in_command_line_filter,search *
detect_html_help_using_infotech_storage_handlers_filter,search *
detect_ipv6_network_infrastructure_threats_filter,search *
detect_large_outbound_icmp_packets_filter,search *
detect_long_dns_txt_record_response_filter,search *
detect_malicious_requests_to_exploit_jboss_servers_filter,search *
detect_mimikatz_using_loaded_images_filter,search *
detect_mimikatz_via_powershell_and_eventcode_4703_filter,search *
detect_mimikatz_with_powershell_script_block_logging_filter,search *
detect_mshta_inline_hta_execution_filter,search *
detect_mshta_renamed_filter,search *
detect_mshta_url_in_command_line_filter,search *
detect_new_api_calls_from_user_roles_filter,search *
detect_new_local_admin_account_filter,search *
detect_new_login_attempts_to_routers_filter,search *
detect_new_open_gcp_storage_buckets_filter,search *
detect_new_open_s3_buckets_filter,search *
detect_new_open_s3_buckets_over_aws_cli_filter,search *
detect_new_user_aws_console_login_filter,search *
detect_outbound_ldap_traffic_filter,search *
detect_outbound_smb_traffic_filter,search *
detect_outlook_exe_writing_a_zip_file_filter,search *
detect_path_interception_by_creation_of_program_exe_filter,search *
detect_port_security_violation_filter,search *
detect_processes_used_for_system_network_configuration_discovery_filter,search *
detect_prohibited_applications_spawning_cmd_exe_filter,search *
detect_psexec_with_accepteula_flag_filter,search *
detect_rare_executables_filter,search *
detect_rclone_command_line_usage_filter,search *
detect_regasm_spawning_a_process_filter,search *
detect_regasm_with_network_connection_filter,search *
detect_regasm_with_no_command_line_arguments_filter,search *
detect_regsvcs_spawning_a_process_filter,search *
detect_regsvcs_with_network_connection_filter,search *
detect_regsvcs_with_no_command_line_arguments_filter,search *
detect_regsvr32_application_control_bypass_filter,search *
detect_renamed_7_zip_filter,search *
detect_renamed_psexec_filter,search *
detect_renamed_rclone_filter,search *
detect_renamed_winrar_filter,search *
detect_risky_spl_using_pretrained_ml_model_filter,search *
detect_rogue_dhcp_server_filter,search *
detect_rtlo_in_file_name_filter,search *
detect_rtlo_in_process_filter,search *
detect_rundll32_application_control_bypass___advpack_filter,search *
detect_rundll32_application_control_bypass___setupapi_filter,search *
detect_rundll32_application_control_bypass___syssetup_filter,search *
detect_rundll32_inline_hta_execution_filter,search *
detect_s3_access_from_a_new_ip_filter,search *
detect_sharphound_command_line_arguments_filter,search *
detect_sharphound_file_modifications_filter,search *
detect_sharphound_usage_filter,search *
detect_snicat_sni_exfiltration_filter,search *
detect_software_download_to_network_device_filter,search *
detect_spike_in_aws_api_activity_filter,search *
detect_spike_in_aws_security_hub_alerts_for_ec2_instance_filter,search *
detect_spike_in_aws_security_hub_alerts_for_user_filter,search *
detect_spike_in_blocked_outbound_traffic_from_your_aws_filter,search *
detect_spike_in_network_acl_activity_filter,search *
detect_spike_in_s3_bucket_deletion_filter,search *
detect_spike_in_security_group_activity_filter,search *
detect_suspicious_dns_txt_records_using_pretrained_model_in_dsdl_filter,search *
detect_suspicious_processnames_using_pretrained_model_in_dsdl_filter,search *
detect_traffic_mirroring_filter,search *
detect_unauthorized_assets_by_mac_address_filter,search *
detect_usb_device_insertion_filter,search *
detect_use_of_cmd_exe_to_launch_script_interpreters_filter,search *
detect_web_traffic_to_dynamic_domain_providers_filter,search *
detect_webshell_exploit_behavior_filter,search *
detect_windows_dns_sigred_via_splunk_stream_filter,search *
detect_windows_dns_sigred_via_zeek_filter,search *
detect_wmi_event_subscription_persistence_filter,search *
detect_zerologon_via_zeek_filter,search *
detection_of_dns_tunnels_filter,search *
detection_of_tools_built_by_nirsoft_filter,search *
df_sourcetype,sourcetype=df
disable_amsi_through_registry_filter,search *
disable_defender_antivirus_registry_filter,search *
disable_defender_blockatfirstseen_feature_filter,search *
disable_defender_enhanced_notification_filter,search *
disable_defender_mpengine_registry_filter,search *
disable_defender_spynet_reporting_filter,search *
disable_defender_submit_samples_consent_feature_filter,search *
disable_etw_through_registry_filter,search *
disable_logs_using_wevtutil_filter,search *
disable_registry_tool_filter,search *
disable_schedule_task_filter,search *
disable_security_logs_using_minint_registry_filter,search *
disable_show_hidden_files_filter,search *
disable_uac_remote_restriction_filter,search *
disable_windows_app_hotkeys_filter,search *
disable_windows_behavior_monitoring_filter,search *
disable_windows_smartscreen_protection_filter,search *
disabled_kerberos_pre_authentication_discovery_with_get_aduser_filter,search *
disabled_kerberos_pre_authentication_discovery_with_powerview_filter,search *
disabling_cmd_application_filter,search *
disabling_controlpanel_filter,search *
disabling_defender_services_filter,search *
disabling_firewall_with_netsh_filter,search *
disabling_folderoptions_windows_feature_filter,search *
disabling_net_user_account_filter,search *
disabling_norun_windows_app_filter,search *
disabling_remote_user_account_control_filter,search *
disabling_systemrestore_in_registry_filter,search *
disabling_task_manager_filter,search *
disabling_windows_local_security_authority_defences_via_registry_filter,search *
Disk_Used_Exceeds_Percent_by_Host(1),"`os_index` `df_sourcetype` host=* | stats first(PercentUsedSpace) as PercentUsed, values(Type) as Type, values(Size) as Size, values(Used) as Used, values(Avail) as Avail, values(MountedOn) as MountedOn by Filesystem, host | where PercentUsed > $threshold$ | eval title=""Disk_Used_Exceeds_Percent_by_Host"" | `unix_alert_decoration` | fields Filesystem, Type, Size, Used, Avail, PercentUsed, MountedOn, host, hosts, host_count, severity, sid, time_fired, _time"
Disk_Used_Pct_by_Host(1),`os_index` `df_sourcetype` host=$host$ | strcat host '@' Filesystem Host_FileSystem | timechart avg(UsePct) by Host_FileSystem | rename avg(UsePct) as %Used
dllhost_with_no_command_line_arguments_with_network_filter,search *
dmc_audit_get_search_type,"eval search_type = case( 
match(search_id, ""^SummaryDirector_""), ""summarization"", 
match(search_id, ""^((rt_)?scheduler__|alertsmanager_)""), ""scheduled"", 
match(search_id, ""\d{10}\.\d+(_[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})?$""), ""ad hoc"", 
true(), ""other"")"
dmc_audit_get_searches(1),"`dmc_set_index_audit` host=$host$ action=search sourcetype=audittrail search_id!=""rsa_*"" 
| eval user = if(user=""n/a"", null(), user) 
| `dmc_audit_get_search_type` 
| eval search=if(isnull(savedsearch_name) OR savedsearch_name=="""", search, savedsearch_name)"
dmc_audit_get_searches_for_groups(1),"`dmc_set_index_audit` search_group=dmc_group_search_head search_group=""$search_group$"" action=search sourcetype=audittrail search_id!=""rsa_*"" 
| eval user = if(user=""n/a"", null(), user) 
| `dmc_audit_get_search_type` 
| eval search=if(isnull(savedsearch_name) OR savedsearch_name=="""", search, savedsearch_name)"
dmc_audit_searchlocal(1),"search `dmc_set_index_audit` action=search (id=* OR search_id=*) | eval search_id = if(isnull(search_id), id, search_id) | replace '*' with * in search_id | search $filter$"
dmc_background_flush_rangemap,"rangemap field=percent ""0-10%""=0-10 ""10-50%""=10.001-50 ""50-100%""=50.001-100 default=abnormal"
dmc_build_forwarder_assets(1),"`dmc_get_forwarder_tcpin` 
| stats values(fwdType) as forwarder_type, latest(version) as version, values(arch) as arch, values(os) as os, max(_time) as last_connected, sum(kb) as new_sum_kb, sparkline(avg(tcp_KBps), $sparkline_span$) as new_avg_tcp_kbps_sparkline, avg(tcp_KBps) as new_avg_tcp_kbps, avg(tcp_eps) as new_avg_tcp_eps by guid, hostname"
dmc_classify_processes,"eval process_class = case(    
    process==""splunk-optimize"",""index service"",    
    process==""sh"" OR process==""ksh"" OR process==""bash"" OR like(process,""python%"") OR process==""powershell"",""scripted input"",    
    process==""mongod"", ""KVStore"") 
| eval process_class = case(    
    process==""splunkd"" AND (like(args,""-p %start%"") OR like(args,""service"") OR like(args,""%_internal_launch_under_systemd%"")),""splunkd server"",    
    process==""splunkd"" AND isnotnull(sid),""search"",    
    process==""splunkd"" AND (like(args,""fsck%"") OR like(args,""recover-metadata%"") OR like(args,""cluster_thing"")),""index service"",    
    process==""splunkd"" AND args==""instrument-resource-usage"", ""scripted input"",
    (like(process,""python%"") AND like(args,""%/appserver/mrsparkle/root.py%"")) OR like(process,""splunkweb""),""Splunk Web"",    
    isnotnull(process_class), process_class)    
| eval process_class = if(isnull(process_class),""other"",process_class)"
dmc_collection_interval,collection_interval = 10
dmc_convert_count_unit(1),"case( 
$x$ >= 1000000000000, round($x$ / 1000000000000, 2).""T"", 
$x$ >= 1000000000, round($x$ / 1000000000, 2).""B"", 
$x$ >= 1000000, round($x$ / 1000000, 2).""M"", 
$x$ >= 1000, round($x$ / 1000, 2).""K"", 
true(), $x$ 
)"
dmc_convert_disk_usage_unit(1),"case( 
$x$ > 1000000, round($x$ / 1024 / 1024, 2)."" TB"" 
$x$ > 1000, round($x$ / 1024, 2)."" GB"" 
1 == 1, $x$."" MB"" 
)"
dmc_convert_runtime(1),"case( 
round($runtime$ / (3600*24) - 0.5) > 0, round($runtime$ / (3600*24) - 0.5).""d "".round(($runtime$ % (3600*24)) / 3600 - 0.5).""h "".round(($runtime$ % 3600) / 60 - 0.5).""min "".round($runtime$ % 60, 2).""s"", 
round(($runtime$ % (3600*24)) / 3600 - 0.5) > 0, round(($runtime$ % (3600*24)) / 3600 - 0.5).""h "".round(($runtime$ % 3600) / 60 - 0.5).""min "".round($runtime$ % 60, 2).""s"", 
round(($runtime$ % 3600) / 60 - 0.5) > 0, round(($runtime$ % 3600) / 60 - 0.5).""min "".round($runtime$ % 60, 2).""s"", 
1 = 1, round($runtime$ % 60, 2).""s"" 
)"
dmc_cpu_usage_rangemap,"rangemap field=cpu_usage ""0-60%""=0-60 ""60-80%""=60.001-80 ""80-100%""=80.001-100 ""100%+""=100.001-999999 default=abnormal"
dmc_cpu_usage_rangemap_and_timechart,"`dmc_cpu_usage_rangemap` 
| `dmc_timechart` partial=f dc(server) as server_count by range 
| fields _time, ""100%+"", ""80-100%"", ""60-80%"", ""0-60%"""
dmc_daily_license_usage_quota,"rest `dmc_dmc_group_license_master` /services/licenser/pools 
| join type=outer stack_id splunk_server [rest `dmc_dmc_group_license_master` /services/licenser/groups | search is_active=1 | eval stack_id=stack_ids | fields splunk_server stack_id is_active] 
| search is_active=1 
| fields splunk_server, stack_id, used_bytes 
| join type=outer stack_id splunk_server [rest `dmc_dmc_group_license_master` /services/licenser/stacks | eval stack_id=title | eval stack_quota=quota | fields splunk_server stack_id stack_quota] 
| stats sum(used_bytes) as used_bytes max(stack_quota) as stack_quota by splunk_server 
| eval usedGB=round(used_bytes/1024/1024/1024,3) 
| eval totalGB=round(stack_quota/1024/1024/1024,3) 
| eval percentage=round(usedGB / totalGB, 3)*100 
| fields splunk_server, percentage, usedGB, totalGB"
dmc_disk_usage_rangemap,"rangemap field=pct_disk_usage ""0-60%""=0-0.6 ""60-80%""=0.6001-0.8 ""80-100%""=0.8001-1 default=abnormal"
dmc_disk_usage_rangemap_and_timechart,"`dmc_disk_usage_rangemap` 
| `dmc_timechart_for_disk_usage` partial=f dc(server_mount_point) as server_mount_point_count by range 
| fields _time, ""80-100%"", ""60-80%"", ""0-60%"""
dmc_dmc_group_license_master,splunk_server_group=dmc_group_license_master
dmc_drilldown_indexing_performance_deployment_indexing_rate(2),"`dmc_set_index_internal` source=*metrics.log* sourcetype=splunkd search_group=dmc_group_indexer search_group=$group$ group=thruput name=index_thruput 
| stats sum(kb) AS total_kb by host 
| addinfo 
| eval time_window = info_max_time - info_min_time 
| eval kbps = round(total_kb / time_window, 0) 
| `dmc_indexing_rate_rangemap` 
| where range=""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" dmc_group_indexer"" 
| fields serverName, machine, kbps, range, numberOfCores, ram, version, Action
| eval kbps = kbps."" KB/s"" 
| rename serverName as Instance, machine as Machine, kbps as ""Indexing Rate"", range as ""Indexing Rate Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_indexing_performance_deployment_queue_fill_ratio(4),"`dmc_set_index_internal` source=*metrics.log sourcetype=splunkd search_group=dmc_group_indexer search_group=$group$ group=queue name=$queueType$ 
| eval max=if(isnotnull(max_size_kb),max_size_kb,max_size) 
| eval curr=if(isnotnull(current_size_kb),current_size_kb,current_size) 
| eval fill_perc=round((curr/max)*100,2) 
| stats $funcQueue$(fill_perc) AS fill_percentage by host 
| `dmc_queue_fill_ratio_rangemap` 
| where range=""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" dmc_group_indexer"" 
| fields serverName, machine, fill_percentage, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, fill_percentage as ""Fill Ratio (%)"", range as ""Fill Ratio Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_join_peers_by_peerURI,"lookup dmc_assets host OUTPUT peerURI, serverName, machine 
| eval peerURI = mvindex(peerURI, 0) 
| eval machine = mvindex(machine, 0) 
| eval serverName = mvindex(serverName, 0) 
| join type=outer peerURI 
 [| rest splunk_server=local /services/search/distributed/peers 
  | rename title as peerURI 
  | append  
    [| rest splunk_server=local /services/server/info 
     | eval peerURI = ""localhost"" 
    ] 
  | eval ram = round(physicalMemoryMB / 1024, 2)."" GB"" 
  | fields peerURI, version, numberOfCores, ram 
 ] 
| eval Action = serverName 
| fields - _time"
dmc_drilldown_kv_store_deployment_background_flush(2),"`dmc_set_index_introspection` search_group=$group$ search_group=dmc_group_kv_store component=kvstoreserverstats 
| stats range(data.backgroundFlushing.total_ms)  AS diff by  host 
| addinfo 
| eval time_window = info_max_time - info_min_time 
| eval ms_per_min = diff / (time_window / 60) 
| eval percent = round(ms_per_min / (60 * 1000) * 100, 2) 
| `dmc_background_flush_rangemap` 
| where range=""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" dmc_group_kv_store"" 
| fields serverName, machine, percent, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, percent as ""Background Flush (%)"", range as ""Background Flush Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_kv_store_deployment_lock_percentage(3),"`dmc_set_index_introspection` search_group=dmc_group_kv_store  search_group=$group$ component=kvstoreserverstats 
| stats range(data.globalLock.lockTime) AS globalLock range(data.globalLock.totalTime) AS total by host  
| eval percent=abs(globalLock*100/total)   
| stats $countLockFunc$(percent) as percent_locked by host 
| rangemap field=percent_locked ""0-30%""=0-30 ""30-50%""=30.001-50 ""50-100%""=50.001-1000 default=abnormal  
| where range=""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" dmc_group_kv_store"" 
| fields serverName, machine, percent_locked, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, percent_locked as ""Lock (%)"", range as ""Lock Percentage Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_kv_store_deployment_memory_ratio(2),"`dmc_set_index_introspection` search_group=$group$ search_group=dmc_group_kv_store component=kvstoreserverstats 
| eval ratio='data.mem.virtual'/'data.mem.mappedWithJournal' 
| stats avg(ratio) AS myratio by host  
| eval myratio = round(myratio, 2) 
| rangemap field=myratio ""0-2x""=0-2 ""2-3x""=2.001-3 "">3x""=3.001-10000 default=abnormal 
| where range=""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" dmc_group_kv_store"" 
| fields serverName, machine, myratio, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, myratio as ""Virtual to Mapped Ratio"", range as ""Ratio Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_kv_store_deployment_network(1),"`dmc_set_index_introspection` search_group=dmc_group_kv_store search_group=$group$ component=kvstoreserverstats 
| stats range(data.network.bytesIn) as indiff range(data.network.bytesOut) as outdiff range(data.network.numRequests) as Requests by host 
| eval ""MB In""=indiff/1000000 
| eval ""MB Out""=outdiff/1000000 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" dmc_group_kv_store"" 
| table serverName, machine, ""MB In"", ""MB Out"", Requests, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_kv_store_deployment_page_faults(3),"`dmc_set_index_introspection` search_group=dmc_group_kv_store search_group=$group$ component=kvstoreserverstats  
| rename data.opcounters.command as c, data.opcounters.update as u, data.opcounters.queries as q, data.opcountes.deletes as d, data.opcounters.getmore as g, data.opcounters.inserts as i 
| eval commands=if(isNotNull('c'), 'c',0) 
| eval updates=if(isNotNull('u'), 'u', 0) 
| eval queries=if(isNotNull('q'), 'q', 0) 
| eval deletes=if(isNotNull('d'), 'd', 0) 
| eval getmores=if(isNotNull('g'), 'g', 0) 
| eval inserts=if(isNotNull('i'), 'i', 0) 
| eval totalops=commands+updates+queries+deletes+getmores+inserts 
| bin _time minspan=30s 
| stats latest(totalops) AS ops latest(data.extra_info.page_faults) AS pf by host _time 
| eval  percent=if(opsdiff==0, 0, round(abs(pf/ops), 2))   
| stats $countPageFaultsFunc$(percent) as percent by host  
| rangemap field=percent ""0-0.7""=0-0.7 ""0.7-1.3""=0.7001-1.3 ""1.3+""=1.3001-999999 default=abnormal  
| where range=""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" dmc_group_kv_store"" 
| fields serverName, machine, percent, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, percent as ""Page Faults per Operation"", range as ""Page Fault Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_kv_store_deployment_replication_lag(2),"`dmc_set_index_introspection` search_group=$group$ search_group=dmc_group_kv_store component=kvstorereplicasetstats data.replSetStats.myState=1 
| spath data.replSetStats.members{}.name output=name 
| spath data.replSetStats.members{}.optimeDate output=optimeDate 
| spath data.replSetStats.members{}.stateStr output=stateStr 
| spath data.replSetStats.date output=date 
| eval prop_key_val=mvzip(mvzip(name, optimeDate, ""---""), stateStr, ""---"") 
| fields _time, date, prop_key_val 
| mvexpand prop_key_val 
| eval name=mvindex(split(prop_key_val, ""---""), 0) 
| eval optimeDate=mvindex(split(prop_key_val, ""---""), 1) 
| eval stateStr=mvindex(split(prop_key_val, ""---""), 2) 
| where stateStr=""SECONDARY"" 
| join _time 
  [ search `dmc_set_index_introspection` search_group=dmc_group_kv_store component=kvstorereplicasetstats data.replSetStats.myState=1 
  | spath data.replSetStats.members{}.name output=name 
  | spath data.replSetStats.members{}.optimeDate output=optimeDate 
  | spath data.replSetStats.members{}.stateStr output=stateStr 
  | spath data.replSetStats.date output=date 
  | eval prop_key_val=mvzip(mvzip(name, optimeDate, ""---""), stateStr, ""---"") 
  | fields _time, date, prop_key_val 
  | mvexpand prop_key_val 
  | eval name=mvindex(split(prop_key_val, ""---""), 0) 
  | eval optimeDate=mvindex(split(prop_key_val, ""---""), 1) 
  | eval stateStr=mvindex(split(prop_key_val, ""---""), 2) 
  | where stateStr=""PRIMARY"" 
  | stats max(optimeDate) as primary by _time] 
| eval name=mvindex(split(name, "":""), 0) 
| eval lag=(primary-optimeDate)/1000 
| eventstats max(date) as max_date by name 
| stats avg(lag) as lag by name stateStr max_date 
| eval lag = round(lag, 2) 
| `dmc_replication_lag_rangemap` 
| where range=""$metric$"" 
| eval date = max_date/1000 
| eval date = strftime(date, ""%m/%d/%Y %H:%M:%S %z"") 
| rename name as Instance, lag as Lag, range as ""Lag Range"", stateStr as State, date as ""Oplog Date"" 
| table Instance Lag ""Oplog Date"" ""Lag Range"" State"
dmc_drilldown_kv_store_primary_oplog_window(1),"`dmc_set_index_introspection` search_group=$group$ search_group=dmc_group_kv_store component=kvstorereplicasetstats data.replSetStats.myState=1 
| eval Instance=host 
| rename data.oplogInfo.start as start, data.oplogInfo.end as end 
| eval start = start/1000 
| eval end = end/1000 
| eval diff= (end-start)/3600 
| `dmc_time_format(start)` 
| `dmc_time_format(end)` 
| stats first(start) as ""Start Date"" first(end) as ""End Date"" first(diff) as ""Window (Hours)"" by Instance"
dmc_drilldown_resource_usage_cpu_deployment_usage(5),"`dmc_set_index_introspection` search_group=$role$ search_group=$group$ $role_post_filter$ sourcetype=splunk_resource_usage component=Hostwide 
| eval total_cpu_usage = 'data.cpu_system_pct' + 'data.cpu_user_pct' 
| stats $countCPUFunc$(total_cpu_usage) as cpu_usage by host 
| `dmc_cpu_usage_rangemap` 
| where range=""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" $role$"" 
| fields serverName, machine, cpu_usage, range, numberOfCores, ram, version, Action 
| eval cpu_usage = cpu_usage."" %"" 
| rename serverName as Instance, machine as Machine, cpu_usage as ""CPU Usage"", range as ""CPU Usage Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_resource_usage_deployment_cpu_usage(4),"`dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_resource_usage component=Hostwide 
| eval total_cpu_usage = 'data.cpu_system_pct' + 'data.cpu_user_pct' 
| stats $countCPUFunc$(total_cpu_usage) as cpu_usage by host 
| `dmc_cpu_usage_rangemap` 
| where range=""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" $role$"" 
| fields serverName, machine, cpu_usage, range, numberOfCores, ram, version, Action 
| eval cpu_usage = cpu_usage."" %"" 
| rename serverName as Instance, machine as Machine, cpu_usage as ""CPU Usage"", range as ""CPU Usage Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_resource_usage_deployment_disk_usage(4),"`dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_disk_objects component=Partitions 
| eval mount_point = 'data.mount_point' 
| eval free = if(isnotnull('data.available'), 'data.available', 'data.free') 
| eval pct_disk_usage = round(1 - free / 'data.capacity', 2) 
| eval server_mount_point = host."":"".mount_point 
| stats $countDiskFunc$(pct_disk_usage) as pct_disk_usage by server_mount_point 
| `dmc_disk_usage_rangemap` 
| where range=""$metric$"" 
| eval host = replace(server_mount_point, "":.*"", """") 
| eval mount_point = replace(server_mount_point, "".*:"", """") 
| eval pct_disk_usage = pct_disk_usage * 100 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" $role$"" 
| fields serverName, machine, mount_point, pct_disk_usage, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, mount_point as ""Mount Point"", pct_disk_usage as ""Disk Usage (%)"", range as ""Disk Usage Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_resource_usage_deployment_load_average(4),"`dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_resource_usage component=Hostwide 
| stats $countLoadAvgFunc$(data.normalized_load_avg_1min) as load_average by host 
| `dmc_load_average_rangemap` 
| where range=""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" $role$"" 
| fields serverName, machine, load_average, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, load_average as ""Load Average"", range as ""Load Average Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_resource_usage_deployment_memory_usage(4),"`dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_resource_usage component=Hostwide 
| eval pct_mem_used = 'data.mem_used' / 'data.mem' 
| stats $countMemFunc$(pct_mem_used) as pct_mem_used by host 
| `dmc_memory_usage_rangemap` 
| where range=""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" $role$"" 
| fields serverName, machine, pct_mem_used, range, numberOfCores, ram, version, Action 
| eval pct_mem_used = round(pct_mem_used * 100, 2) 
| eval pct_mem_used = pct_mem_used."" %"" 
| rename serverName as Instance, machine as Machine, pct_mem_used as ""Memory Usage"", range as ""Memory Usage Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_search_activity_deployment_resource_usage(5),"`dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_resource_usage ((component=PerProcess data.search_props.sid::*) OR component=Hostwide) 
| `dmc_rename_introspection_fields` 
| eval sid = if(component==""Hostwide"", ""n/a"", sid) 
| eval pid = if(component==""Hostwide"", ""n/a"", pid) 
| eval pct_cpu = if(component==""Hostwide"", 0, pct_cpu) 
| eval mem_used = if(component==""Hostwide"", 0, 'mem_used) 
| `dmc_set_bin` 
| stats latest($resourceType$) AS resource_usage_dedup values(Action) as Action by _time, sid, pid, host 
| stats sum(resource_usage_dedup) AS sum_resource_usage values(Action) as Action by _time, host 
| stats $resourceFunction$(sum_resource_usage) as resource_usage values(Action) as Action by host 
| `dmc_$resourceType$_rangemap` 
| where range == ""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" $role$"" 
| fields serverName, machine, resource_usage, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, resource_usage as ""$resourceType$ Usage"", range as ""$resourceType$ Usage Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_drilldown_search_activity_deployment_search_concurrency(4),"`dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_resource_usage ((component=PerProcess data.search_props.sid::*) OR component=Hostwide) 
| `dmc_rename_introspection_fields` 
| `dmc_set_bin` 
| stats dc(sid) AS distinct_search_count values(Action) as Action by host, _time 
| stats $searchFunction$(distinct_search_count) as search_count values(Action) as Action by host 
| `dmc_search_count_rangemap` 
| where range=""$metric$"" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action."" $role$"" 
| fields serverName, machine, search_count, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, search_count as ""Count of Searches"", range as ""Count of Searches Range"", version as Version, numberOfCores as Cores, ram as RAM"
dmc_event_local_search_dispatch,`dmc_set_index_audit` sourcetype=audittrail action=search search=*
dmc_event_remote_search_dispatch,"`dmc_set_index_internal` sourcetype=splunkd_remote_searches ""Streamed search search starting"""
dmc_exclude_indexes,"eval _dmc_title = if(isnotnull(title), title, 'data.name')
| where NOT (_dmc_title == ""history"" OR _dmc_title == ""_thefishbucket"" OR _dmc_title == ""_blocksignature"")
| fields - _dmc_title"
dmc_exclude_volumes,"eval _dmc_volume = if(isnotnull(title), title, 'data.name') 
| where NOT _dmc_volume == ""_splunk_summaries"" 
| fields - _dmc_volume"
dmc_get_all_triggered_alerts(1),"rest splunk_server=local /servicesNS/-/splunk_monitoring_console/alerts/fired_alerts/- 
| rename savedsearch_name as title 
| join type=outer title [|rest splunk_server=local /servicesNS/-/splunk_monitoring_console/saved/searches ] 
| rename title as ""Alert Name"" 
| join type=outer sid [rest splunk_server=local /servicesNS/nobody/splunk_monitoring_console/search/jobs/] 
| eval now=relative_time(now(),""-$minute_offset$m"") 
| where trigger_time > now 
| rename trigger_time AS ""_time"", description as ""Description"", sid AS Instance 
| convert timeformat=""%b. %d, %Y %l:%M %p"" ctime(_time) AS ""Time Triggered"" 
| fields - _time 
| fields ""Alert Name"", Instance, ""Time Triggered"", ""Description"""
dmc_get_core_info,"eval core_info = if(isnull(numberOfCores), ""N/A"", numberOfCores)."" / "".if(isnull(numberOfVirtualCores), ""N/A"", numberOfVirtualCores)"
dmc_get_distsearch_group_servers(1),"rest splunk_server=local /services/search/distributed/groups 
| fields title member 
| search title=""dmc_group_$group_name$"" 
| eval title=replace(title, ""^dmc_group_"", """") 
| eval servers=mvjoin(member,"","") 
| fields title servers"
dmc_get_forwarder_info,inputlookup dmc_forwarder_assets
dmc_get_forwarder_tcpin,`dmc_set_index_internal` sourcetype=splunkd group=tcpin_connections (connectionType=cooked OR connectionType=cookedSSL) fwdType=* guid=*
dmc_get_groups,"inputlookup dmc_assets 
| fields search_group 
| dedup search_group 
| search search_group=""dmc_*"" 
| `dmc_set_group_label_and_sort(search_group)`"
dmc_get_groups_containing_role(1),"inputlookup dmc_assets 
| mvcombine search_group 
| search search_group=""$role$"" 
| mvexpand search_group 
| fields search_group 
| dedup search_group 
| `dmc_set_group_label_and_sort(search_group)`"
dmc_get_indexer_cluster_groups,"inputlookup dmc_assets 
| fields search_group 
| dedup search_group 
| search search_group=""dmc_indexerclustergroup_*"" 
| eval label = replace(search_group, ""dmc_indexerclustergroup_"", """")"
dmc_get_instance_info(1),"inputlookup dmc_assets | mvcombine search_group | search search_group=""$group$"""
dmc_get_instance_roles,"inputlookup dmc_assets 
| mvcombine search_group 
| eval role = search_group 
| mvexpand role 
| eval role = if(like(role, ""dmc_group_%""), role, """") 
| eval role = replace(role, ""^dmc_group_"", """") 
| mvcombine role"
dmc_get_instances_on_a_machine(1),"`dmc_get_instance_info(*)` 
| where machine = ""$machine$"" 
| dedup serverName"
dmc_get_last_hour_resource_usage_from_sid(2),"`dmc_set_index_introspection` host=$host$ sourcetype=splunk_resource_usage component=PerProcess data.search_props.sid=""$sid$"" earliest=-1h 
| `dmc_set_bin` 
| `dmc_rename_introspection_fields` 
| stats latest(pct_cpu) AS pct_cpu_dedup latest(mem_used) AS mem_used_dedup by _time, pid 
| stats sum(pct_cpu_dedup) AS pct_cpu_sum sum(mem_used_dedup) AS mem_used_sum by _time 
| timechart span=10s latest(pct_cpu_sum) AS pct_cpu latest(mem_used_sum) AS mem_used"
dmc_get_local_instance_asset,"`dmc_get_local_instance_asset_computed_groups` 
| join type=outer peerURI [ 
| rest splunk_server=local /services/search/distributed/groups 
| fields title member 
| where isnotnull(mvfind(member, ""localhost:localhost"")) 
| eval peerURI=""localhost"" 
| rename title AS search_groups 
| fields peerURI search_groups 
| mvcombine delim="" "" search_groups] 
| makemv delim="" "" search_groups 
| eval search_groups = if(isnotnull(search_groups),search_groups,computed_search_groups) 
| fields - computed_search_groups 
| mvexpand search_groups"
dmc_get_local_instance_asset_computed_groups,"rest splunk_server=local /services/server/info 
| eval peerURI=""localhost"" 
| eval server_roles=""indexer,search_head,license_master,kv_store"" 
| makemv delim="","" server_roles 
| mvexpand server_roles 
| eval computed_search_groups=""dmc_group_"".server_roles 
| stats first(peerURI) AS peerURI first(host) AS host first(host_fqdn) AS machine values(computed_search_groups) AS computed_search_groups by serverName"
dmc_get_local_instance_asset_in_distributed_mode,"`dmc_get_local_instance_asset_computed_groups` 
| join type=inner peerURI [ 
| rest splunk_server=local /services/search/distributed/groups 
| fields title member 
| where isnotnull(mvfind(member, ""localhost:localhost"")) 
| eval peerURI=""localhost"" 
| rename title AS search_groups 
| fields peerURI search_groups 
| mvcombine delim="" "" search_groups] 
| makemv delim="" "" search_groups 
| eval search_groups = if(isnotnull(search_groups),search_groups,computed_search_groups) 
| fields - computed_search_groups 
| mvexpand search_groups"
dmc_get_machine_info,"`dmc_get_instance_info(*)` 
| stats first(host) as host first(serverName) as serverName by machine"
dmc_get_port_from_splunktcp_stanza(1),"| rex field=$stanza_name$ ""splunktcp(-ssl)?:(\/{1,2})?(([0-9]{1,3}\.){3}[0-9]{1,3})?(:)?(?<port>\d+)"" 
| eval port = if(match($stanza_name$, ""splunktcp-ssl""), port."" (SSL)"", port) 
| eval port = if(isnotnull(port), port, null)"
dmc_get_primary_role,"eval primary_role = case( 
    role = ""cluster_master"", ""cluster_master"", 
    role = ""search_head"", ""search_head"", 
    role = ""indexer"", ""indexer"", 
    role = ""kv_store"", ""kv_store"", 
    role = ""license_master"", ""license_master"")"
dmc_get_recently_triggered_alerts,"rest splunk_server=local /servicesNS/-/splunk_monitoring_console/saved/searches 
|rename title as savedsearch_name 
| fields savedsearch_name, triggered_alert_count, description 
| where triggered_alert_count > 0 
| join type=outer savedsearch_name[|rest splunk_server=local /servicesNS/-/splunk_monitoring_console/alerts/fired_alerts/- 
| cluster field=savedsearch_name] 
| join type=outer sid [rest splunk_server=local /servicesNS/nobody/splunk_monitoring_console/search/jobs/] 
| rename savedsearch_name AS ""Alert Name"", triggered_alert_count AS ""Trigger Count"", published AS ""Last time triggered"", description as ""Description"" | fields ""Alert Name"" , ""Trigger Count"", ""Last time triggered"", ""Description"", sid"
dmc_get_search_head_cluster_groups,"inputlookup dmc_assets 
| fields search_group 
| dedup search_group 
| search search_group=""dmc_searchheadclustergroup_*"" 
| eval label = replace(search_group, ""dmc_searchheadclustergroup_"", """")"
dmc_get_warnings_and_errors(2),`dmc_set_index_internal` search_group=$search_group$ sourcetype=splunkd component=$component$  (log_level=WARN OR log_level=ERROR)
dmc_indexing_rate_rangemap,"rangemap field=kbps ""0-50 KB/s""=0-50 ""50-100 KB/s""=50.001-100 ""100-500 KB/s""=100.001-500 ""500 KB/s - 1 MB/s""=500.001-1024 ""1-2.5 MB/s""=1024.001-2560 ""2.5-5 MB/s""=2560.001-5120 ""5-10 MB/s""=5120.001-10240 ""10+ MB/s""=10240.001-999999 default=""NULL"""
dmc_indexing_rate_rangemap_and_timechart,"`dmc_indexing_rate_rangemap` 
| timechart minspan=30s partial=f dc(host) AS instance_count by range 
| fields _time ""10+ MB/s"" ""5-10 MB/s"" ""2.5-5 MB/s"" ""1-2.5 MB/s"" ""500 KB/s - 1 MB/s"" ""100-500 KB/s"" ""50-100 KB/s"" ""0-50 KB/s"""
dmc_instances_view_default_search(1),"inputlookup dmc_assets 
| mvcombine search_group 
| rex max_match=0 field=search_group ""dmc_indexerclustergroup_(?<indexer_cluster>.*)"" 
| rex max_match=0 field=search_group ""dmc_searchheadclustergroup_(?<search_head_cluster>.*)"" 
| mvexpand search_group 
| search search_group = ""$group$"" 
| mvcombine search_group 
| join type=outer peerURI 
  [| rest splunk_server=local /services/search/distributed/peers 
   | rename title as peerURI ] 
| join type=outer peerURI 
  [| rest splunk_server=local /services/server/info 
   | eval peerURI = ""localhost"" 
   | eval status = ""Up""] 
| join peerURI 
  [| `dmc_get_instance_roles` ] 
| eval status = if(status == ""Up"", status, ""Unreachable"") 
| eval Action = serverName."" "".role 
| eval OS = os_name 
| eval ram = round(physicalMemoryMB / 1024, 2)."" GB"" 
| `dmc_get_core_info` 
| fields serverName, machine, role, indexer_cluster, search_head_cluster, OS, core_info, ram, version, status, Action 
| sort status, serverName 
| rename serverName as Instance, machine as Machine, role as Role, indexer_cluster as ""Indexer Cluster"", search_head_cluster as ""Search Head Cluster"", core_info as ""CPU Cores (Physical / Virtual)"", ram as RAM, version as Version, status as Status"
dmc_iostats_rangemap(1),"rangemap field=$fieldname$ ""0-60%""=0-60 ""60-80%""=60.0001-80, ""80-100%""=80.0001-100 default=abnormal"
dmc_license_non_itsi_pools(2),"search [| rest splunk_server=$host$ /services/licenser/stacks | where label != ""IT Service Intelligence Internals *DO NOT COPY*"" | rename title as stack_id | join type=inner stack_id [|rest splunk_server=$host$ /services/licenser/pools  ] | rename description as $field_name$ | fields $field_name$]"
dmc_licensing_base_summary(2),"`dmc_set_index_internal` host=$host$ source=*license_usage.log* type=""RolloverSummary"" earliest=-30d@d pool=""$pool_clause$"""
dmc_licensing_base_usage(2),"`dmc_set_index_internal` source=*license_usage.log* type=""Usage"" | eval h=if(len(h)=0 OR isnull(h),""(SQUASHED)"",h) | eval s=if(len(s)=0 OR isnull(s),""(SQUASHED)"",s) | eval idx=if(len(idx)=0 OR isnull(idx),""(UNKNOWN)"",idx) | bin _time span=1d | stats sum(b) as b by _time, host, pool, s, st, h, idx | search host=$host$ $pool_clause$"
dmc_licensing_pool_size_srch(2),"join type=outer _time [search `dmc_set_index_internal` host=$host$ source=*license_usage.log* type=""RolloverSummary"" earliest=-30d@d $pool_clause$ | `dmc_license_non_itsi_pools($host$, pool)` | eval _time=_time - 43200 | bin _time span=1d | stats latest(poolsz) AS  ""pool size"" by _time] | fields - _timediff"
dmc_licensing_stack_size_srch(2),"join type=outer _time [search `dmc_set_index_internal` host=$host$ source=*license_usage.log* type=""RolloverSummary"" earliest=-30d@d | `dmc_license_non_itsi_pools($host$, pool)` | eval _time=_time - 43200 | bin _time span=1d | dedup _time stack | stats sum(stacksz) AS ""stack size"" by _time] | fields - _timediff"
dmc_licensing_summary_maxavg_indxr(3),"eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | eval slave_guid=slave | stats sum(b) AS volume by slave_guid, _time | stats avg(volume) AS avgVolume max(volume) AS maxVolume by slave_guid | join type=outer slave_guid [rest splunk_server=$splunk_server$ /services/licenser/slaves | rename label AS slave_name title AS slave_guid | table slave_guid slave_name] | eval slave_name = if(isnotnull(slave_name),slave_name,""GUID: "".slave_guid) | foreach *Volume [eval <<FIELD>>=round('<<FIELD>>'/1024/1024/1024, 3)] |  rename slave_name as ""Indexer"" avgVolume AS ""average"" maxVolume AS ""peak"" | sort 5 - ""average"" | fields ""Indexer"", ""average"", ""peak"" | fields - _timediff, slave_guid"
dmc_licensing_summary_maxavg_no_split(3),"eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | stats sum(b) AS volume by _time | stats avg(volume) AS avgVolume max(volume) AS maxVolume  | eval maxVolumeGB=round(maxVolume/1024/1024/1024,3) | eval avgVolumeGB=round(avgVolume/1024/1024/1024,3) | rename avgVolumeGB AS ""average"" maxVolumeGB AS ""peak"" | eval ""All Pools"" = """" | fields ""All Pools"", ""average"", ""peak"""
dmc_licensing_summary_maxavg_pool(3),"eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | stats sum(b) AS volume by pool, _time  | stats avg(volume) AS avgVolume max(volume) AS maxVolume by pool | eval maxVolumeGB=round(maxVolume/1024/1024/1024,3) | eval avgVolumeGB=round(avgVolume/1024/1024/1024,3) | rename avgVolumeGB AS ""average"" maxVolumeGB AS ""peak"" pool as ""Pool"" | fields ""Pool"", ""average"", ""peak"" | sort 5 - ""average"""
dmc_licensing_summery_indxr(5),"eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | eval slave_guid=slave | stats max(b) AS volume by slave_guid, _time | join type=outer slave_guid [rest splunk_server=$splunk_server$ /services/licenser/slaves | rename label AS slave_name title AS slave_guid | table slave_guid slave_name] | eval slave_name = if(isnotnull(slave_name),slave_name,""GUID: "".slave_guid) | timechart span=1d max(volume) AS ""volume"" by slave_name fixedrange=false | `$size_search$($host$, ""$pool_clause$"")` | foreach * [eval <<FIELD>>=round('<<FIELD>>'/1024/1024/1024, 3)]"
dmc_licensing_summery_no_split(5),"eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | timechart span=1d sum(b) AS ""volume"" fixedrange=false | `$size_search$($host$, ""$pool_clause$"")` | foreach * [eval <<FIELD>>=round('<<FIELD>>'/1024/1024/1024, 3)]"
dmc_licensing_summery_pct_indxr(4),"eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b latest($sz_clause$) AS $sz_clause$ by slave, pool, _time | stats sum(b) AS volumeB max($sz_clause$) AS $sz_clause$ by slave, _time | eval pctused=round(volumeB/$sz_clause$*100,2) | eval slave_guid=slave | join type=outer slave_guid [rest splunk_server=$splunk_server$ /services/licenser/slaves | rename label AS slave_name title AS slave_guid | table slave_guid slave_name] | eval slave_name = if(isnotnull(slave_name),slave_name,""GUID: "".slave_guid) | timechart span=1d max(pctused) AS ""used"" by slave_name fixedrange=false"
dmc_licensing_summery_pct_no_split(4),"eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b latest($sz_clause$) AS $sz_clause$ by slave, pool, _time | stats sum(b) AS volumeB max($sz_clause$) AS $sz_clause$ by _time | eval pctused=round(volumeB/$sz_clause$*100,2) | timechart span=1d max(pctused) AS ""used"" fixedrange=false"
dmc_licensing_summery_pct_pool(4),"eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b latest($sz_clause$) AS $sz_clause$ by slave, pool, _time | stats sum(b) AS volumeB max($sz_clause$) AS $sz_clause$ by pool, _time | eval pctused=round(volumeB/$sz_clause$*100,2) | timechart span=1d max(pctused) AS ""used"" by pool fixedrange=false"
dmc_licensing_summery_pool(5),"eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | timechart span=1d sum(b) AS ""volume"" by pool fixedrange=false | `$size_search$($host$, ""$pool_clause$"")` | foreach * [eval <<FIELD>>=round('<<FIELD>>'/1024/1024/1024, 3)]"
dmc_licensing_usage_all(5),"timechart span=1d sum(b) AS volumeB by $split_by_field_name$ fixedrange=false | `$size_search$($host$, ""$pool_clause$"")` | foreach * [eval <<FIELD>>=round('<<FIELD>>'/1024/1024/1024, 3)]"
dmc_licensing_usage_maxavg_all(3),"stats sum(b) AS volume by $split_by_field_name$, _time | stats avg(volume) AS avgVolume max(volume) AS maxVolume by $split_by_field_name$ | eval avgVolumeGB=round(avgVolume/1024/1024/1024,3) | eval maxVolumeGB=round(maxVolume/1024/1024/1024,3) | fields $split_by_field_name$, avgVolumeGB, maxVolumeGB | rename avgVolumeGB AS ""average"" maxVolumeGB AS ""peak"" $split_by_field_name$ AS ""$split_by_label$"" | sort 5 - ""average"""
dmc_licensing_usage_pct_all(4),"join _time pool type=outer [search `dmc_set_index_internal` host=$host$ source=*license_usage.log* type=""RolloverSummary"" earliest=-30d@d | eval _time=_time - 43200 | bin _time span=1d | stats latest($sz_clause$) AS $sz_clause$ by slave, pool, _time | stats max($sz_clause$) AS $sz_clause$ by pool, _time] | stats sum(b) AS bytes_used max($sz_clause$) AS $sz_clause$ by $split_by_field_name$, _time | timechart span=1d max(eval(round(bytes_used/$sz_clause$*100,2))) by $split_by_field_name$ fixedrange=false"
dmc_load_average_rangemap,"rangemap field=load_average ""0-0.75""=0-0.75 ""0.75-1.5""=0.75001-1.5 ""1.5+""=1.50001-999999 default=abnormal"
dmc_load_average_rangemap_and_timechart,"`dmc_load_average_rangemap` 
| `dmc_timechart` partial=f dc(server) as server_count by range 
| fields _time, ""1.5+"", ""0.75-1.5"", ""0-0.75"""
dmc_match_all_scheduled_search_types,"((data.search_props.type=""datamodel acceleration"" OR search_props.type=""datamodel acceleration"") OR (data.search_props.type=""report acceleration"" OR search_props.type=""report acceleration"") OR (data.search_props.type=""scheduled"" OR search_props.type=""scheduled"") OR (data.search_props.type=""summary indexing"" OR search_props.type=""summary indexing""))"
dmc_mem_used_rangemap,"rangemap field=resource_usage 
""0GB""=0-0 
""<1GB""=0.01-1024 
""1-2GB""=1024.001-2048 
""2-3GB""=2048.001-3072 
""3-4GB""=3072.001-4096 
""4-5GB""=4096.001-5120 
""5-10GB""=5120.001-10240 
""10-15GB""=10240.001-15360 
""15-20GB""=15360.001-20480 
""20-30GB""=20480.001-30720 
""30GB+""=30720.001-999999 
default=""0GB"" 
| eval resource_usage = round(resource_usage / 1024, 3)"
dmc_mem_used_rangemap_and_timechart,"`dmc_mem_used_rangemap` 
| `dmc_timechart` partial=f dc(host) AS host_count by range 
| fields _time, ""30GB+"" ""20-30GB"" ""15-20GB"" ""5-10GB"" ""4-5GB"" ""3-4GB"" ""2-3GB"" ""1-2GB"" ""<1GB"" ""0GB"""
dmc_memory_usage_rangemap,"rangemap field=pct_mem_used ""0-60%""=0-0.6 ""60-80%""=0.6001-0.8 ""80-100%""=0.8001-1 default=abnormal"
dmc_memory_usage_rangemap_and_timechart,"`dmc_memory_usage_rangemap` 
| `dmc_timechart` partial=f dc(server) as server_count by range 
| fields _time, ""80-100%"", ""60-80%"", ""0-60%"""
dmc_pct_cpu_rangemap,"rangemap field=resource_usage 
""0 cores""=0-0.009 
""0.01-1 cores""=0.01-1 
""1-2 cores""=1.01-2 
""2-3 cores""=2.01-3 
""3-4 cores""=3.01-4 
""4-5 cores""=4.01-5 
""5-10 cores""=5.01-10 
""10-15 cores""=10.01-15 
""15-20 cores""=15.01-20 
""20-25 cores""=20.01-25 
""25-30 cores""=25.01-30 
""30+ cores""=30.01-999 
""negative""=-99999--0.001 
default=""0 cores"""
dmc_pct_cpu_rangemap_and_timechart,"`dmc_pct_cpu_rangemap` 
| `dmc_timechart` partial=f dc(host) AS host_count by range 
| fields _time, ""30+ cores"" ""25-30 cores"" ""20-25 cores"" ""15-20 cores"" ""10-15 cores"" ""5-10 cores"" ""4-5 cores"" ""3-4 cores"" ""2-3 cores"" ""1-2 cores"" ""0.01-1 cores"" ""0 cores"""
dmc_pretty_print_role(1),"eval $role$ = mvmap($role$, case( 
    $role$ = ""cluster_master"", ""Cluster Manager"", 
    $role$ = ""search_head"", ""Search Head"", 
    $role$ = ""indexer"", ""Indexer"", 
    $role$ = ""kv_store"", ""KV Store"", 
    $role$ = ""license_master"", ""License Manager""))"
dmc_queue_fill_ratio_rangemap,"rangemap field=fill_percentage ""0-60%""=0-60 ""60-80%""=60.01-80 ""80-100%""=80.01-100"
dmc_queue_fill_ratio_rangemap_and_timechart,"`dmc_queue_fill_ratio_rangemap` 
| timechart partial=f dc(host) by range 
| fields _time ""80-100%"" ""60-80%"" ""0-60%"""
dmc_rangemap_cpu_system_pct,rangemap field=cpu_system_pct #53A051=0-59.999 #F1813F=60-79.999 default=#DC4E41
dmc_rangemap_default_cpu_system_pct,rangemap field=cpu_system_pct #53A051=0-59.999 #F1813F=60-79.999 default=#DC4E41
dmc_rangemap_default_indexing_rate,rangemap field=average_KBps #CEE4EE=0-99.999 #6BAECA=100-999.999 #0877A6=1000-4999 #005E86=5000-9999 default=#004664
dmc_rangemap_default_mem_used,rangemap field=mem_used #53A051=0-59.999 #F1813F=60-79.999 default=#DC4E41
dmc_rangemap_default_search_concurrency,rangemap field=search_concurrency #CEE4EE=0-5.999 #6BAECA=6-10.999 #0877A6=11-20.999 default=#005E86
dmc_rangemap_default_up_down_status,rangemap field=up_down_status #DC4E41=0-0.999 default=#53A051
dmc_rangemap_indexing_rate,rangemap field=average_KBps #CEE4EE=0-99.999 #6BAECA=100-999.999 #0877A6=1000-4999 #005E86=5000-9999 default=#004664
dmc_rangemap_mem_used,rangemap field=mem_used #53A051=0-59.999 #F1813F=60-79.999 default=#DC4E41
dmc_rangemap_search_concurrency,rangemap field=search_concurrency #CEE4EE=0-5.999 #6BAECA=6-10.999 #0877A6=11-20.999 default=#005E86
dmc_rangemap_up_down_status,rangemap field=up_down_status #DC4E41=0-0.999 default=#53A051
dmc_re_build_forwarder_assets(1),"`dmc_build_forwarder_assets($sparkline_span$)` 
| rename new_sum_kb as sum_kb, new_avg_tcp_kbps_sparkline as avg_tcp_kbps_sparkline, new_avg_tcp_kbps as avg_tcp_kbps, new_avg_tcp_eps as avg_tcp_eps 
| eval avg_tcp_kbps_sparkline = ""N/A"" 
| addinfo 
| eval status = if(isnull(sum_kb) or (sum_kb <= 0) or (last_connected < (info_max_time - 900)), ""missing"", ""active"") 
| eval sum_kb = round(sum_kb, 2) 
| eval avg_tcp_kbps = round(avg_tcp_kbps, 2) 
| eval avg_tcp_eps = round(avg_tcp_eps, 2) 
| fields guid, hostname, forwarder_type, version, arch, os, status, last_connected, sum_kb, avg_tcp_kbps_sparkline, avg_tcp_kbps, avg_tcp_eps 
| outputlookup dmc_forwarder_assets"
dmc_re_build_forwarder_assets_light(1),"`dmc_build_forwarder_assets($sparkline_span$)` 
| rename new_sum_kb as sum_kb, new_avg_tcp_kbps_sparkline as avg_tcp_kbps_sparkline, new_avg_tcp_kbps as avg_tcp_kbps, new_avg_tcp_eps as avg_tcp_eps 
| eval avg_tcp_kbps_sparkline = ""N/A"" 
| addinfo 
| eval status = if(isnull(sum_kb) or (sum_kb <= 0) or (last_connected < (relative_time(now(),""-15m""))), ""missing"", ""active"") 
| eval sum_kb = round(sum_kb, 2) 
| eval avg_tcp_kbps = round(avg_tcp_kbps, 2) 
| eval avg_tcp_eps = round(avg_tcp_eps, 2) 
| fields guid, hostname, forwarder_type, version, arch, os, status, last_connected, sum_kb, avg_tcp_kbps_sparkline, avg_tcp_kbps, avg_tcp_eps 
| outputlookup dmc_forwarder_assets"
dmc_rename_forwarder_type(1),"eval $type$ = case($type$ == ""full"", ""Heavy Forwarder"", $type$ == ""uf"", ""Universal Forwarder"", $type$ == ""lwf"", ""Light Forwarder"", 1==1, $type$)"
dmc_rename_introspection_fields,"eval process = 'data.process' 
| eval args = 'data.args' 
| eval pid = 'data.pid' 
| eval ppid = 'data.ppid' 
| eval elapsed = 'data.elapsed' 
| eval mem_used = 'data.mem_used' 
| eval mem = 'data.mem' 
| eval pct_memory = 'data.pct_memory' 
| eval normalized_pct_cpu = 'data.normalized_pct_cpu' 
| eval pct_cpu = 'data.pct_cpu' 
| eval sid = 'data.search_props.sid' 
| eval app = 'data.search_props.app' 
| eval label = 'data.search_props.label' 
| eval type = 'data.search_props.type' 
| eval mode = 'data.search_props.mode' 
| eval user = 'data.search_props.user' 
| eval role = 'data.search_props.role' 
| eval label = if(isnotnull('data.search_props.label'), 'data.search_props.label', """") 
| eval provenance = if(isnotnull('data.search_props.provenance'), 'data.search_props.provenance', ""unknown"") 
| eval search_head = case(isnotnull('data.search_props.search_head') AND 'data.search_props.role' == ""peer"", 'data.search_props.search_head', isnull('data.search_props.search_head') AND 'data.search_props.role' == ""head"", ""_self"", isnull('data.search_props.search_head') AND 'data.search_props.role' == ""peer"", ""_unknown"") 
| eval workload_pool = if(isnotnull('data.workload_pool'), 'data.workload_pool', ""UNDEFINED"")"
dmc_replication_lag_rangemap,"rangemap field=lag ""0-10s""=0-10 ""10-30s""=10.001-30 "">30s""=30.001-10000000 default=abnormal"
dmc_resource_usage_by_processes_timechart(2),"`dmc_set_bin` 
| `dmc_rename_introspection_fields` 
| stats latest($resource_type$) AS resource_usage_dedup latest(process_class) AS process_class by pid, _time 
| stats sum(resource_usage_dedup) AS resource_usage by _time, process_class 
| timechart minspan=10s $function$(resource_usage) AS ""Resource Usage"" by process_class"
dmc_resource_usage_instance_drilldown(1),"`dmc_set_index_introspection` sourcetype=splunk_resource_usage component=PerProcess host=$host$ 
| `dmc_rename_introspection_fields` 
| `dmc_classify_processes` 
| eval args = if(isnotnull(sid),""search --id="".sid."" (...)"", args) 
| eval cmd = process."" "".args 
| stats latest(pid) as ""PID"", latest(ppid) as ""PPID"", latest(label) as Label, latest(provenance) as Provenance, latest(search_head) as ""Search Head"", latest(type) as Type, latest(user) as User, latest(app) as App, latest(mode) as Mode, latest(role) as Role, avg(pct_cpu) as avg_pct_cpu, max(mem_used) as ""Physical Memory Usage (MB)"", min(_time) as min_time, max(_time) as max_time, max(elapsed) as ""Elapsed Time"" by cmd 
| eval avg_pct_cpu = round(avg_pct_cpu, 2) 
| `dmc_time_format(min_time)` 
| `dmc_time_format(max_time)` 
| rename avg_pct_cpu as ""Average CPU Usage (%)"", min_time as ""First Time Seen"", max_time as ""Last Time Seen"""
dmc_scheduler_instance_search_concurrency_drilldown(3),"`dmc_set_index_introspection` host=$host$ sourcetype=splunk_resource_usage component=PerProcess data.search_props.sid::* `dmc_match_all_scheduled_search_types` 
| `dmc_rename_introspection_fields` 
| where $concurrencySplitBy$==""$type$"" 
| stats latest(pid) as ""PID"", latest(ppid) as ""PPID"", latest(label) as Label, latest(provenance) as Provenance, latest(search_head) as ""Search Head"", latest(type) as Type, latest(user) as User, latest(app) as App, latest(mode) as Mode, latest(role) as Role, avg(pct_cpu) as avg_pct_cpu, max(mem_used) as ""Physical Memory Usage (MB)"", min(_time) as min_time, max(_time) as max_time, max(elapsed) as ""Elapsed Time"" by sid 
| eval avg_pct_cpu = round(avg_pct_cpu, 2) 
| `dmc_time_format(min_time)` 
| `dmc_time_format(max_time)` 
| rename avg_pct_cpu as ""Average CPU Usage (%)"", min_time as ""First Time Seen"", max_time as ""Last Time Seen"""
dmc_search_activity_instance_drilldown(3),"`dmc_set_index_introspection` host=$host$ sourcetype=splunk_resource_usage component=PerProcess data.search_props.sid::* 
| `dmc_rename_introspection_fields` 
| where $concurrencySplitBy$==""$type$"" 
| stats latest(pid) as ""PID"", latest(ppid) as ""PPID"", latest(label) as Label, latest(provenance) AS Provenance, latest(search_head) as ""Search Head"", latest(type) as Type, latest(user) as User, latest(app) as App, latest(mode) as Mode, latest(role) as Role, avg(pct_cpu) as avg_pct_cpu, max(mem_used) as ""Physical Memory Usage (MB)"", min(_time) as min_time, max(_time) as max_time, max(elapsed) as ""Elapsed Time"" by sid 
| eval avg_pct_cpu = round(avg_pct_cpu, 2) 
| `dmc_time_format(min_time)` 
| `dmc_time_format(max_time)` 
| rename avg_pct_cpu as ""Average CPU Usage (%)"", min_time as ""First Time Seen"", max_time as ""Last Time Seen"""
dmc_search_count_rangemap,"rangemap field=search_count ""0""=0-0 ""1-5""=1-5 ""6-10""=6-10 ""11-15""=11-15 ""16-20""=16-20 ""21-30""=21-30 ""31-40""=31-40 ""41-50""=41-50 ""51-75""=51-75 ""76-100""=76-100 ""101+""=101-99999"
dmc_search_count_rangemap_and_timechart,"`dmc_search_count_rangemap` 
| `dmc_timechart` dc(host) AS count_host by range 
| fields _time ""101+"" ""76-100"" ""51-75"" ""41-50"" ""31-40"" ""21-30"" ""16-20"" ""11-15"" ""6-10"" ""1-5"" ""0"""
dmc_set_bin,bin _time span=10s
dmc_set_bin_for_disk_usage,bin _time span=10min
dmc_set_bin_for_iostats,bin _time minspan=1min
dmc_set_bin_for_metrics_log,bin _time minspan=30s
dmc_set_bin_for_timechart,bin _time minspan=10s
dmc_set_bin_for_timechart_for_disk_usage,bin _time minspan=10min
dmc_set_group_label_and_sort(1),"eval label = replace($search_group$, ""^dmc_\w*group_"", """") 
| eval label = case( 
    $search_group$ == ""dmc_group_indexer"", ""Indexer"", 
    $search_group$ == ""dmc_group_search_head"", ""Search Head"", 
    $search_group$ == ""dmc_group_cluster_master"", ""Cluster Manager"", 
    $search_group$ == ""dmc_group_cluster_manager"", ""Cluster Manager"", 
    $search_group$ == ""dmc_group_license_master"", ""License Manager"", 
    $search_group$ == ""dmc_group_license_manager"", ""License Manager"", 
    $search_group$ == ""dmc_group_deployment_server"", ""Deployment Server"", 
    $search_group$ == ""dmc_group_kv_store"", ""KV Store"", 
    $search_group$ == ""dmc_group_shc_deployer"", ""SHC Deployer"", 
    like($search_group$, ""dmc_customgroup_%""), label.""  (custom)"", 
    like($search_group$, ""dmc_indexerclustergroup_%""), label."" (Indexer Cluster)"", 
    like($search_group$, ""dmc_searchheadclustergroup_%""), label."" (Search Head Cluster)"", 
    1 == 1, label."" (Unrecognized)"") 
| eval order = case( 
    like($search_group$, ""dmc_group_%""), 100, 
    like($search_group$, ""dmc_customgroup_%""), 200, 
    like($search_group$, ""dmc_indexerclustergroup_%""), 300, 
    like($search_group$, ""dmc_searchheadclustergroup_%""), 400, 
    1 == 1, ""500"") 
| sort order, $search_group$ 
| fields - order"
dmc_set_index_audit,index=_audit
dmc_set_index_internal,index=_internal
dmc_set_index_introspection,index=_introspection
dmc_tcp_forwarder_count_split_by(2),"`dmc_get_forwarder_tcpin` search_group=dmc_group_indexer search_group=$group$ 
| `dmc_timechart_for_metrics_log` dc(guid) as forwarder_count by $field$ 
| rename forwarder_count as ""Forwarder Count"""
dmc_tcp_throughput_split_by(2),"`dmc_get_forwarder_tcpin` search_group=dmc_group_indexer search_group=$group$ 
| `dmc_timechart_for_metrics_log` per_second(kb) as avg_tcp_KBps by $field$ 
| rename avg_tcp_KBps as ""KB/s"""
dmc_time_format(1),"eval $time$ = strftime($time$, ""%m/%d/%Y %H:%M:%S %z"")"
dmc_timechart,timechart minspan=10s
dmc_timechart_for_disk_usage,timechart minspan=10min
dmc_timechart_for_iostats,timechart minspan=60s partial=f
dmc_timechart_for_metrics_log,timechart minspan=30s
dmc_timechart_for_metrics_reaper_and_heartbeat,timechart minspan=300s
dns_exfiltration_using_nslookup_app_filter,search *
dns_query_length_outliers___mltk_filter,search *
dns_query_length_with_high_standard_deviation_filter,search *
dns_query_requests_resolved_by_unauthorized_dns_servers_filter,search *
dns_record_changed_filter,search *
domain_account_discovery_with_dsquery_filter,search *
domain_account_discovery_with_net_app_filter,search *
domain_account_discovery_with_wmic_filter,search *
domain_controller_discovery_with_nltest_filter,search *
domain_controller_discovery_with_wmic_filter,search *
domain_group_discovery_with_adsisearcher_filter,search *
domain_group_discovery_with_dsquery_filter,search *
domain_group_discovery_with_net_filter,search *
domain_group_discovery_with_wmic_filter,search *
download_files_using_telegram_filter,search *
driverinventory,sourcetype=PwSh:DriverInventory
drop_dm_object_name(1),"rename ""$object$.*"" as *"
drop_icedid_license_dat_filter,search *
dsquery_domain_discovery_filter,search *
dump_lsass_via_comsvcs_dll_filter,search *
dump_lsass_via_procdump_filter,search *
dump_lsass_via_procdump_rename_filter,search *
dynamic_dns_providers,"lookup update=true dynamic_dns_providers_default dynamic_dns_domains as query OUTPUTNEW isDynDNS_default | lookup update=true dynamic_dns_providers_local dynamic_dns_domains as query OUTPUTNEW isDynDNS_local| eval isDynDNS = coalesce(isDynDNS_local,isDynDNS_default) |fields - isDynDNS_default, isDynDNS_local| search isDynDNS=True"
dynamic_dns_web_traffic,"lookup update=true dynamic_dns_providers_default dynamic_dns_domains as url OUTPUTNEW isDynDNS_default | lookup update=true dynamic_dns_providers_local dynamic_dns_domains as url OUTPUTNEW isDynDNS_local| eval isDynDNS = coalesce(isDynDNS_default, isDynDNS_local)|fields - isDynDNS_default, isDynDNS_local| search isDynDNS=True"
ec2_instance_modified_with_previously_unseen_user_filter,search *
ec2_instance_started_in_previously_unseen_region_filter,search *
ec2_instance_started_with_previously_unseen_ami_filter,search *
ec2_instance_started_with_previously_unseen_instance_type_filter,search *
ec2_instance_started_with_previously_unseen_user_filter,search *
ec2_modification_api_calls,(eventName=AssociateAddress OR eventName=AssociateIamInstanceProfile OR eventName=AttachClassicLinkVpc OR eventName=AttachNetworkInterface OR eventName=AttachVolume OR eventName=BundleInstance OR eventName=DetachClassicLinkVpc OR eventName=DetachVolume OR eventName=ModifyInstanceAttribute OR eventName=ModifyInstancePlacement OR eventName=MonitorInstances OR eventName=RebootInstances OR eventName=ResetInstanceAttribute OR eventName=StartInstances OR eventName=StopInstances OR eventName=TerminateInstances OR eventName=UnmonitorInstances)
elevated_group_discovery_with_net_filter,search *
elevated_group_discovery_with_powerview_filter,search *
elevated_group_discovery_with_wmic_filter,search *
email_attachments_with_lots_of_spaces_filter,search *
email_files_written_outside_of_the_outlook_directory_filter,search *
email_servers_sending_high_volume_traffic_to_hosts_filter,search *
enable_rdp_in_other_port_number_filter,search *
enable_wdigest_uselogoncredential_registry_filter,search *
enumerate_users_local_group_using_telegram_filter,search *
esentutl_sam_copy_filter,search *
etw_registry_disabled_filter,search *
eval_host_group,"eval group=if(unix_group==""*"", ""default"", unix_group)"
event-codes-search(3),"eventtype=wineventlog_windows LogName=""$LogName$"" SourceName=""$SourceName$"" TaskCategory=""$TaskCategory$"" | stats count by EventCode | sort +EventCode"
event-hosts-search,eventtype=wineventlog_windows | stats count by host | sort +host
event-types-search(4),"eventtype=wineventlog_windows LogName=""$LogName$"" SourceName=""$SourceName$"" TaskCategory=""$TaskCategory$"" EventCode=""$EventCode$"" | stats count by Type | sort +Type"
events-search(6),"eventtype=""wineventlog_windows"" source=""*inEventLog:$LogName$"" (host=""$EventHost$"" OR ComputerName=""$EventHost$"") TaskCategory=""$TaskCategory$"" SourceName=""$SourceName$"" EventCode=""$EventCode$"" Type=""$Type$"""
eventvwr_uac_bypass_filter,search *
evilginx_phishlets_0365,(query=login* AND query=www*)
evilginx_phishlets_amazon,(query=fls-na* AND query = www* AND query=images*)
evilginx_phishlets_aws,(query=www* AND query=aws* AND query=console.aws* AND query=signin.aws* AND api-northeast-1.console.aws* AND query=fls-na* AND query=images-na*)
evilginx_phishlets_facebook,(query=www* AND query = m* AND query=static*)
evilginx_phishlets_github,(query=api* AND query = github*)
evilginx_phishlets_google,(query=accounts* AND query=ssl* AND query=www*)
evilginx_phishlets_outlook,(query=outlook* AND query=login* AND query=account*)
excel_spawning_powershell_filter,search *
excel_spawning_windows_script_host_filter,search *
excessive_attempt_to_disable_services_filter,search *
excessive_distinct_processes_from_windows_temp_filter,search *
excessive_dns_failures_filter,search *
excessive_file_deletion_in_windefender_folder_filter,search *
excessive_number_of_service_control_start_as_disabled_filter,search *
excessive_number_of_taskhost_processes_filter,search *
excessive_service_stop_attempt_filter,search *
excessive_usage_of_cacls_app_filter,search *
excessive_usage_of_net_app_filter,search *
excessive_usage_of_nslookup_app_filter,search *
excessive_usage_of_sc_service_utility_filter,search *
excessive_usage_of_taskkill_filter,search *
exchange,"sourcetype=""MSWindows:IIS"""
exchange_powershell_abuse_via_ssrf_filter,search *
exchange_powershell_module_usage_filter,search *
executable_file_written_in_administrative_smb_share_filter,search *
executables_or_script_creation_in_suspicious_path_filter,search *
execute_javascript_with_jscript_com_clsid_filter,search *
execution_of_file_with_multiple_extensions_filter,search *
execution_of_file_with_spaces_before_extension_filter,search *
exploit_public_facing_application_via_apache_commons_text_filter,search *
exploit_public_facing_fortinet_fortinac_cve_2022_39952_filter,search *
extended_period_without_successful_netbackup_backups_filter,search *
extraction_of_registry_hives_filter,search *
f5_big_ip_icontrol_rest_vulnerability_cve_2022_1388_filter,search *
f5_bigip_rogue,"index=netops sourcetype=""f5:bigip:rogue"""
f5_tmui_authentication_bypass_filter,search *
Failed_Logins_by_Host(1),`os_index` eventtype=failed_login host=$host$
file_with_samsam_extension_filter,search *
filter_by_action(1),"if (""$action$"" != """", ""action = $action$"", """")"
filter_by_app(1),"if (""$appName$"" != """", ""appName = $appName$"", """")"
filter_by_app_count(1),"if (""$has_app_filter$"" = ""true"", ""countApps > 0"", """")"
filter_by_checksum(1),"if ($checksum$ > 0, ""checksum = $checksum$"", """")"
filter_by_client_id(1),"if (""$clientId$"" != """", ""data.clientId = $clientId$"", """")"
filter_by_error(1),"if (""$has_error$"" = ""true"",
  ""result != Ok"",
  if (""$has_error$"" = ""false"",
    ""result = Ok"",
    """"
  )
)"
filter_by_phonehome(1),"if ($minPhoneHomeTime$ > 0, ""lastPhoneHomeTime >= $minPhoneHomeTime$"", """")"
filter_by_ratio(2),"if ($ratio$ > 0, 
  if (""$greater_than$"" = ""true"",
    ""actual_ratio > $ratio$"",
    ""actual_ratio <= $ratio$""
  ),
  """"
)"
filter_by_serverclasses(1),"if (""$serverClassNames$"" != """", ""serverClassName IN ($serverClassNames$)"", """")"
filter_rare_process_allow_list,"lookup update=true lookup_rare_process_allow_list_default process as process OUTPUTNEW allow_list | where allow_list=""false"" | lookup update=true lookup_rare_process_allow_list_local process as process OUTPUT allow_list | where allow_list=""false"""
firewall_allowed_program_enable_filter,search *
first_time_seen_child_process_of_zoom_filter,search *
first_time_seen_command_line_argument_filter,search *
first_time_seen_running_windows_service_filter,search *
fodhelper_uac_bypass_filter,search *
format_bytes(1),"if($bytes$>1073741824, tostring(round($bytes$/1073741824,2))+"" GB"", if($bytes$>1048576, tostring(round($bytes$/1048576,2))+"" MB"", if($bytes$>1024, tostring(round($bytes$/1024))+"" KB"", tostring($bytes$)+"" Bytes"")))"
fortinet_appliance_auth_bypass_filter,search *
Frequently_Open_Ports_by_Host(1),`os_index` `open_ports_sourcetype` | multikv | stats count by Port | sort count
fsutil_zeroing_file_filter,search *
gcp_authentication_failed_during_mfa_challenge_filter,search *
gcp_detect_accounts_with_high_risk_roles_by_project_filter,search *
gcp_detect_gcploit_framework_filter,search *
gcp_detect_high_risk_permissions_by_resource_and_account_filter,search *
gcp_detect_oauth_token_abuse_filter,search *
gcp_kubernetes_cluster_pod_scan_detection_filter,search *
gcp_kubernetes_cluster_scan_detection_filter,search *
gcp_multi_factor_authentication_disabled_filter,search *
gcp_multiple_failed_mfa_requests_for_user_filter,search *
gcp_multiple_users_failing_to_authenticate_from_ip_filter,search *
gcp_successful_single_factor_authentication_filter,search *
gcp_unusual_number_of_failed_authentications_from_ip_filter,search *
gdrive_suspicious_file_sharing_filter,search *
get_addefaultdomainpasswordpolicy_with_powershell_filter,search *
get_addefaultdomainpasswordpolicy_with_powershell_script_block_filter,search *
get_aduser_with_powershell_filter,search *
get_aduser_with_powershell_script_block_filter,search *
get_aduserresultantpasswordpolicy_with_powershell_filter,search *
get_aduserresultantpasswordpolicy_with_powershell_script_block_filter,search *
get_domainpolicy_with_powershell_filter,search *
get_domainpolicy_with_powershell_script_block_filter,search *
get_domaintrust_with_powershell_filter,search *
get_domaintrust_with_powershell_script_block_filter,search *
get_domainuser_with_powershell_filter,search *
get_domainuser_with_powershell_script_block_filter,search *
get_foresttrust_with_powershell_filter,search *
get_foresttrust_with_powershell_script_block_filter,search *
get_signature(1),"(signature=""*$value$*"" OR signature_id=""*$value$*"")"
get_src_user_only(1),"(src_user=""$src_user$"" OR src_user_identity=""$src_user$"")"
get_subject(2),"($subjectField$=""$bestmatch$"" OR $subjectField$_ip=""$bestmatch$"" OR $subjectField$_mac=""$bestmatch$"" OR $subjectField$_nt_host=""$bestmatch$"" OR $subjectField$_dns=""$bestmatch$"")"
get_user(1),(`get_src_user_only($user$)` OR `get_user_only($user$)`)
get_user_only(1),"(user=""$user$"" OR user_identity=""$user$"")"
get_vendor_product,"eval vendor_product=case(isnotnull(vendor_product),vendor_product,isnotnull(vendor) AND vendor!=""unknown"" AND isnotnull(product) AND product!=""unknown"",vendor."" "".product,isnotnull(vendor) AND vendor!=""unknown"" AND (isnull(product) OR product=""unknown""),vendor."" unknown"",(isnull(vendor) OR vendor=""unknown"") AND isnotnull(product) AND product!=""unknown"",""unknown "".product,isnotnull(sourcetype),sourcetype,1=1,""unknown"")"
get_wmiobject_group_discovery_filter,search *
get_wmiobject_group_discovery_with_script_block_logging_filter,search *
getadcomputer_with_powershell_filter,search *
getadcomputer_with_powershell_script_block_filter,search *
getadgroup_with_powershell_filter,search *
getadgroup_with_powershell_script_block_filter,search *
getcurrent_user_with_powershell_filter,search *
getcurrent_user_with_powershell_script_block_filter,search *
getdomaincomputer_with_powershell_filter,search *
getdomaincomputer_with_powershell_script_block_filter,search *
getdomaincontroller_with_powershell_filter,search *
getdomaincontroller_with_powershell_script_block_filter,search *
getdomaingroup_with_powershell_filter,search *
getdomaingroup_with_powershell_script_block_filter,search *
getlocaluser_with_powershell_filter,search *
getlocaluser_with_powershell_script_block_filter,search *
getnettcpconnection_with_powershell_filter,search *
getnettcpconnection_with_powershell_script_block_filter,search *
getwmiobject_ds_computer_with_powershell_filter,search *
getwmiobject_ds_computer_with_powershell_script_block_filter,search *
getwmiobject_ds_group_with_powershell_filter,search *
getwmiobject_ds_group_with_powershell_script_block_filter,search *
getwmiobject_ds_user_with_powershell_filter,search *
getwmiobject_ds_user_with_powershell_script_block_filter,search *
getwmiobject_user_account_with_powershell_filter,search *
getwmiobject_user_account_with_powershell_script_block_filter,search *
github,sourcetype=aws:firehose:json
github_actions_disable_security_workflow_filter,search *
github_commit_changes_in_master_filter,search *
github_commit_in_develop_filter,search *
github_dependabot_alert_filter,search *
github_known_users,user IN (user_names_here)
github_pull_request_from_unknown_user_filter,search *
google_gcp_pubnet_message,"sourcetype=""google:gcp:pubsub:message"""
google_gcp_pubsub_message,"sourcetype=""google:gcp:pubsub:message"""
gpupdate_with_no_command_line_arguments_with_network_filter,search *
group_add,"eventtype=groupadd OR eventtype=""groupadd-suse"""
group_del,eventtype=groupdel
gsuite_calendar,sourcetype=gsuite:calendar:json
gsuite_drive,sourcetype=gsuite:drive:json
gsuite_drive_share_in_external_email_filter,search *
gsuite_email_suspicious_attachment_filter,search *
gsuite_email_suspicious_subject_with_attachment_filter,search *
gsuite_email_with_known_abuse_web_service_link_filter,search *
gsuite_gmail,sourcetype=gsuite:gmail:bigquery
gsuite_outbound_email_with_attachment_to_external_domain_filter,search *
gsuite_suspicious_calendar_invite_filter,search *
gsuite_suspicious_shared_file_name_filter,search *
gws_login_mfa_methods,"event.parameters{}.multiValue{} IN (""backup_code"", ""google_authenticator"", ""google_prompt"", ""idv_any_phone"", ""idv_preregistered_phone"", ""internal_two_factor"", ""knowledge_employee_id"", ""knowledge_preregistered_email"", ""login_location"", ""knowledge_preregistered_phone"", ""offline_otp"", ""security_key"", ""security_key_otp"")"
gws_reports_admin,sourcetype=gws:reports:admin
gws_reports_login,sourcetype=gws:reports:login
hardware_sourcetype,sourcetype=hardware
hash_admission_rule_predicate(1),"rex field=predicate ""^(?<beforeStr>.*$arg$\s*=\s*)(?<value>\S+)(?<afterStr>.*)"" | eval predicate=beforeStr.sha1(value).afterStr"
headless_browser_mockbin_or_mocky_request_filter,search *
headless_browser_usage_filter,search *
hide_user_account_from_sign_in_screen_filter,search *
hiding_files_and_directories_with_attrib_exe_filter,search *
high_frequency_copy_of_files_in_network_share_filter,search *
high_number_of_login_failures_from_a_single_source_filter,search *
high_process_termination_frequency_filter,search *
histperc(3),"sort $le$
| eventstats max($hist_rate$) as total_hist_rate, last($le$) as uppermost_bound, count as num_buckets
| eval rank=exact($perc$)*total_hist_rate
| streamstats current=f last($le$) as gr, last($hist_rate$) as last_hist_rate
| eval gr=if(isnull(gr), 0, gr), last_hist_rate=if(isnull(last_hist_rate), 0, last_hist_rate)
| where $hist_rate$ >= rank
| head 1
| eval res=case(lower(uppermost_bound) != ""+inf"" or num_buckets < 2, ""NaN"", lower($le$) == ""+inf"", gr, gr == 0 and $le$ <= 0, $le$, true(), exact(gr + ($le$-gr)*(rank - last_hist_rate) / ($hist_rate$ - last_hist_rate)))
| fields res
| rename res as ""histperc"""
histperc(4),"sort $groupby$, $le$
| eventstats max($hist_rate$) as total_hist_rate, last($le$) as uppermost_bound, count as num_buckets by $groupby$
| eval rank=exact($perc$)*total_hist_rate
| streamstats current=f last($le$) as gr, last($hist_rate$) as last_hist_rate by $groupby$
| eval gr=if(isnull(gr), 0, gr), last_hist_rate=if(isnull(last_hist_rate), 0, last_hist_rate)
| where $hist_rate$ >= rank
| dedup $groupby$
| eval res=case(lower(uppermost_bound) != ""+inf"" or num_buckets < 2, ""NaN"", lower($le$) == ""+inf"", gr, gr == 0 and $le$ <= 0, $le$, true(), exact(gr + ($le$-gr)*(rank - last_hist_rate) / ($hist_rate$ - last_hist_rate)))
| fields $groupby$, res
| rename res as ""histperc"""
home_cpu_idle(2),`os_index` `cpu_sourcetype` [ | inputlookup  dropdownsLookup | search $unix_category$ $unix_group$ | fields host] |mvexpand unix_group | mvexpand unix_category | search $unix_category$ $unix_group$ | eval pctUsed = 100-pctIdle | eval pctFree = pctIdle | stats median(pctFree) as metric by unix_group unix_category
home_cpu_used(2),`os_index` `cpu_sourcetype` [ | inputlookup  dropdownsLookup | search $unix_category$ $unix_group$ | fields host] |mvexpand unix_group | mvexpand unix_category | search $unix_category$ $unix_group$ | eval pctUsed = 100-pctIdle | eval pctFree = pctIdle | stats median(pctUsed) as metric by unix_group unix_category
home_disk_free(2),`os_index` `df_sourcetype` [ | inputlookup  dropdownsLookup | search $unix_category$ $unix_group$ | fields host] | mvexpand unix_group | mvexpand unix_category | search $unix_category$ $unix_group$ | strcat host '@' Filesystem Host_FileSystem | stats avg(PercentFreeSpace) as metric by unix_group unix_category
home_disk_used(2),`os_index` `df_sourcetype` [ | inputlookup  dropdownsLookup | search $unix_category$ $unix_group$ | fields host] | mvexpand unix_group | mvexpand unix_category | search $unix_category$ $unix_group$ | strcat host '@' Filesystem Host_FileSystem | stats avg(PercentUsedSpace) as metric by unix_group unix_category
home_memory(2),`os_index` `memory_sourcetype` [ | inputlookup  dropdownsLookup | search $unix_category$ $unix_group$ | fields host] | mvexpand unix_group | mvexpand unix_category | search $unix_category$ $unix_group$ | eval pctUsed = memUsedPct | eval pctFree = memFreePct | stats median(pctUsed) as metric by unix_group unix_category
home_memory_free(2),`os_index` `memory_sourcetype` [ | inputlookup  dropdownsLookup | search $unix_category$ $unix_group$ | fields host] | mvexpand unix_group | mvexpand unix_category | search $unix_category$ $unix_group$ | eval pctUsed = memUsedPct | eval pctFree = memFreePct | stats median(pctFree) as metric by unix_group unix_category
hosts_receiving_high_volume_of_network_traffic_from_email_server_filter,search *
hunting_3cxdesktopapp_software_filter,search *
hunting_for_log4shell_filter,search *
icacls_deny_command_filter,search *
icacls_grant_command_filter,search *
icedid_exfiltrated_archived_file_creation_filter,search *
identify_new_user_accounts_filter,search *
iis_get_webglobalmodule,"sourcetype=""Pwsh:InstalledIISModules"""
iis_operational_logs,"sourcetype=""IIS:Configuration:Operational"""
impacket_lateral_movement_commandline_parameters_filter,search *
impacket_lateral_movement_smbexec_commandline_parameters_filter,search *
impacket_lateral_movement_wmiexec_commandline_parameters_filter,search *
Init_All_MITRE_Rows(2),"append [| makeresults | eval $fieldname$=""Initial Access"", $countfield$=0 | fields - _time ] | append [| makeresults | eval $fieldname$=""Execution"", $countfield$=0 | fields - _time ] | append [| makeresults | eval $fieldname$=""Persistence"", $countfield$=0 | fields - _time ] | append [| makeresults | eval $fieldname$=""Privilege Escalation"", $countfield$=0 | fields - _time ] | append [| makeresults | eval $fieldname$=""Defense Evasion"", $countfield$=0 | fields - _time ] | append [| makeresults | eval $fieldname$=""Credential Access"", $countfield$=0 | fields - _time ] | append [| makeresults | eval $fieldname$=""Discovery"", $countfield$=0 | fields - _time ] | append [| makeresults | eval $fieldname$=""Lateral Movement"", $countfield$=0 | fields - _time ] | append [| makeresults | eval $fieldname$=""Collection"", $countfield$=0 | fields - _time ] | append [| makeresults | eval $fieldname$=""Command and Control"", $countfield$=0 | fields - _time ] | append [| makeresults | eval $fieldname$=""Exfiltration"", $countfield$=0 | fields - _time ] | append [| makeresults | eval $fieldname$=""Impact"", $countfield$=0 | fields - _time ]"
instrumentation_distribution_strings(3),"""\""avg\"":""+`instrumentation_number_format($name$_avg,$multiplier$,$round_digits$)` + "","" + ""\""min\"":""+`instrumentation_number_format($name$_min,$multiplier$,$round_digits$)` + "","" + ""\""max\"":""+`instrumentation_number_format($name$_max,$multiplier$,$round_digits$)` + "","" + ""\""p10\"":""+`instrumentation_number_format($name$_p10,$multiplier$,$round_digits$)` + "","" + ""\""p20\"":""+`instrumentation_number_format($name$_p20,$multiplier$,$round_digits$)` + "","" + ""\""p30\"":""+`instrumentation_number_format($name$_p30,$multiplier$,$round_digits$)` + "","" + ""\""p40\"":""+`instrumentation_number_format($name$_p40,$multiplier$,$round_digits$)` + "","" + ""\""p50\"":""+`instrumentation_number_format($name$_p50,$multiplier$,$round_digits$)` + "","" + ""\""p60\"":""+`instrumentation_number_format($name$_p60,$multiplier$,$round_digits$)` + "","" + ""\""p70\"":""+`instrumentation_number_format($name$_p70,$multiplier$,$round_digits$)` + "","" + ""\""p80\"":""+`instrumentation_number_format($name$_p80,$multiplier$,$round_digits$)` + "","" + ""\""p90\"":""+`instrumentation_number_format($name$_p90,$multiplier$,$round_digits$)`"
instrumentation_distribution_values(1),avg($name$) as $name$_avg min($name$) as $name$_min max($name$) as $name$_max perc10($name$) as $name$_p10 perc20($name$) as $name$_p20 perc30($name$) as $name$_p30 perc40($name$) as $name$_p40 perc50($name$) as $name$_p50 perc60($name$) as $name$_p60 perc70($name$) as $name$_p70 perc80($name$) as $name$_p80 perc90($name$) as $name$_p90
instrumentation_number_format(3),"tostring(coalesce(round($name$*$multiplier$,$round_digits$), ""null""))"
interactive_session_on_remote_endpoint_with_powershell_filter,search *
interfaces_sourcetype,sourcetype=interfaces
IO_Utilization_Exceeds_Threshold(1),"`os_index` `iostat_sourcetype` | stats avg(bandwUtilPct) as bandwidth_util by host | where bandwidth_util > $threshold$ | eval title=""IO_Utilization_Exceeds_Threshold"" | `unix_alert_decoration` | fields bandwidth_util, host, hosts, host_count, severity, sid, time_fired, _time"
IO_Wait_Exceeds_Threshold(1),"`os_index` `iostat_sourcetype` | stats avg(avgWaitMillis) as wait_time_millis by host | where wait_time_millis > $threshold$ | eval title=""IO_Wait_Exceeds_Threshold"" | `unix_alert_decoration` | fields wait_time_millis, host, hosts, host_count, severity, sid, time_fired, _time"
iostat_sourcetype,sourcetype=iostat
is_net_windows_file,lookup update=true is_net_windows_file filename as process_name OUTPUT netFile | lookup update=true is_net_windows_file originalFileName as original_file_name OUTPUT netFile | search netFile=true
is_nirsoft_software,lookup update=true is_nirsoft_software filename as process_name OUTPUT nirsoftFile | search nirsoftFile=true
is_windows_system_file,lookup update=true is_windows_system_file filename as process_name OUTPUT systemFile | search systemFile=true
ivanti_connect_secure_command_injection_attempts_filter,search *
ivanti_connect_secure_system_information_access_via_auth_bypass_filter,search *
ivanti_epmm_remote_unauthenticated_api_access_cve_2023_35078_filter,search *
ivanti_epmm_remote_unauthenticated_api_access_cve_2023_35082_filter,search *
ivanti_sentry_authentication_bypass_filter,search *
java_class_file_download_by_java_user_agent_filter,search *
java_writing_jsp_file_filter,search *
jenkins_arbitrary_file_read_cve_2024_23897_filter,search *
jetbrains_teamcity_rce_attempt_filter,search *
jscript_execution_using_cscript_app_filter,search *
juniper_networks_remote_code_execution_exploit_detection_filter,search *
kerberoasting_spn_request_with_rc4_encryption_filter,search *
kerberos_pre_authentication_flag_disabled_in_useraccountcontrol_filter,search *
kerberos_pre_authentication_flag_disabled_with_powershell_filter,search *
kerberos_service_ticket_request_using_rc4_encryption_filter,search *
kerberos_tgt_request_using_rc4_encryption_filter,search *
kerberos_user_enumeration_filter,search *
known_services_killed_by_ransomware_filter,search *
kube_allowed_images,"objectRef.name IN (*splunk*, *falco*)"
kube_allowed_loactions,"Country=""United States"""
kube_allowed_user_agents,userAgent=Helm/3.13.2
kube_allowed_user_groups,user.groups{} IN (admin)
kube_allowed_user_names,user.username=admin
kube_audit,"source=""kubernetes"""
kube_container_falco,"sourcetype=""kube:container:falco"""
kube_objects_events,sourcetype=kube:objects:events
kubernetes_abuse_of_secret_by_unusual_location_filter,search *
kubernetes_abuse_of_secret_by_unusual_user_agent_filter,search *
kubernetes_abuse_of_secret_by_unusual_user_group_filter,search *
kubernetes_abuse_of_secret_by_unusual_user_name_filter,search *
kubernetes_access_scanning_filter,search *
kubernetes_anomalous_inbound_network_activity_from_process_filter,search *
kubernetes_anomalous_inbound_outbound_network_io_filter,search *
kubernetes_anomalous_inbound_to_outbound_network_io_ratio_filter,search *
kubernetes_anomalous_outbound_network_activity_from_process_filter,search *
kubernetes_anomalous_traffic_on_network_edge_filter,search *
kubernetes_aws_detect_most_active_service_accounts_by_pod_filter,search *
kubernetes_aws_detect_sensitive_role_access_filter,search *
kubernetes_aws_detect_service_accounts_forbidden_failure_access_filter,search *
kubernetes_aws_detect_suspicious_kubectl_calls_filter,search *
kubernetes_azure,sourcetype=mscs:storage:blob:json
kubernetes_azure_active_service_accounts_by_pod_namespace_filter,search *
kubernetes_azure_detect_rbac_authorization_by_account_filter,search *
kubernetes_azure_detect_sensitive_object_access_filter,search *
kubernetes_azure_detect_sensitive_role_access_filter,search *
kubernetes_azure_detect_service_accounts_forbidden_failure_access_filter,search *
kubernetes_azure_detect_suspicious_kubectl_calls_filter,search *
kubernetes_azure_pod_scan_fingerprint_filter,search *
kubernetes_azure_scan_fingerprint_filter,search *
kubernetes_container_controller,sourcetype=kube:container:controller
kubernetes_create_or_update_privileged_pod_filter,search *
kubernetes_cron_job_creation_filter,search *
kubernetes_daemonset_deployed_filter,search *
kubernetes_falco_shell_spawned_filter,search *
kubernetes_gcp_detect_most_active_service_accounts_by_pod_filter,search *
kubernetes_gcp_detect_rbac_authorizations_by_account_filter,search *
kubernetes_gcp_detect_sensitive_object_access_filter,search *
kubernetes_gcp_detect_sensitive_role_access_filter,search *
kubernetes_gcp_detect_service_accounts_forbidden_failure_access_filter,search *
kubernetes_gcp_detect_suspicious_kubectl_calls_filter,search *
kubernetes_metrics,index=kubernetes_metrics
kubernetes_newly_seen_tcp_edge_filter,search *
kubernetes_newly_seen_udp_edge_filter,search *
kubernetes_nginx_ingress_lfi_filter,search *
kubernetes_nginx_ingress_rfi_filter,search *
kubernetes_node_port_creation_filter,search *
kubernetes_pod_created_in_default_namespace_filter,search *
kubernetes_pod_with_host_network_attachment_filter,search *
kubernetes_previously_unseen_container_image_name_filter,search *
kubernetes_previously_unseen_process_filter,search *
kubernetes_process_running_from_new_path_filter,search *
kubernetes_process_with_anomalous_resource_utilisation_filter,search *
kubernetes_process_with_resource_ratio_anomalies_filter,search *
kubernetes_scanner_image_pulling_filter,search *
kubernetes_scanning_by_unauthenticated_ip_address_filter,search *
kubernetes_shell_running_on_worker_node_filter,search *
kubernetes_shell_running_on_worker_node_with_cpu_activity_filter,search *
kubernetes_suspicious_image_pulling_filter,search *
kubernetes_unauthorized_access_filter,search *
large_volume_of_dns_any_queries_filter,search *
lastlog_sourcetype,sourcetype=lastlog
Latest_Disk_Used_by_Host(1),`os_index` `df_sourcetype` | dedup host
linux_account_manipulation_of_ssh_config_and_keys_filter,search *
linux_add_files_in_known_crontab_directories_filter,search *
linux_add_user_account_filter,search *
linux_adding_crontab_using_list_parameter_filter,search *
linux_apt_get_privilege_escalation_filter,search *
linux_apt_privilege_escalation_filter,search *
linux_at_allow_config_file_creation_filter,search *
linux_at_application_execution_filter,search *
linux_awk_privilege_escalation_filter,search *
linux_busybox_privilege_escalation_filter,search *
linux_c89_privilege_escalation_filter,search *
linux_c99_privilege_escalation_filter,search *
linux_change_file_owner_to_root_filter,search *
linux_clipboard_data_copy_filter,search *
linux_common_process_for_elevation_control_filter,search *
linux_composer_privilege_escalation_filter,search *
linux_cpulimit_privilege_escalation_filter,search *
linux_csvtool_privilege_escalation_filter,search *
linux_curl_upload_file_filter,search *
linux_data_destruction_command_filter,search *
linux_dd_file_overwrite_filter,search *
linux_decode_base64_to_shell_filter,search *
linux_deleting_critical_directory_using_rm_command_filter,search *
linux_deletion_of_cron_jobs_filter,search *
linux_deletion_of_init_daemon_script_filter,search *
linux_deletion_of_services_filter,search *
linux_deletion_of_ssl_certificate_filter,search *
linux_disable_services_filter,search *
linux_doas_conf_file_creation_filter,search *
linux_doas_tool_execution_filter,search *
linux_docker_privilege_escalation_filter,search *
linux_edit_cron_table_parameter_filter,search *
linux_emacs_privilege_escalation_filter,search *
linux_file_created_in_kernel_driver_directory_filter,search *
linux_file_creation_in_init_boot_directory_filter,search *
linux_file_creation_in_profile_directory_filter,search *
linux_find_privilege_escalation_filter,search *
linux_gdb_privilege_escalation_filter,search *
linux_gem_privilege_escalation_filter,search *
linux_gnu_awk_privilege_escalation_filter,search *
linux_hardware_addition_swapoff_filter,search *
linux_high_frequency_of_file_deletion_in_boot_folder_filter,search *
linux_high_frequency_of_file_deletion_in_etc_folder_filter,search *
linux_hosts,index=*
linux_impair_defenses_process_kill_filter,search *
linux_indicator_removal_clear_cache_filter,search *
linux_indicator_removal_service_file_deletion_filter,search *
linux_ingress_tool_transfer_hunting_filter,search *
linux_ingress_tool_transfer_with_curl_filter,search *
linux_insert_kernel_module_using_insmod_utility_filter,search *
linux_install_kernel_module_using_modprobe_utility_filter,search *
linux_iptables_firewall_modification_filter,search *
linux_java_spawning_shell_filter,search *
linux_kernel_module_enumeration_filter,search *
linux_kworker_process_in_writable_process_path_filter,search *
linux_make_privilege_escalation_filter,search *
linux_mysql_privilege_escalation_filter,search *
linux_ngrok_reverse_proxy_usage_filter,search *
linux_node_privilege_escalation_filter,search *
linux_nopasswd_entry_in_sudoers_file_filter,search *
linux_obfuscated_files_or_information_base64_decode_filter,search *
linux_octave_privilege_escalation_filter,search *
linux_openvpn_privilege_escalation_filter,search *
linux_persistence_and_privilege_escalation_risk_behavior_filter,search *
linux_php_privilege_escalation_filter,search *
linux_pkexec_privilege_escalation_filter,search *
linux_possible_access_or_modification_of_sshd_config_file_filter,search *
linux_possible_access_to_credential_files_filter,search *
linux_possible_access_to_sudoers_file_filter,search *
linux_possible_append_command_to_at_allow_config_file_filter,search *
linux_possible_append_command_to_profile_config_file_filter,search *
linux_possible_append_cronjob_entry_on_existing_cronjob_file_filter,search *
linux_possible_cronjob_modification_with_editor_filter,search *
linux_possible_ssh_key_file_creation_filter,search *
linux_preload_hijack_library_calls_filter,search *
linux_proxy_socks_curl_filter,search *
linux_puppet_privilege_escalation_filter,search *
linux_rpm_privilege_escalation_filter,search *
linux_ruby_privilege_escalation_filter,search *
linux_service_file_created_in_systemd_directory_filter,search *
linux_service_restarted_filter,search *
linux_service_started_or_enabled_filter,search *
linux_setuid_using_chmod_utility_filter,search *
linux_setuid_using_setcap_utility_filter,search *
linux_shells,"(Processes.process_name IN (""sh"", ""ksh"", ""zsh"", ""bash"", ""dash"", ""rbash"", ""fish"", ""csh"", ""tcsh"", ""ion"", ""eshell""))"
linux_shred_overwrite_command_filter,search *
linux_sqlite3_privilege_escalation_filter,search *
linux_ssh_authorized_keys_modification_filter,search *
linux_ssh_remote_services_script_execute_filter,search *
linux_stdout_redirection_to_dev_null_file_filter,search *
linux_stop_services_filter,search *
linux_sudo_or_su_execution_filter,search *
linux_sudoers_tmp_file_creation_filter,search *
linux_system_network_discovery_filter,search *
linux_system_reboot_via_system_request_key_filter,search *
linux_unix_shell_enable_all_sysrq_functions_filter,search *
linux_visudo_utility_execution_filter,search *
living_off_the_land_filter,search *
Load_Exceeds_by_Host(1),"`os_index` `memory_sourcetype` host=* | stats avg(loadAvg1mi) as Load_Avg_One_Minute by host | where Load_Avg_One_Minute > $threshold$ | eval title=""Load_Exceeds_by_Host"" | `unix_alert_decoration` | fields Load_Avg_One_Minute, host, hosts, host_count, severity, sid, time_fired, _time"
Load_Sample_Log_Data(1),"inputlookup [| inputlookup SampleDataList | search label=""$label$"" | rename lookup as search | table search]"
loading_of_dynwrapx_module_filter,search *
local_account_discovery_with_net_filter,search *
local_account_discovery_with_wmic_filter,search *
log-names-search,eventtype=wineventlog_windows | stats count by LogName | sort +LogName
log4shell_cve_2021_44228_exploitation_filter,search *
log4shell_jndi_payload_injection_attempt_filter,search *
log4shell_jndi_payload_injection_with_outbound_connection_filter,search *
logon_script_event_trigger_execution_filter,search *
lolbas_with_network_traffic_filter,search *
lsof_sourcetype,sourcetype=lsof
m365_default_index,(index=main OR index=*)
m365_teams_caller,"spath ""sessions{}"" output=""sessions""
| spath ""sessions{}.segments{}"" output=""segments""
| eval call_startDateTime = startDateTime, call_endDateTime = endDateTime
| eval number_of_sessions = mvcount(sessions), number_of_segments = mvcount(segments), call_id = id 
| fields _time call_startDateTime call_endDateTime call_id sessions number_of_sessions number_of_segments
| mvexpand sessions
| spath input=sessions path=id output=session_id
| spath input=sessions path=segments{} output=segments
| spath input=segments path=id output=segment_id
| fields _time call_startDateTime call_endDateTime call_id session_id segment_id segments number_of_sessions number_of_segments
| eval zip = mvzip(mvzip(session_id,segment_id,""########""),segments,""########"")
| fields _time call_startDateTime call_endDateTime call_id zip number_of_sessions number_of_segments
| mvexpand zip
| eval zip = split(zip,""########""), session_id = mvindex(zip,0), segment_id = mvindex(zip,1), segments = mvindex(zip,-1)
| fields - zip
| mvexpand segments
| spath input=segments path=endDateTime output=segment_endDateTime
| spath input=segments path=startDateTime output=segment_startDateTime
| spath input=segments path=caller output=caller
| spath input=segments path=media{} output=media
| eval number_of_media = mvcount(media)
| fields - segments
| mvexpand media
| spath input=media path=label output=media_label
| spath input=media path=""callerDevice"" 
| spath input=media path=""callerNetwork""
| spath input=callerDevice
| spath input=callerNetwork
| spath input=caller
| fields - media callerDevice callerNetwork caller
| foreach * 
    [ eval <<FIELD>> = if('<<FIELD>>'=""null"",null(),'<<FIELD>>')]"
m365_teams_indexes,(index=main OR index=*)
m365_teams_qos,"eval call_startDateTime = startDateTime, call_endDateTime = endDateTime
| spath ""sessions{}"" output=""sessions"" 
| eval number_of_sessions = mvcount('sessions{}.id'), number_of_segments = mvcount('sessions{}.segments{}.id'), call_id = id 
| fields _time call_startDateTime call_endDateTime call_id sessions number_of_sessions number_of_segments 
| mvexpand sessions 
| spath input=sessions path=id output=session_id 
| spath input=sessions path=segments{} output=segments 
| spath input=segments path=id output=segment_id 
| fields _time call_startDateTime call_endDateTime call_id session_id segment_id segments number_of_sessions number_of_segments 
| eval zip = mvzip(mvzip(session_id,segment_id,""########""),segments,""########"") 
| fields _time call_startDateTime call_endDateTime call_id zip number_of_sessions number_of_segments 
| mvexpand zip 
| eval zip = split(zip,""########""), session_id = mvindex(zip,0), segment_id = mvindex(zip,1), segments = mvindex(zip,-1) 
| fields - zip 
| mvexpand segments 
| spath input=segments path=endDateTime output=segment_endDateTime
| spath input=segments path=startDateTime output=segment_startDateTime
| spath input=segments path=media{} output=media 
| eval number_of_media = mvcount(media) 
| fields - segments 
| mvexpand media 
| spath input=media path=label output=media_label 
| spath input=media path=streams{} output=streams 
| eval number_of_streams = mvcount(streams) 
| fields - media 
| mvexpand streams 
| spath input=streams 
| fields - streams 
| foreach ""*Jitter"" averageRoundTripTime maxRoundTripTime 
    [ eval <<FIELD>> = tonumber(replace('<<FIELD>>',""PT(.*)S"",""\1""))]"
macos___re_opened_applications_filter,search *
macos_lolbin_filter,search *
macos_plutil_filter,search *
mailsniper_invoke_functions_filter,search *
make_subject(1),"eval ""$subjectField$""=case(isnotnull('$subjectField$'), '$subjectField$', isnotnull('$subjectField$_dns'), '$subjectField$_dns', isnotnull('$subjectField$_nt_host'), '$subjectField$_nt_host', isnotnull('$subjectField$_mac'), '$subjectField$_mac', isnotnull('$subjectField$_ip'), '$subjectField$_ip')"
malicious_inprocserver32_modification_filter,search *
malicious_powershell_executed_as_a_service_filter,search *
malicious_powershell_process___encoded_command_filter,search *
malicious_powershell_process___execution_policy_bypass_filter,search *
malicious_powershell_process_with_obfuscation_techniques_filter,search *
Max_Disk_Used_by_Host(1),"`os_index` `df_sourcetype` host=$host$ | fields UsePct, Filesystem |sort 1 UsePct, Filesystem, host"
Mem_Usage_by_Command_for_Host(1),`os_index` `ps_sourcetype` host=$host$ | timechart eval(median(RSZ_KB)/1024) as ResidentMB by COMMAND
Mem_Usage_for_Host(1),"`os_index` `memory_sourcetype` host=$host$ | timechart median(memFreePct) as Percent_Mem_Free, median(memUsedPct) as Percent_Mem_Used, median(swapUsedPct) as Percent_Swap"
Memory_Exceeds_MB_by_Host(1),"`os_index` `memory_sourcetype` host=* | stats first(memUsedMB) as UsedMemoryMB by host | where UsedMemoryMB > $threshold$ | eval title=""Memory_Exceeds_MB_by_Host"" | `unix_alert_decoration` | fields UsedMemoryMB, host, hosts, host_count, severity, sid, time_fired, _time"
Memory_Exceeds_MB_by_Process(1),"`os_index` `ps_sourcetype` host=* | stats first(RSZ_KB) as ResidentMB by COMMAND, host | eval ResidentMB = (ResidentMB/1024) | where ResidentMB > $threshold$ | eval title=""Memory_Exceeds_MB_by_Process"" | `unix_alert_decoration` | fields ResidentMB, COMMAND, host, hosts, host_count, severity, sid, time_fired, _time"
Memory_Exceeds_Percent_by_Host(1),"`os_index` `memory_sourcetype` host=* | stats first(memUsedPct) as UsedMemoryPercent by host | where UsedMemoryPercent > $threshold$ | eval title=""Memory_Exceeds_Percent_by_Host"" | `unix_alert_decoration` | fields UsedMemoryPercent, host, hosts, host_count, severity, sid, time_fired, _time"
Memory_Hardware_by_Host(1),"`os_index` `hardware_sourcetype` earliest=-1d host=$host$ | dedup host | eval k=if(unit==""kB"",1024,1) | eval RealMemoryMB = RealMemoryMB/k | eval SwapMemoryMB = SwapMemoryMB/k | fields + RealMemoryMB, SwapMemoryMB, host | chart max(RealMemoryMB) as Real_Memory_MB, max(SwapMemoryMB) as Swap_Memory_MB by host"
memory_sourcetype,sourcetype=vmstat
message_trace_index,(index=main OR index=*)
metadata_index,`os_index`
microsoft_sharepoint_server_elevation_of_privilege_filter,search *
mimikatz_passtheticket_commandline_parameters_filter,search *
mm_es_gen(1),"`mm_indicators($type$)` 
    | fillnull value=NULL autofocus_tags autofocus_grayware autofocus_malware confidence share_level 
    | eval af_tags=if(autofocus_tags == NULL, """", "" autofocus_tags:"" .mvjoin(autofocus_tags, "","")) 
    | eval af_grayware=if(autofocus_grayware == NULL, """", "" autofocus_grayware:"" .autofocus_grayware) 
    | eval af_malware=if(autofocus_malware == NULL, """", "" autofocus_malware:"" . autofocus_malware) 
    | eval feed_confidence=if(confidence == NULL, """", "" confidence:"" . confidence) 
    | eval feed_share_level=if(share_level == NULL, """", "" share_level:"" . share_level) 
    | eval description=""MineMeld feed:"" .splunk_source . feed_share_level . feed_confidence . af_grayware . af_malware . af_tags 
    | eval weight=case(share_level == ""green"", 0, share_level == ""yellow"", 1, share_level == ""amber"", 1, share_level == ""red"", 2)"
mm_indicators,"inputlookup minemeldfeeds_lookup 
    | rename value.* AS * 
    | fieldformat first_seen=strftime('first_seen' / 1000, ""%c"") 
    | fieldformat last_seen=strftime('last_seen' / 1000, ""%c"") 
    | fieldformat splunk_last_seen=strftime('splunk_last_seen', ""%c"") 
    | fieldformat autofocus_create_date=strftime('autofocus_create_date' / 1000, ""%c"")"
mm_indicators(1),"`mm_indicators` | search type=""$type$"""
mm_stats,"sourcetype=""pan:minemeld"""
mmc_lolbas_execution_process_spawn_filter,search *
modification_of_wallpaper_filter,search *
modify_acl_permission_to_files_or_folder_filter,search *
modular_action_invocations(2),"tstats summariesonly=false latest(Modular_Actions.action_status) as action_status from datamodel=Splunk_Audit.Modular_Actions where Modular_Actions.action_name!=""unknown"" (Modular_Actions.sid=""$sid$"" Modular_Actions.rid=""$rid$"") OR (Modular_Actions.orig_sid=""$sid$"" Modular_Actions.orig_rid=""$rid$"") by _time,nodename,Modular_Actions.action_name,Modular_Actions.sid,Modular_Actions.rid,Modular_Actions.action_mode,Modular_Actions.user span=1s | `drop_dm_object_name(""Modular_Actions"")` | eventstats latest(action_status) as action_status by action_name,sid,rid | search nodename=""Modular_Actions.Modular_Action_Invocations"" | sort 0 -_time | join type=outer action_name [| rest splunk_server=local count=0 /services/alerts/alert_actions | spath input=param._cam path=drilldown_uri output=action_drilldown_uri | rename title as action_name,label as action_label | fields action_name,action_label,action_drilldown_uri] | eval action_label=if(isnotnull(action_label),action_label,action_name),epoch_time=_time | fields _time,epoch_time,action_status,action_name,action_label,action_mode,action_drilldown_uri,sid,rid,user"
monitor_dns_for_brand_abuse_filter,search *
monitor_email_for_brand_abuse_filter,search *
monitor_registry_keys_for_print_monitors_filter,search *
monitor_web_traffic_for_brand_abuse_filter,search *
ms_defender,"source=""WinEventLog:Microsoft-Windows-Windows Defender/Operational"""
ms_exchange_mailbox_replication_service_writing_active_server_pages_filter,search *
ms_scripting_process_loading_ldap_module_filter,search *
ms_scripting_process_loading_wmi_module_filter,search *
msbuild_suspicious_spawned_by_script_process_filter,search *
msexchange_management,sourcetype=MSExchange:management
mshta_spawning_rundll32_or_regsvr32_process_filter,search *
mshtml_module_load_in_office_product_filter,search *
msi_module_loaded_by_non_system_binary_filter,search *
msmpeng_application_dll_side_loading_filter,search *
multiple_archive_files_http_post_traffic_filter,search *
multiple_okta_users_with_invalid_credentials_from_the_same_ip_filter,search *
net_localgroup_discovery_filter,search *
net_profiler_uac_bypass_filter,search *
netbackup,"sourcetype=""netbackup_logs"""
netmon-hosts-search,eventtype=netmon_windows | stats count by host | sort +host
netstat_sourcetype,sourcetype=netstat
network_acl_events,(eventName = CreateNetworkAcl OR eventName = CreateNetworkAclEntry OR eventName = DeleteNetworkAcl OR eventName = DeleteNetworkAclEntry OR eventName = ReplaceNetworkAclEntry OR eventName = ReplaceNetworkAclAssociation)
network_connection_discovery_with_arp_filter,search *
network_connection_discovery_with_net_filter,search *
network_connection_discovery_with_netstat_filter,search *
network_discovery_using_route_windows_app_filter,search *
network_share_discovery_via_dir_command_filter,search *
ngrok_reverse_proxy_on_network_filter,search *
nishang_powershelltcponeline_filter,search *
nix-netmon-hosts-search,eventtype=netstat | stats count by host | sort +host
nltest_domain_trust_discovery_filter,search *
no_windows_updates_in_a_time_frame_filter,search *
non_chrome_process_accessing_chrome_default_dir_filter,search *
non_firefox_process_access_firefox_profile_dir_filter,search *
notable,index=notable
notepad_with_no_command_line_arguments_filter,search *
ntdsutil_export_ntds_filter,search *
Number_Processes_by_Host(1),`os_index` `memory_sourcetype` host=$host$ | timechart avg(processes) by host
Number_Threads_by_Host(1),`os_index` `memory_sourcetype` host=$host$ | timechart avg(threads) by host
nvm_flowdata_index,"(index=""main"" OR index=""cisco_nvm_flowdata"") sourcetype=""cisco:nvm:flowdata"""
nvm_ifdata_index,"(index=""main"" OR index=""cisco_nvm_ifdata"") sourcetype=""cisco:nvm:ifdata"""
nvm_sysdata_index,"(index=""main"" OR index=""cisco_nvm_sysdata"") sourcetype=""cisco:nvm:sysdata"""
o365_add_app_role_assignment_grant_user_filter,search *
o365_added_service_principal_filter,search *
o365_advanced_audit_disabled_filter,search *
o365_application_registration_owner_added_filter,search *
o365_applicationimpersonation_role_assigned_filter,search *
o365_block_user_consent_for_risky_apps_disabled_filter,search *
o365_bypass_mfa_via_trusted_ip_filter,search *
o365_concurrent_sessions_from_different_ips_filter,search *
o365_disable_mfa_filter,search *
o365_excessive_authentication_failures_alert_filter,search *
o365_excessive_sso_logon_errors_filter,search *
o365_file_permissioned_application_consent_granted_by_user_filter,search *
o365_graph,sourcetype=o365:graph:api
o365_high_number_of_failed_authentications_for_user_filter,search *
o365_high_privilege_role_granted_filter,search *
o365_mail_permissioned_application_consent_granted_by_user_filter,search *
o365_mailbox_inbox_folder_shared_with_all_users_filter,search *
o365_mailbox_read_access_granted_to_application_filter,search *
o365_management_activity,sourcetype=o365:management:activity
o365_multi_source_failed_authentications_spike_filter,search *
o365_multiple_appids_and_useragents_authentication_spike_filter,search *
o365_multiple_failed_mfa_requests_for_user_filter,search *
o365_multiple_users_failing_to_authenticate_from_ip_filter,search *
o365_new_federated_domain_added_filter,search *
o365_new_mfa_method_registered_filter,search *
o365_pst_export_alert_filter,search *
o365_service_principal_new_client_credentials_filter,search *
o365_sourcetypes,"sourcetype=""o365:management:activity"""
o365_suspicious_admin_email_forwarding_filter,search *
o365_suspicious_rights_delegation_filter,search *
o365_suspicious_user_email_forwarding_filter,search *
o365_tenant_wide_admin_consent_granted_filter,search *
o365_user_consent_blocked_for_risky_application_filter,search *
o365_user_consent_denied_for_oauth_application_filter,search *
office_application_drop_executable_filter,search *
office_application_spawn_regsvr32_process_filter,search *
office_application_spawn_rundll32_process_filter,search *
office_document_creating_schedule_task_filter,search *
office_document_executing_macro_code_filter,search *
office_document_spawned_child_process_to_download_filter,search *
office_product_spawn_cmd_process_filter,search *
office_product_spawning_bitsadmin_filter,search *
office_product_spawning_certutil_filter,search *
office_product_spawning_mshta_filter,search *
office_product_spawning_rundll32_with_no_dll_filter,search *
office_product_spawning_windows_script_host_filter,search *
office_product_spawning_wmic_filter,search *
office_product_writing_cab_or_inf_filter,search *
office_spawning_control_filter,search *
okta,eventtype=okta_log
okta_account_locked_out_filter,search *
okta_account_lockout_events_filter,search *
okta_failed_sso_attempts_filter,search *
okta_indexes,()
okta_mfa_exhaustion_hunt_filter,search *
okta_mismatch_between_source_and_response_for_verify_push_request_filter,search *
okta_multiple_failed_requests_to_access_applications_filter,search *
okta_new_api_token_created_filter,search *
okta_new_device_enrolled_on_account_filter,search *
okta_phishing_detection_with_fastpass_origin_check_filter,search *
okta_risk_threshold_exceeded_filter,search *
okta_suspicious_activity_reported_filter,search *
okta_suspicious_use_of_a_session_cookie_filter,search *
okta_threatinsight_login_failure_with_high_unknown_users_filter,search *
okta_threatinsight_suspected_passwordspray_attack_filter,search *
okta_threatinsight_threat_detected_filter,search *
okta_two_or_more_rejected_okta_pushes_filter,search *
okta_user_logins_from_multiple_cities_filter,search *
Open_Files_by_Command_and_Host(1),`os_index` `lsof_sourcetype` host=$host$ | eval time=_time| timechart eval(count/dc(time)) by COMMAND
Open_Files_by_Type_and_Host(1),`os_index` `lsof_sourcetype` host=$host$ | eval time =_time | timechart eval(count/dc(time)) by TYPE
Open_Files_by_User_and_Host(1),`os_index` `lsof_sourcetype` host=$host$ | eval time=_time | timechart eval(count/dc(time)) by USER
Open_Files_Exceeds_by_Process(1),"`os_index` `lsof_sourcetype` host=* | stats count by _time, PID, COMMAND, host | stats first(count) as OpenFiles by PID, COMMAND, host | where OpenFiles > $threshold$ | eval title=""Open_Files_Exceeds_by_Process"" | `unix_alert_decoration` | fields OpenFiles, PID, COMMAND, host, hosts, host_count, severity, sid, time_fired, _time"
Open_Ports_by_Host(1),"`os_index` `open_ports_sourcetype` host=$host$ | head 1 | multikv fields Proto, Port | eval PortOverProto = case(Port == ""8089"", ""Splunk Management Port"", Port == ""8000"", ""Splunk HTTP Port"", Port == ""21"", ""ftp"", Port == ""22"", ""ssh"", Port == ""23"", ""telnet"", Port == ""25"", ""smtp"", Port == ""69"", ""tftp"", Port == ""79"", ""finger"", Port == ""80"", ""http"", Port == ""88"", ""kerberos"", Port == ""143"", ""imap"", Port == ""161"", ""snmp"", Port == ""162"", ""snmptrap"", Port == ""179"", ""bgp"", Port == ""1521"", ""SQL*Net"", 1==1, Port."" / "".Proto) | chart count by PortOverProto | sort count desc | rename count as ""# of Connections Accepted"""
open_ports_sourcetype,sourcetype=openPorts
open_redirect_in_splunk_web_filter,search *
os_index,index=os
osquery,sourcetype=osquery:results
osquery_pack___coldroot_detection_filter,search *
osquery_process,"eventtype=""osquery-process"""
outbound_network_connection_from_java_using_default_ports_filter,search *
overwriting_accessibility_binaries_filter,search *
package_sourcetype,sourcetype=package
pan_autofocus_tag_class(1),"`pan_autofocus_tags` | search aftag:tag_class=""$tagclass$"""
pan_autofocus_tag_name(1),"`pan_autofocus_tags` | search aftag:public_tag_name=""$name$"""
pan_autofocus_tags,inputlookup autofocus_tag_lookup
papercut_ng_remote_web_access_attempt_filter,search *
papercut_ng_suspicious_behavior_debug_log_filter,search *
papercutng,"sourcetype=""papercutng"""
parse_disk_size(1),"case(substr($disk$, -2, 1) == ""T"", tonumber(substr($disk$, 1, len($disk$) - 2)) * 1024 * 1024, substr($disk$, -2, 1) == ""G"", tonumber(substr($disk$, 1, len($disk$) - 2)) * 1024, substr($disk$, -2, 1) == ""M"", tonumber(substr($disk$, 1, len($disk$) - 2)), substr($disk$, -1) == ""T"", tonumber(substr($disk$, 1, len($disk$) - 1)) * 1024 * 1024, substr($disk$, -1) == ""G"", tonumber(substr($disk$, 1, len($disk$) - 1)) * 1024, substr($disk$, -1) == ""M"", tonumber(substr($disk$, 1, len($disk$) - 1)))"
password_change,eventtype=linux-password-change
password_change_failed,eventtype=linux-password-change-failed
password_policy_discovery_with_net_filter,search *
path_traversal_spl_injection,index=_internal sourcetype=splunkd_ui_access
path_traversal_spl_injection_filter,search *
Percent_CPU_by_Host(1),`os_index` `cpu_sourcetype` host=$host$ | eval Percent_CPU_Load = 100 - pctIdle | timechart avg(Percent_CPU_Load) by host
Percent_Load_by_Host(1),`os_index` `memory_sourcetype` host=$host$ | timechart avg(loadAvg1mi) by host
Percent_MEM_by_Host(1),`os_index` `memory_sourcetype` host=$host$ | timechart median(memUsedPct) by host
permission_modification_using_takeown_app_filter,search *
persistent_xss_in_rapiddiag_through_user_interface_views_filter,search *
petitpotam_network_share_access_request_filter,search *
petitpotam_suspicious_kerberos_tgt_request_filter,search *
ping_sleep_batch_command_filter,search *
pingid,source=PINGID
pingid_mismatch_auth_source_and_verification_response_filter,search *
pingid_multiple_failed_mfa_requests_for_user_filter,search *
pingid_new_mfa_method_after_credential_reset_filter,search *
pingid_new_mfa_method_registered_for_user_filter,search *
plain_http_post_exfiltrated_data_filter,search *
possible_browser_pass_view_parameter_filter,search *
possible_lateral_movement_powershell_spawn_filter,search *
potential_password_in_username_false_positive_reduction,search *
potential_password_in_username_filter,search *
potentially_malicious_code_on_cmdline_tokenize_score,"eval orig_process=process, process=replace(lower(process), ""`"", """") | makemv tokenizer=""([\w\d\-]+)"" process | eval unusual_cmdline_feature_for=if(match(process, ""^for$""), mvcount(mvfilter(match(process, ""^for$""))), 0), unusual_cmdline_feature_netsh=if(match(process, ""^netsh$""), mvcount(mvfilter(match(process, ""^netsh$""))), 0), unusual_cmdline_feature_readbytes=if(match(process, ""^readbytes$""), mvcount(mvfilter(match(process, ""^readbytes$""))), 0), unusual_cmdline_feature_set=if(match(process, ""^set$""), mvcount(mvfilter(match(process, ""^set$""))), 0), unusual_cmdline_feature_unrestricted=if(match(process, ""^unrestricted$""), mvcount(mvfilter(match(process, ""^unrestricted$""))), 0), unusual_cmdline_feature_winstations=if(match(process, ""^winstations$""), mvcount(mvfilter(match(process, ""^winstations$""))), 0), unusual_cmdline_feature_-value=if(match(process, ""^-value$""), mvcount(mvfilter(match(process, ""^-value$""))), 0), unusual_cmdline_feature_compression=if(match(process, ""^compression$""), mvcount(mvfilter(match(process, ""^compression$""))), 0), unusual_cmdline_feature_server=if(match(process, ""^server$""), mvcount(mvfilter(match(process, ""^server$""))), 0), unusual_cmdline_feature_set-mppreference=if(match(process, ""^set-mppreference$""), mvcount(mvfilter(match(process, ""^set-mppreference$""))), 0), unusual_cmdline_feature_terminal=if(match(process, ""^terminal$""), mvcount(mvfilter(match(process, ""^terminal$""))), 0), unusual_cmdline_feature_-name=if(match(process, ""^-name$""), mvcount(mvfilter(match(process, ""^-name$""))), 0), unusual_cmdline_feature_catch=if(match(process, ""^catch$""), mvcount(mvfilter(match(process, ""^catch$""))), 0), unusual_cmdline_feature_get-wmiobject=if(match(process, ""^get-wmiobject$""), mvcount(mvfilter(match(process, ""^get-wmiobject$""))), 0), unusual_cmdline_feature_hklm=if(match(process, ""^hklm$""), mvcount(mvfilter(match(process, ""^hklm$""))), 0), unusual_cmdline_feature_streamreader=if(match(process, ""^streamreader$""), mvcount(mvfilter(match(process, ""^streamreader$""))), 0), unusual_cmdline_feature_system32=if(match(process, ""^system32$""), mvcount(mvfilter(match(process, ""^system32$""))), 0), unusual_cmdline_feature_username=if(match(process, ""^username$""), mvcount(mvfilter(match(process, ""^username$""))), 0), unusual_cmdline_feature_webrequest=if(match(process, ""^webrequest$""), mvcount(mvfilter(match(process, ""^webrequest$""))), 0), unusual_cmdline_feature_count=if(match(process, ""^count$""), mvcount(mvfilter(match(process, ""^count$""))), 0), unusual_cmdline_feature_webclient=if(match(process, ""^webclient$""), mvcount(mvfilter(match(process, ""^webclient$""))), 0), unusual_cmdline_feature_writeallbytes=if(match(process, ""^writeallbytes$""), mvcount(mvfilter(match(process, ""^writeallbytes$""))), 0), unusual_cmdline_feature_convert=if(match(process, ""^convert$""), mvcount(mvfilter(match(process, ""^convert$""))), 0), unusual_cmdline_feature_create=if(match(process, ""^create$""), mvcount(mvfilter(match(process, ""^create$""))), 0), unusual_cmdline_feature_function=if(match(process, ""^function$""), mvcount(mvfilter(match(process, ""^function$""))), 0), unusual_cmdline_feature_net=if(match(process, ""^net$""), mvcount(mvfilter(match(process, ""^net$""))), 0), unusual_cmdline_feature_com=if(match(process, ""^com$""), mvcount(mvfilter(match(process, ""^com$""))), 0), unusual_cmdline_feature_http=if(match(process, ""^http$""), mvcount(mvfilter(match(process, ""^http$""))), 0), unusual_cmdline_feature_io=if(match(process, ""^io$""), mvcount(mvfilter(match(process, ""^io$""))), 0), unusual_cmdline_feature_system=if(match(process, ""^system$""), mvcount(mvfilter(match(process, ""^system$""))), 0), unusual_cmdline_feature_new-object=if(match(process, ""^new-object$""), mvcount(mvfilter(match(process, ""^new-object$""))), 0), unusual_cmdline_feature_if=if(match(process, ""^if$""), mvcount(mvfilter(match(process, ""^if$""))), 0), unusual_cmdline_feature_threading=if(match(process, ""^threading$""), mvcount(mvfilter(match(process, ""^threading$""))), 0), unusual_cmdline_feature_mutex=if(match(process, ""^mutex$""), mvcount(mvfilter(match(process, ""^mutex$""))), 0), unusual_cmdline_feature_cryptography=if(match(process, ""^cryptography$""), mvcount(mvfilter(match(process, ""^cryptography$""))), 0), unusual_cmdline_feature_computehash=if(match(process, ""^computehash$""), mvcount(mvfilter(match(process, ""^computehash$""))), 0)"
potentially_malicious_code_on_commandline_filter,search *
powershell,"(source=WinEventLog:Microsoft-Windows-PowerShell/Operational OR source=""XmlWinEventLog:Microsoft-Windows-PowerShell/Operational"")"
powershell_4104_hunting_filter,search *
powershell___connect_to_internet_with_hidden_window_filter,search *
powershell_com_hijacking_inprocserver32_modification_filter,search *
powershell_creating_thread_mutex_filter,search *
powershell_disable_security_monitoring_filter,search *
powershell_domain_enumeration_filter,search *
powershell_enable_powershell_remoting_filter,search *
powershell_enable_smb1protocol_feature_filter,search *
powershell_execute_com_object_filter,search *
powershell_fileless_process_injection_via_getprocaddress_filter,search *
powershell_fileless_script_contains_base64_encoded_content_filter,search *
powershell_get_localgroup_discovery_filter,search *
powershell_get_localgroup_discovery_with_script_block_logging_filter,search *
powershell_invoke_cimmethod_cimsession_filter,search *
powershell_invoke_wmiexec_usage_filter,search *
powershell_load_module_in_meterpreter_filter,search *
powershell_loading_dotnet_into_memory_via_reflection_filter,search *
powershell_processing_stream_of_data_filter,search *
powershell_remote_services_add_trustedhost_filter,search *
powershell_remote_thread_to_known_windows_process_filter,search *
powershell_remove_windows_defender_directory_filter,search *
powershell_script_block_with_url_chain_filter,search *
powershell_start_bitstransfer_filter,search *
powershell_start_or_stop_service_filter,search *
powershell_using_memory_as_backing_store_filter,search *
powershell_webrequest_using_memory_stream_filter,search *
powershell_windows_defender_exclusion_commands_filter,search *
prevent_automatic_repair_mode_using_bcdedit_filter,search *
previously_seen_cloud_api_calls_per_user_role_forget_window,"""-90d@d"""
previously_seen_cloud_compute_creations_by_user_search_window_begin_offset,"""-70m@m"""
previously_seen_cloud_compute_image_search_window_begin_offset,"""-70m@m"""
previously_seen_cloud_compute_images_forget_window,"""-90d@d"""
previously_seen_cloud_compute_instance_type_forget_window,"""-90d@d"""
previously_seen_cloud_compute_instance_types_search_window_begin_offset,"""-70m@m"""
previously_seen_cloud_instance_modifications_by_user_search_window_begin_offset,"""-70m@m"""
previously_seen_cloud_provisioning_activity_forget_window,"""-90d@d"""
previously_seen_cloud_region_forget_window,"""-90d@d"""
previously_seen_cloud_regions_search_window_begin_offset,"""-70m@m"""
previously_seen_windows_services_forget_window,"""-90d@d"""
previously_seen_windows_services_window,"""-70m@m"""
previously_seen_zoom_child_processes_forget_window,"""-90d@d"""
previously_seen_zoom_child_processes_window,"""-70m@m"""
previously_unseen_cloud_provisioning_activity_window,"""-70m@m"""
print_processor_registry_autostart_filter,search *
print_spooler_adding_a_printer_driver_filter,search *
print_spooler_failed_to_load_a_plug_in_filter,search *
printservice,"source=""wineventlog:microsoft-windows-printservice/operational"" OR source=""WinEventLog:Microsoft-Windows-PrintService/Admin"""
process_bitsadmin,(Processes.process_name=bitsadmin.exe OR Processes.original_file_name=bitsadmin.exe)
process_certutil,(Processes.process_name=certutil.exe OR Processes.original_file_name=CertUtil.exe)
process_cmd,(Processes.process_name=cmd.exe OR Processes.original_file_name=Cmd.Exe)
process_copy,(Processes.process_name=copy.exe OR Processes.original_file_name=copy.exe OR Processes.process_name=xcopy.exe OR Processes.original_file_name=xcopy.exe)
process_creating_lnk_file_in_suspicious_location_filter,search *
process_csc,(Processes.process_name=csc.exe OR Processes.original_file_name=csc.exe)
process_curl,(Processes.process_name=curl.exe OR Processes.original_file_name=Curl.exe)
process_deleting_its_process_file_path_filter,search *
process_diskshadow,(Processes.process_name=diskshadow.exe OR Processes.original_file_name=diskshadow.exe)
process_dllhost,(Processes.process_name=dllhost.exe OR Processes.original_file_name=dllhost.exe)
process_dsquery,(Processes.process_name=dsquery.exe OR Processes.original_file_name=dsquery.exe)
process_dxdiag,(Processes.process_name=dxdiag.exe OR Processes.original_file_name=dxdiag.exe)
process_esentutl,(Processes.process_name=esentutl.exe OR Processes.original_file_name=esentutl.exe)
process_execution_via_wmi_filter,search *
process_fodhelper,(Processes.process_name=fodhelper.exe OR Processes.original_file_name=FodHelper.EXE)
process_gpupdate,(Processes.process_name=gpupdate.exe OR Processes.original_file_name=GPUpdate.exe)
process_hh,(Processes.process_name=hh.exe OR Processes.original_file_name=HH.EXE)
process_installutil,(Processes.process_name=installutil.exe OR Processes.original_file_name=InstallUtil.exe)
process_kill_base_on_file_path_filter,search *
process_microsoftworkflowcompiler,(Processes.process_name=microsoft.workflow.compiler.exe OR Processes.original_file_name=Microsoft.Workflow.Compiler.exe)
process_msbuild,(Processes.process_name=msbuild.exe OR Processes.original_file_name=MSBuild.exe)
process_mshta,(Processes.process_name=mshta.exe OR Processes.original_file_name=MSHTA.EXE)
process_msiexec,(Processes.process_name=msiexec.exe OR Processes.original_file_name=msiexec.exe)
process_net,"(Processes.process_name=""net.exe"" OR Processes.original_file_name=""net.exe"" OR Processes.process_name=""net1.exe"" OR Processes.original_file_name=""net1.exe"")"
process_netsh,(Processes.process_name=netsh.exe OR Processes.original_file_name=netsh.exe)
process_nltest,(Processes.process_name=nltest.exe OR Processes.original_file_name=nltestrk.exe)
process_ntdsutil,(Processes.process_name=ntdsutil.exe OR Processes.original_file_name=ntdsutil.exe)
process_ping,(Processes.process_name=ping.exe OR Processes.original_file_name=ping.exe)
process_powershell,(Processes.process_name=pwsh.exe OR Processes.process_name=sqlps.exe OR Processes.process_name=sqltoolsps.exe OR Processes.process_name=powershell.exe OR Processes.process_name=powershell_ise.exe OR Processes.original_file_name=pwsh.dll OR Processes.original_file_name=PowerShell.EXE OR Processes.original_file_name=powershell_ise.EXE)
process_procdump,(Processes.process_name=procdump.exe OR Processes.process_name=procdump64.exe OR Processes.original_file_name=procdump)
process_psexec,(Processes.process_name=psexec.exe OR Processes.process_name=psexec64.exe OR Processes.original_file_name=psexec.c)
process_rclone,(Processes.original_file_name=rclone.exe OR Processes.process_name=rclone.exe)
process_reg,(Processes.process_name=reg.exe OR Processes.original_file_name=reg.exe)
process_regasm,(Processes.process_name=regasm.exe OR Processes.original_file_name=RegAsm.exe)
process_regsvcs,(Processes.process_name=regsvcs.exe OR Processes.original_file_name=RegSvcs.exe)
process_regsvr32,(Processes.process_name=regsvr32.exe OR Processes.original_file_name=REGSVR32.EXE)
process_route,(Processes.process_name=route.exe OR Processes.original_file_name=route.exe)
process_runas,(Processes.process_name=runas.exe OR Processes.original_file_name=runas.exe)
process_rundll32,(Processes.process_name=rundll32.exe OR Processes.original_file_name=RUNDLL32.EXE)
process_schtasks,(Processes.process_name=schtasks.exe OR Processes.original_file_name=schtasks.exe)
process_sdelete,(Processes.process_name=sdelete.exe OR Processes.original_file_name=sdelete.exe)
process_setspn,(Processes.process_name=setspn.exe OR Processes.original_file_name=setspn.exe)
process_verclsid,(Processes.process_name=verclsid.exe OR Processes.original_file_name=verclsid.exe)
process_vssadmin,(Processes.process_name=vssadmin.exe OR Processes.original_file_name=VSSADMIN.EXE)
process_wbadmin,(Processes.process_name=wbadmin.exe OR Processes.original_file_name=WBADMIN.EXE)
process_wermgr,(Processes.process_name=wermgr.exe OR Processes.original_file_name=wermgr.EXE)
process_wmic,(Processes.process_name=wmic.exe OR Processes.original_file_name=wmic.exe)
process_writing_dynamicwrapperx_filter,search *
processes_created_by_netsh_filter,search *
Processes_Exceeds_by_Host(1),"`os_index` `memory_sourcetype` host=* | stats avg(processes) as Total_Processes by host | where Total_Processes > $threshold$ | eval title=""Processes_Exceeds_by_Host"" | `unix_alert_decoration` | fields Total_Processes, host, hosts, host_count, severity, sid, time_fired, _time"
processes_launching_netsh_filter,search *
processes_tapping_keyboard_events_filter,search *
prohibited_apps_launching_cmd,"| inputlookup prohibited_apps_launching_cmd | rename prohibited_applications as parent_process_name | eval parent_process_name=""*"" . parent_process_name | table parent_process_name"
prohibited_network_traffic_allowed_filter,search *
prohibited_software_on_endpoint_filter,search *
prohibited_softwares,lookup prohibited_softwares app as process_name OUTPUT is_prohibited | search is_prohibited=True
protocol_or_port_mismatch_filter,search *
protocol_sourcetype,sourcetype=protocol
protocols_passing_authentication_in_cleartext_filter,search *
proxyshell_proxynotshell_behavior_detected_filter,search *
ps_sourcetype,sourcetype=ps
randomly_generated_scheduled_task_name_filter,search *
randomly_generated_windows_service_name_filter,search *
ransomware_extensions,lookup update=true ransomware_extensions_lookup Extensions AS file_extension OUTPUT Name | search Name !=False
ransomware_notes,"lookup ransomware_notes_lookup ransomware_notes as file_name OUTPUT status as ""Known Ransomware Notes"" | search ""Known Ransomware Notes""=True"
ransomware_notes_bulk_creation_filter,search *
recommended_datamodel_attributes(2),"datamodel ""$model$"" ""$object$"" | spath output=calcs path=calculations{} | spath output=fields path=fields{} | eval outfields=mvappend(fields,NULL,calcs) | mvexpand outfields | spath output=fields input=outfields path=outputFields{} | eval fields=if(isnull(fields),outfields,fields) | mvexpand fields | spath output=field input=fields path=fieldName | spath output=recommended input=fields path=comment.recommended | search recommended=""true"" | table field | sort field"
recon_avproduct_through_pwh_or_wmi_filter,search *
recon_using_wmi_class_filter,search *
recursive_delete_of_directory_in_batch_cmd_filter,search *
reg_exe_manipulating_windows_services_registry_keys_filter,search *
reg_exe_used_to_hide_files_directories_via_registry_keys_filter,search *
registry_keys_for_creating_shim_databases_filter,search *
registry_keys_used_for_persistence_filter,search *
registry_keys_used_for_privilege_escalation_filter,search *
regsvr32_silent_and_install_param_dll_loading_filter,search *
regsvr32_with_known_silent_switch_cmdline_filter,search *
remap_subjects,"tags outputfield=evtTags | `swap_if_tagged(src, dest, evtTags)` | fields - evtTags"
remcos_client_registry_install_entry_filter,search *
remcos_rat_file_creation_in_remcos_folder_filter,search *
remote_desktop_network_bruteforce_filter,search *
remote_desktop_network_traffic_filter,search *
remote_desktop_process_running_on_system_filter,search *
remote_process_instantiation_via_dcom_and_powershell_filter,search *
remote_process_instantiation_via_dcom_and_powershell_script_block_filter,search *
remote_process_instantiation_via_winrm_and_powershell_filter,search *
remote_process_instantiation_via_winrm_and_powershell_script_block_filter,search *
remote_process_instantiation_via_winrm_and_winrs_filter,search *
remote_process_instantiation_via_wmi_and_powershell_filter,search *
remote_process_instantiation_via_wmi_and_powershell_script_block_filter,search *
remote_process_instantiation_via_wmi_filter,search *
remote_registry_key_modifications_filter,search *
remote_system_discovery_with_adsisearcher_filter,search *
remote_system_discovery_with_dsquery_filter,search *
remote_system_discovery_with_net_filter,search *
remote_system_discovery_with_wmic_filter,search *
remote_wmi_command_attempt_filter,search *
remoteconnectionmanager,"source=""WinEventLog:Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational"""
remove_valid_domains,"eval domain=trim(domain,""*"") | search NOT[| inputlookup domains]  NOT[ |inputlookup cim_corporate_email_domain_lookup] NOT[inputlookup cim_corporate_web_domain_lookup] | eval domain=""*""+domain+""*"""
resize_shadowstorage_volume_filter,search *
revil_common_exec_parameter_filter,search *
revil_registry_entry_filter,search *
risk_index,index=risk
risk_rule_for_dev_sec_ops_by_repository_filter,search *
rlog_sourcetype,sourcetype=rlog
rubeus_command_line_parameters_filter,search *
rubeus_kerberos_ticket_exports_through_winlogon_access_filter,search *
runas_execution_in_commandline_filter,search *
rundll32_control_rundll_hunt_filter,search *
rundll32_control_rundll_world_writable_directory_filter,search *
rundll32_create_remote_thread_to_a_process_filter,search *
rundll32_createremotethread_in_browser_filter,search *
rundll32_dnsquery_filter,search *
rundll32_lockworkstation_filter,search *
rundll32_process_creating_exe_dll_files_filter,search *
rundll32_shimcache_flush_filter,search *
rundll32_with_no_command_line_arguments_with_network_filter,search *
rundll_loading_dll_by_ordinal_filter,search *
ryuk_test_files_detected_filter,search *
ryuk_wake_on_lan_command_filter,search *
s3_accesslogs,sourcetype=aws:s3:accesslogs
sam_database_file_access_attempt_filter,search *
samsam_test_file_write_filter,search *
sc_exe_manipulating_windows_services_filter,search *
schcache_change_by_app_connect_and_create_adsi_object_filter,search *
schedule_task_with_http_command_arguments_filter,search *
schedule_task_with_rundll32_command_trigger_filter,search *
scheduled_task_creation_on_remote_endpoint_using_at_filter,search *
scheduled_task_deleted_or_created_via_cmd_filter,search *
scheduled_task_initiation_on_remote_endpoint_filter,search *
scheduled_tasks_used_in_badrabbit_ransomware_filter,search *
schtasks_run_task_on_demand_filter,search *
schtasks_scheduling_job_on_remote_system_filter,search *
schtasks_used_for_forcing_a_reboot_filter,search *
screensaver_event_trigger_execution_filter,search *
script_execution_via_wmi_filter,search *
sdclt_uac_bypass_filter,search *
sdelete_application_execution_filter,search *
searchprotocolhost_with_no_command_line_with_network_filter,search *
secretdumps_offline_ntds_dumping_tool_filter,search *
security_content_ctime(1),"convert timeformat=""%Y-%m-%dT%H:%M:%S"" ctime($field$)"
security_content_summariesonly,summariesonly=false allow_old_summaries=true fillnull_value=null
security_group_api_calls,(eventName=AuthorizeSecurityGroupIngress OR eventName=CreateSecurityGroup OR eventName=DeleteSecurityGroup OR eventName=DescribeClusterSecurityGroups OR eventName=DescribeDBSecurityGroups OR eventName=DescribeSecurityGroupReferences OR eventName=DescribeSecurityGroups OR eventName=DescribeStaleSecurityGroups OR eventName=RevokeSecurityGroupIngress OR eventName=UpdateSecurityGroupRuleDescriptionsIngress)
serviceprincipalnames_discovery_with_powershell_filter,search *
serviceprincipalnames_discovery_with_setspn_filter,search *
services_escalate_exe_filter,search *
services_lolbas_execution_process_spawn_filter,search *
set_default_powershell_execution_policy_to_unrestricted_or_bypass_filter,search *
set_local_host,rest splunk_server=local /services/server/info | return host
SharePoint_ObjectSite,"rex field=ObjectId ""\/sites\/(?<ObjectSite>[^\/]+)"""
shim_database_file_creation_filter,search *
shim_database_installation_with_suspicious_parameters_filter,search *
short_lived_scheduled_task_filter,search *
short_lived_windows_accounts_filter,search *
silentcleanup_uac_bypass_filter,search *
single_letter_process_on_endpoint_filter,search *
slui_runas_elevated_filter,search *
slui_spawning_a_process_filter,search *
smb_traffic_spike___mltk_filter,search *
smb_traffic_spike_filter,search *
Sockets_by_State_by_Host(1),"`os_index` `netstat_sourcetype` host=$host$ | multikv fields State | search NOT (State=""<n/a>"") | timechart count by State"
Sort_MITRE,"fields ""Initial Access"" ""Execution"" ""Persistence"" ""Privilege Escalation"" ""Defense Evasion"" ""Credential Access"" ""Discovery"" ""Lateral Movement"" ""Collection"" ""Command and Control"" ""Exfiltration"" ""Impact"""
Sort_MITRE_Rows(1),"eval eventOrderTactic = case($fieldname$=""Initial Access"", 1, $fieldname$=""Execution"", 2, $fieldname$=""Persistence"", 3, $fieldname$=""Privilege Escalation"", 4, $fieldname$=""Defense Evasion"", 5, $fieldname$=""Credential Access"", 6, $fieldname$=""Discovery"", 7, $fieldname$=""Lateral Movement"", 8, $fieldname$=""Collection"", 9, $fieldname$=""Command and Control"", 10, $fieldname$=""Exfiltration"", 11, $fieldname$=""Impact"", 12, 1=1, 13) | sort eventOrderTactic | fields - eventOrderTactic"
source-names-search(1),"eventtype=wineventlog_windows LogName=""$LogName$"" | stats count by SourceName | sort +SourceName"
spectre_and_meltdown_vulnerable_systems_filter,search *
spike_in_file_writes_filter,search *
splunk_absolute_path_traversal_using_runshellscript_filter,search *
splunk_account_discovery_drilldown_dashboard_disclosure_filter,search *
splunk_app_for_lookup_file_editing_rce_via_user_xslt_filter,search *
splunk_code_injection_via_custom_dashboard_leading_to_rce_filter,search *
splunk_command_and_scripting_interpreter_delete_usage_filter,search *
splunk_command_and_scripting_interpreter_risky_commands_filter,search *
splunk_command_and_scripting_interpreter_risky_spl_mltk_filter,search *
splunk_crash_log,(index=_internal AND sourcetype=splunkd_crash_log)
splunk_csrf_in_the_ssg_kvstore_client_endpoint_filter,search *
splunk_data_exfiltration_from_analytics_workspace_using_sid_query_filter,search *
splunk_digital_certificates_infrastructure_version_filter,search *
splunk_digital_certificates_lack_of_encryption_filter,search *
splunk_dos_using_malformed_saml_request_filter,search *
splunk_dos_via_dump_spl_command_filter,search *
splunk_dos_via_malformed_s2s_request_filter,search *
splunk_dos_via_printf_search_function_filter,search *
splunk_edit_user_privilege_escalation_filter,search *
splunk_endpoint_denial_of_service_dos_zip_bomb_filter,search *
splunk_enterprise_information_disclosure_filter,search *
splunk_enterprise_kv_store_incorrect_authorization_filter,search *
splunk_enterprise_windows_deserialization_file_partition_filter,search *
splunk_es_dos_investigations_manager_via_investigation_creation_filter,search *
splunk_es_dos_through_investigation_attachments_filter,search *
splunk_http_response_splitting_via_rest_spl_command_filter,search *
splunk_identified_ssl_tls_certificates_filter,search *
splunk_improperly_formatted_parameter_crashes_splunkd_filter,search *
splunk_information_disclosure_in_splunk_add_on_builder_filter,search *
splunk_list_all_nonstandard_admin_accounts_filter,search *
splunk_low_privilege_user_can_view_hashed_splunk_password_filter,search *
splunk_path_traversal_in_splunk_app_for_lookup_file_edit_filter,search *
splunk_persistent_xss_via_url_validation_bypass_w_dashboard_filter,search *
splunk_process_injection_forwarder_bundle_downloads_filter,search *
splunk_protocol_impersonation_weak_encryption_configuration_filter,search *
splunk_protocol_impersonation_weak_encryption_selfsigned_filter,search *
splunk_protocol_impersonation_weak_encryption_simplerequest_filter,search *
splunk_python,index=_internal sourcetype=splunk_python
splunk_rbac_bypass_on_indexing_preview_rest_endpoint_filter,search *
splunk_rce_via_serialized_session_payload_filter,search *
splunk_rce_via_splunk_secure_gateway__splunk_mobile_alerts_feature_filter,search *
splunk_rce_via_user_xslt_filter,search *
splunk_reflected_xss_in_the_templates_lists_radio_filter,search *
splunk_reflected_xss_on_app_search_table_endpoint_filter,search *
splunk_risky_command_abuse_disclosed_february_2023_filter,search *
splunk_stored_xss_via_data_model_objectname_field_filter,search *
splunk_unauthenticated_log_injection_web_service_log_filter,search *
splunk_unnecessary_file_extensions_allowed_by_lookup_table_uploads_filter,search *
splunk_user_enumeration_attempt_filter,search *
splunk_xss_in_highlighted_json_events_filter,search *
splunk_xss_in_monitoring_console_filter,search *
splunk_xss_in_save_table_dialog_header_in_search_page_filter,search *
splunk_xss_via_view_filter,search *
splunkd,index=_internal sourcetype=splunkd
splunkd_failed_auths,"index=_audit ""action=login attempt"" ""info=failed"""
splunkd_investigation_rest_handler,index=_internal sourcetype=investigation_rest_handler
splunkd_ui,index=_internal sourcetype=splunkd_ui_access
splunkd_web,index=_internal sourcetype=splunk_web_access
splunkd_webx,index=_internal sourcetype=splunk_web_access
splunkda,index=_internal sourcetype=splunkd_access
spoolsv_spawning_rundll32_filter,search *
spoolsv_suspicious_loaded_modules_filter,search *
spoolsv_suspicious_process_access_filter,search *
spoolsv_writing_a_dll___sysmon_filter,search *
spoolsv_writing_a_dll_filter,search *
spring4shell_payload_url_request_filter,search *
sql_injection_with_long_urls_filter,search *
sqlite_module_in_temp_folder_filter,search *
srch(1),"case($count$ > 200,""above 200"",$count$ < 200,""below 200"")"
ssl_certificates_with_punycode_filter,search *
Stats_for_CPU_State_by_Host(1),"`os_index` `cpu_sourcetype` host=$host$ | stats avg(pctUser), avg(pctSystem), avg(pctIdle) by host"
steal_or_forge_authentication_certificates_behavior_identified_filter,search *
stream_dns,sourcetype=stream:dns
stream_http,sourcetype=stream:http
stream_logs,index=_internal sourcetype=stream:log
stream_stats,index=_internal sourcetype=stream:stats
stream_stats_estimate,"index=_internal sourcetype=stream:stats | spath Output=streamId path=senders{}.streams{}.id | spath Output=rawBytes path=senders{}.streams{}.delta_raw_bytes | spath Output=events path=senders{}.streams{}.delta_events | spath Output=bytesIn path=senders{}.streams{}.delta_bytes_in | spath Output=bytesOut path=senders{}.streams{}.delta_bytes_out | spath Output=totalBytes path=senders{}.streams{}.delta_bytes | spath Output=statsOnly path=senders{}.streams{}.stats_only | fields - _raw| fields _time, host, streamId, rawBytes, events, bytesIn, bytesOut, totalBytes, statsOnly | search statsOnly=* | eval x=mvzip(mvzip(mvzip(mvzip(mvzip(mvzip(streamId, rawBytes),events),bytesIn),bytesOut),totalBytes), statsOnly) | mvexpand x | rex field=x ""(?<streamId>[^\,]*)\,(?<rawBytes>[^\,]*)\,(?<events>[^\,]*)\,(?<bytesIn>[^\,]*)\,(?<bytesOut>[^\,]*)\,(?<totalBytes>[^\,]*)\,(?<statsOnly>[\S]*)"""
stream_tcp,sourcetype=stream:tcp
su_failed,"eventtype=""Failed_SU"""
subjectinterfacepackage,"sourcetype=""PwSh:SubjectInterfacePackage"""
sunburst_correlation_dll_and_network_event_filter,search *
supernova_webshell_filter,search *
suspicious_changes_to_file_associations_filter,search *
suspicious_computer_account_name_change_filter,search *
suspicious_copy_on_system32_filter,search *
suspicious_curl_network_connection_filter,search *
suspicious_dllhost_no_command_line_arguments_filter,search *
suspicious_driver_loaded_path_filter,search *
suspicious_email___uba_anomaly_filter,search *
suspicious_email_attachment_extensions_filter,search *
suspicious_email_attachments,lookup update=true is_suspicious_file_extension_lookup file_name OUTPUT suspicious | search suspicious=true
suspicious_event_log_service_behavior_filter,search *
suspicious_file_write_filter,search *
suspicious_gpupdate_no_command_line_arguments_filter,search *
suspicious_icedid_rundll32_cmdline_filter,search *
suspicious_image_creation_in_appdata_folder_filter,search *
suspicious_java_classes_filter,search *
suspicious_kerberos_service_ticket_request_filter,search *
suspicious_linux_discovery_commands_filter,search *
suspicious_microsoft_workflow_compiler_rename_filter,search *
suspicious_microsoft_workflow_compiler_usage_filter,search *
suspicious_msbuild_path_filter,search *
suspicious_msbuild_rename_filter,search *
suspicious_msbuild_spawn_filter,search *
suspicious_mshta_child_process_filter,search *
suspicious_mshta_spawn_filter,search *
suspicious_plistbuddy_usage_filter,search *
suspicious_plistbuddy_usage_via_osquery_filter,search *
suspicious_powershell_command_line_arguments_filter,search *
suspicious_process_dns_query_known_abuse_web_services_filter,search *
suspicious_process_executed_from_container_file_filter,search *
suspicious_process_file_path_filter,search *
suspicious_process_with_discord_dns_query_filter,search *
suspicious_reg_exe_process_filter,search *
suspicious_regsvr32_register_suspicious_path_filter,search *
suspicious_rundll32_dllregisterserver_filter,search *
suspicious_rundll32_no_command_line_arguments_filter,search *
suspicious_rundll32_plugininit_filter,search *
suspicious_rundll32_rename_filter,search *
suspicious_rundll32_startw_filter,search *
suspicious_scheduled_task_from_public_directory_filter,search *
suspicious_searchprotocolhost_no_command_line_arguments_filter,search *
suspicious_sqlite3_lsquarantine_behavior_filter,search *
suspicious_ticket_granting_ticket_request_filter,search *
suspicious_wav_file_in_appdata_folder_filter,search *
suspicious_wevtutil_usage_filter,search *
suspicious_writes,"lookup suspicious_writes_lookup file as file_name OUTPUT note as ""Reference"" | search ""Reference"" != False"
suspicious_writes_to_system_volume_information_filter,search *
suspicious_writes_to_windows_recycle_bin_filter,search *
svchost_lolbas_execution_process_spawn_filter,search *
swap_if_tagged(3),"eval swapTmp='$second$' | eval ""$second$""=if('$tagField$'=""swap_$first$_$second$"", '$first$', '$second$') | eval ""$first$""=if('$tagField$'=""swap_$first$_$second$"", swapTmp, '$first$') | fields - swapTmp"
syslog_errors,error OR failed OR severe NOT assignment
syslog_sourcetype,sourcetype=syslog
sysmon,sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=Syslog:Linux-Sysmon/Operational
system_info_gathering_using_dxdiag_application_filter,search *
system_information_discovery_detection_filter,search *
system_network_configuration_discovery_tools,"(process_name= ""arp.exe"" OR process_name= ""at.exe"" OR process_name= ""attrib.exe"" OR process_name= ""cscript.exe"" OR process_name= ""dsquery.exe"" OR process_name= ""hostname.exe"" OR process_name= ""ipconfig.exe"" OR process_name= ""mimikatz.exe"" OR process_name= ""nbstat.exe"" OR process_name= ""net.exe"" OR process_name= ""netsh.exe"" OR process_name= ""nslookup.exe"" OR process_name= ""ping.exe"" OR process_name= ""quser.exe"" OR process_name= ""qwinsta.exe"" OR process_name= ""reg.exe"" OR process_name= ""runas.exe"" OR process_name= ""sc.exe"" OR process_name= ""schtasks.exe"" OR process_name= ""ssh.exe"" OR process_name= ""systeminfo.exe"" OR process_name= ""taskkill.exe"" OR process_name= ""telnet.exe"" OR process_name= ""tracert.exe"" OR process_name=""wscript.exe"" OR process_name= ""xcopy.exe"")"
system_processes_run_from_unexpected_locations_filter,search *
system_user_discovery_with_query_filter,search *
system_user_discovery_with_whoami_filter,search *
task-categories-search(2),"eventtype=wineventlog_windows LogName=""$LogName$"" SourceName=""$SourceName$"" | stats count by TaskCategory | sort +TaskCategory"
teststring,"""fifo"""
Threads_Exceeds_by_Host(1),"`os_index` `memory_sourcetype` host=* | stats avg(threads) as Total_Threads by host | where Total_Threads > $threshold$ | eval title=""Threads_Exceeds_by_Host"" | `unix_alert_decoration` | fields Total_Threads, host, hosts, host_count, severity, sid, time_fired, _time"
Thruput_by_Interface_by_Host(1),"`os_index` `interfaces_sourcetype` host=$host$ | streamstats current=f last(TXbytes) as lastTX, last(RXbytes) as lastRX by Name  | eval time=_time | strcat Name ""-"" inetAddr ""@"" host Interface_Host | eval RX_Thruput_KB = (lastRX-RXbytes)/1024 | eval TX_Thruput_KB = (lastTX-TXbytes)/1024 | timechart eval(sum(TX_Thruput_KB)/dc(time)) by Interface_Host"
time_modifier(1),"tostring(relative_time(time(), ""$time_modifier$""))"
time_provider_persistence_registry_filter,search *
time_sourcetype,sourcetype=time
Top_5_CPU_Processes_by_Host(1),"`os_index` `top_sourcetype` host=$host$ | stats max(pctCPU) as maxCPU by host, COMMAND, _time | sort -maxCPU | dedup 5 host"
Top_CPU_Processes_for_Host(1),"`os_index` `top_sourcetype` host=$host$ | stats max(pctCPU) as maxCPU by host, COMMAND, _time | sort -maxCPU"
Top_CPU_Users_for_Host(1),"`os_index` `top_sourcetype` host=$host$ | stats sum(pctCPU) as Total_CPU_Time by host, USER,  | sort -Total_CPU_Time"
Top_Inet_Addresses_by_Host(1),"`os_index` `interfaces_sourcetype` host=$host$ | strcat Name ""-"" inetAddr ""@"" host Interface_Host | top Interface_Host limit=20"
Top_Mem_Command_for_Host(1),"`os_index` `ps_sourcetype` host=$host$ | eval RSZ_MB=RSZ_KB/1024 | eval VSZ_MB=VSZ_KB/1024  | stats max(RSZ_MB) as Resident_MB, max(VSZ_MB) as Virtual_MB, max(pctMEM) as Percent_Memory by host, COMMAND, _time | dedup COMMAND | sort -Resident_MB"
Top_Mem_Processes_by_Host(1),"`os_index` `ps_sourcetype` host=$host$ | eval RSZ_MB=RSZ_KB/1024 | eval VSZ_MB=VSZ_KB/1024 | stats median(RSZ_MB) by VSZ_MB, host, COMMAND, _time | dedup 1 host, COMMAND sortby -median(RSZ_MB)"
Top_Memory_Users_by_Command_by_Host(1),"`os_index` `ps_sourcetype` host=$host$ | eval RSZ_MB=RSZ_KB/1024 | stats max(RSZ_MB) by USER, COMMAND| sort -max(RSZ_MB)"
top_sourcetype,sourcetype=top
Top_Users_of_VM_for_Host(1),`os_index` `ps_sourcetype` host=$host$ | eval RSZ_MB=RSZ_KB/1024 | eval time=_time | timechart eval(sum(RSZ_MB)/dc(time)) as Avg_Mem_Usage by USER useother=F limit=10
tor_traffic_filter,search *
traps_fields,"spath input=processes_json | spath input=files_json | spath input=users_json | spath input=urls_json | rename {}.* AS * | eval file_hash=lower(sha256) | rename fileName AS file_name, fileSize AS file_size, commandLine AS command"
trickbot_named_pipe_filter,search *
truncate_search,"eval search=if(length(search) > 150, substr(search, 0, 150) + ""..."", search)"
uac_bypass_mmc_load_unsigned_dll_filter,search *
uac_bypass_with_colorui_com_object_filter,search *
uacbypass_process_name,"BitlockerWizardElev.exe,cliconfg.exe,clipup.exe,cmstp.exe,CompMgmtLauncher.exe,consent.exe,control.exe,credwiz.exe,dccw.exe,dismhost.exe,EventVwr.exe,fodhelper.exe,GWXUXWorker.exe,inetmgr.exe,iscsicli.exe,mcx2prov.exe,migwiz.exe,mmc.exe,msconfig.exe,oobe.exe,osk.exe,pkgmgr.exe,recdisc.exe,rstrui.exe,sdclt.exe,setupsqm.exe,slui.exe,sysprep.exe,SystemPropertiesAdvanced.exe,taskhost.exe,TpmInit.exe,tzsync.exe,w32tm.exe,WerFault.exe,WSReset.exe,wusa.exe"
uncommon_processes,"lookup update=true lookup_uncommon_processes_default process_name as process_name outputnew uncommon_default,category_default,analytic_story_default,kill_chain_phase_default,mitre_attack_default | lookup update=true  lookup_uncommon_processes_local process_name as process_name outputnew uncommon_local,category_local,analytic_story_local,kill_chain_phase_local,mitre_attack_local | eval uncommon = coalesce(uncommon_default, uncommon_local), analytic_story = coalesce(analytic_story_default, analytic_story_local), category=coalesce(category_default, category_local), kill_chain_phase=coalesce(kill_chain_phase_default, kill_chain_phase_local), mitre_attack=coalesce(mitre_attack_default, mitre_attack_local) | fields - analytic_story_default, analytic_story_local, category_default, category_local, kill_chain_phase_default, kill_chain_phase_local, mitre_attack_default, mitre_attack_local, uncommon_default, uncommon_local | search uncommon=true"
uncommon_processes_on_endpoint_filter,search *
uninstall_app_using_msiexec_filter,search *
unix_alert_decoration,join title [rest /services/saved/searches | rename alert.severity as severity | fields title severity]  | eventstats values(host) as hosts | eventstats dc(host) as host_count | eval time_fired = now() | addinfo | eval _time = time_fired | rename info_sid as sid
unix_errors,eventtype=nix_errors
unix_host_details,"`os_index` ((`cpu_sourcetype` CPU=""all"") OR `memory_sourcetype` OR `df_sourcetype` OR `iostat_sourcetype`) | `eval_host_group` | multikv fields Avail Used rReq_PS wReq_PS | eval diskAvail=`parse_disk_size('Avail')` | eval diskUsed=`parse_disk_size('Used')` | fillnull value=NULL Filesystem | stats first(group) as group avg(pctIdle) as pctIdle avg(memUsedPct) as mem first(rReq_PS) as ioReads first(wReq_PS) as ioWrites first(diskAvail) as diskAvail first(diskUsed) as diskUsed by host Filesystem | stats first(group) as group first(pctIdle) as pctIdle first(mem) as mem first(ioReads) as ioReads first(ioWrites) as ioWrites sum(diskAvail) as diskAvail sum(diskUsed) as diskUsed by host | eval cpu=(100-pctIdle) | eval io=ioReads+ioWrites | eval disk=round(diskUsed/diskAvail*100,2) | table host group cpu mem io disk"
unix_host_status,"`os_index` ((`cpu_sourcetype` CPU=""all"") OR `memory_sourcetype` OR `df_sourcetype` OR `iostat_sourcetype`) | dedup host | `eval_host_group` | eval service=""Node"" | eval status=1 |  eval symbol=""nix"" | table host service symbol group status"
unix_hosts_details(2),"`os_index` ((`cpu_sourcetype` CPU=""all"") OR `memory_sourcetype` OR `df_sourcetype` OR `iostat_sourcetype`) [ | inputlookup  dropdownsLookup | search $unix_category$ $unix_group$ | fields host] | mvexpand unix_group | mvexpand unix_category | search $unix_category$ $unix_group$  | `eval_host_group` | multikv fields Avail Used rReq_PS wReq_PS | eval diskAvail=`parse_disk_size('Avail')` | eval diskUsed=`parse_disk_size('Used')` | fillnull value=NULL Filesystem | stats first(group) as group avg(pctIdle) as pctIdle avg(memUsedPct) as mem first(rReq_PS) as ioReads first(wReq_PS) as ioWrites first(diskAvail) as diskAvail first(diskUsed) as diskUsed by host Filesystem | stats first(group) as group first(pctIdle) as pctIdle first(mem) as mem first(ioReads) as ioReads first(ioWrites) as ioWrites sum(diskAvail) as diskAvail sum(diskUsed) as diskUsed by host | eval cpu=(100-pctIdle) | eval io=ioReads+ioWrites | eval disk=round(diskUsed/(diskUsed+diskAvail)*100,2) | table host group cpu mem io disk"
unix_hosts_status(2),"`os_index` ((`cpu_sourcetype` CPU=""all"") OR `memory_sourcetype` OR `df_sourcetype` OR `iostat_sourcetype`) [ | inputlookup  dropdownsLookup | search $unix_category$ $unix_group$ | fields host] | mvexpand unix_group | mvexpand unix_category | search $unix_category$ $unix_group$  | dedup host | `eval_host_group` | eval service=""Node"" | eval status=1 |  eval symbol=""nix"" | table host service symbol group status"
unix_nodes_detail_cpu_sparkline_by_host_1h(1),"`os_index` `cpu_sourcetype` host=$host$ CPU=""all"" | append [stats count | eval _raw=""no results"" ] | eval used = 100 - pctIdle  | eval name = ""CPU:""  | stats  first(name) as name avg(used) as used sparkline(avg(used), 2m) as sl  | eval used = round(used, 0) . ""%"" | fillnull used value=""unknown - is cpu.sh enabled?"""
unix_nodes_detail_disk_sparkline_by_host_1h(1),"`os_index` `df_sourcetype` host=$host$ | append [stats count | eval _raw=""no results"" | eval _time=now()] | `convert_memk(Avail, avail)` | `convert_memk(Used, used)` | fillnull used value=0 | fillnull avail value=0 | fillnull Filesystem value=""no results"" | bucket span=5m _time | stats avg(used) as used avg(avail) as avail by Filesystem _time | stats sum(used) as used sum(avail) as avail by _time | eval used_perc_no_unit = round(used/(used+avail)*100, 0) | eval used_perc = used_perc_no_unit . ""%"" | eval name = ""Disk:"" | stats first(name) as name first(used_perc) as used sparkline(max(used_perc_no_unit), 5m) as sl | fillnull used value=""--%"""
unix_nodes_detail_mem_sparkline_by_host_1h(1),"`os_index` `memory_sourcetype` host=$host$ | append [stats count | eval _raw=""no results""] | eval name = ""Memory:"" | stats first(name) as name avg(memUsedPct) as used sparkline(avg(memUsedPct), 2m) as sl | eval used = round(used, 0) . ""%"" | fillnull used value=""unknown - is vmstat.sh enabled?"""
unix_nodes_detail_specs_cpu_by_host(1),"`os_index` `cpu_sourcetype` host=$host$ NOT cpu=""all"" | append [stats count | eval _raw=""no results""] | head 100 | eval name=""CPU:"" | stats first(name) as name max(CPU) as cpus | eval cpus=if(isnum(cpus), tostring(cpus + 1) + "" cores"", ""unknown - is cpu.sh enabled?"")"
unix_nodes_detail_specs_disk_cap_by_host(1),"`os_index` `df_sourcetype` host=$host$ | append [stats count | eval _raw=""no results""] | `convert_memk(Avail, cap)` | fillnull Filesystem value=NULL | stats first(cap) as cap by Filesystem | fillnull cap value=0 | stats sum(cap) as cap | eval name=""Capacity:"" | eval cap=if(cap=0, ""unknown - is df.sh enabled?"",  round(cap/(1024*1024),0) . "" GB"") | fields name cap"
unix_nodes_detail_specs_disk_drives_by_host(1),"`os_index` `df_sourcetype` host=$host$ | append [stats count | eval _raw=""no results""] | stats dc(Filesystem) as drives | eval name=""Disk:"" | fillnull drives value=0 | eval drives=if(drives=0, ""unknown - is df.sh enabled?"", tostring(drives) . "" drives"") | fields name drives"
unix_nodes_detail_specs_mem_by_host(1),"`os_index` `memory_sourcetype` host=$host$ | append [stats count | eval _raw=""no results""] | head 10 | fillnull TotalMBytes value=0 | stats first(TotalMBytes) as mem | eval name = ""RAM:"" | fillnull mem value=0 | eval mem=if(mem=0, ""unknown - is vmstat.sh enabled?"", mem) | eval mem = if(isnum(mem), mem . "" MB"", mem) | fields name mem"
unix_nodes_detail_status_cpu_by_host(1),`os_index` `cpu_sourcetype` host=$host$ | eval Percent_CPU_Load = 100 - pctIdle | stats avg(Percent_CPU_Load) as cpu by host
unix_nodes_detail_status_disk_by_host(1),"`os_index` `df_sourcetype` host=$host$ | multikv fields Avail Used | `convert_memk(Avail, avail)` | `convert_memk(Used, used)` | stats first(avail) as avail first(used) as used by host Filesystem | stats sum(avail) as avail sum(used) as used by host | eval disk = round(used/(used+avail)*100, 2) | fields host disk"
unix_nodes_detail_status_mem_by_host(1),`os_index` `memory_sourcetype` host=$host$ | stats avg(memUsedPct) as mem by host
unix_nodes_detail_top_processes_by_host(1),"`os_index` sourcetype=top host=$host$ | stats max(pctCPU) as pctCPU max(pctMEM) as pctMEM last(cpuTIME) as cpuTIME by COMMAND, USER | eval CMD=COMMAND | fields CMD, USER, pctCPU, pctMEM, cpuTIME"
unix_nodes_heatmap_cpu,"`os_index` `cpu_sourcetype` CPU=""all"" | eval heatmap = (100-pctIdle) | stats first(heatmap) as heatmap by host"
unix_nodes_heatmap_disk,"`os_index` `df_sourcetype` | multikv fields Avail Used | `convert_memk(Avail, avail)` | `convert_memk(Used, used)` | stats first(avail) as avail first(used) as used by host Filesystem | stats sum(avail) as avail sum(used) as used by host | eval heatmap = round(((used / (used + avail)) * 100),2) | fields host heatmap"
unix_nodes_heatmap_io,`os_index` `iostat_sourcetype` | multikv fields rReq_PS wReq_PS | stats first(rReq_PS) as reads first(wReq_PS) as writes by host | eval heatmap = reads + writes | fields host heatmap
unix_nodes_heatmap_mem,"`os_index` `memory_sourcetype` | stats avg(memUsedPct) as heatmap by host | eval heatmap = round(heatmap, 2)"
unix_noop,cowsshouldnteatcheesethatwouldmakethemsortofcannibalsinawaydontyouthink | head 1
unknown_process_using_the_kerberos_protocol_filter,search *
unload_sysmon_filter_driver_filter,search *
unloading_amsi_via_reflection_filter,search *
unsigned_image_loaded_by_lsass_filter,search *
unsuccessful_netbackup_backups_filter,search *
unusual_number_of_computer_service_tickets_requested_filter,search *
unusual_number_of_kerberos_service_tickets_requested_filter,search *
unusual_number_of_remote_endpoint_authentication_events_filter,search *
unusually_long_command_line___mltk_filter,search *
unusually_long_command_line_filter,search *
unusually_long_content_type_length_filter,search *
user_add,"eventtype=useradd OR eventtype=""useradd-suse"""
user_del,eventtype=userdel
user_discovery_with_env_vars_powershell_filter,search *
user_discovery_with_env_vars_powershell_script_block_filter,search *
User_Sessions_by_Host(1),"`os_index` `who_sourcetype` host=$host$ | fields USERNAME, LINE, TIME, _time | dedup USERNAME, LINE, TIME sortby +_time | sort -_time"
User_to_Index_Provisioning_From_Data_Governance_App,"rest splunk_server=local /services/authentication/users 
| eval roles=mvjoin(roles,"", "") 
| fields title, roles 
| rename title as username 
| makemv delim="", "" roles 
| mvexpand roles 
| rename roles as role 
| join max=1 overwrite=1 type=inner usetime=0 role 
    [| rest splunk_server=local /services/authorization/roles 
    | rename title as role 
    | fillnull value="""" 
    | fields role, srchIndexesAllowed] 
| fields username, srchIndexesAllowed 
| rex field=srchIndexesAllowed mode=sed ""s/\s/,/g"" 
| makemv delim="","" srchIndexesAllowed 
| mvcombine srchIndexesAllowed 
| mvcombine srchIndexesAllowed 
| rex field=srchIndexesAllowed mode=sed ""s/\s/,/g"" 
| makemv delim="","" srchIndexesAllowed 
| eventstats values(srchIndexesAllowed) AS didx by username 
| fields username, didx 
| mvcombine didx 
| rex field=didx mode=sed ""s/\s/, /g"" 
| rename didx as accessible_indexes 
| join max=1 overwrite=1 type=inner usetime=0 username 
    [| rest splunk_server=local /services/authentication/users 
    | eval roles=mvjoin(roles,"", "") 
    | rename title as username 
    | fields username, roles] 
| makemv delim="", "" accessible_indexes 
| mvexpand accessible_indexes 
| join max=1 overwrite=1 type=outer usetime=0 accessible_indexes 
    [| rest /services/data/indexes 
    | fields title 
    | dedup title 
    | where match(title,""^_\\w+$"") 
    | mvcombine title 
    | eval title=mvjoin(title,"", "") 
    | rename title as expanded_indexes 
    | eval accessible_indexes=""_*""] 
| join max=1 overwrite=1 type=outer usetime=0 accessible_indexes 
    [| rest /services/data/indexes 
    | fields title 
    | dedup title 
    | where match(title,""^[^_]+$"") 
    | mvcombine title 
    | eval title=mvjoin(title,"", "") 
    | rename title as expanded_indexes 
    | eval accessible_indexes=""*""] 
| eval accessible_indexes=if(match(accessible_indexes,""^(?:_\\*|\\*)$""),expanded_indexes,accessible_indexes) 
| fields - expanded_indexes 
| makemv delim="", "" accessible_indexes 
| mvexpand accessible_indexes"
Users_with_Login_Privs_by_Host(1),`os_index` `users_with_login_privs_sourcetype` host=$host$ | dedup host
users_with_login_privs_sourcetype,sourcetype=usersWithLoginPrivs
usn_journal_deletion_filter,search *
ut_bayesian(1),lookup ut_bayesian_lookup word as $word$
ut_countset(2),lookup ut_countset_lookup word as $word$ set as $set$
ut_levenshtein(2),lookup ut_levenshtein_lookup word1 as $w1$ word2 as $w2$
ut_meaning(1),lookup ut_meaning_lookup word as $word$
ut_parse(2),"`ut_parse_extended($url$, $list$)`"
ut_parse_extended(2),lookup ut_parse_extended_lookup url as $url$ list as $list$ | spath input=ut_subdomain_parts | fields - ut_subdomain_parts
ut_parse_simple(1),lookup ut_parse_simple_lookup url as $url$
ut_shannon(1),lookup ut_shannon_lookup word as $word$
ut_suites(2),lookup ut_suites_lookup word as $word$ set as $set$ | spath input=ut_suites | fields - ut_suites
vbscript_execution_using_wscript_app_filter,search *
vendor_product_tracker(1),"inputlookup append=T cim_vendor_product_tracker | search model=""$model$"""
verclsid_clsid_execution_filter,search *
vmware_aria_operations_exploit_attempt_filter,search *
vmware_server_side_template_injection_hunt_filter,search *
vmware_workspace_one_freemarker_server_side_template_injection_filter,search *
w3wp_spawning_shell_filter,search *
wbadmin_delete_system_backups_filter,search *
wbemprox_com_object_execution_filter,search *
web_fraud___account_harvesting_filter,search *
web_fraud___anomalous_user_clickspeed_filter,search *
web_fraud___password_sharing_across_accounts_filter,search *
web_jsp_request_via_url_filter,search *
web_remote_shellservlet_access_filter,search *
web_servers_executing_suspicious_processes_filter,search *
web_spring4shell_http_request_class_module_filter,search *
web_spring_cloud_function_functionrouter_filter,search *
wermgr_process_connecting_to_ip_check_web_services_filter,search *
wermgr_process_create_executable_file_filter,search *
wermgr_process_spawned_cmd_or_powershell_process_filter,search *
wget_download_and_bash_execution_filter,search *
who_sourcetype,sourcetype=who
windows_abused_web_services_filter,search *
windows_access_token_manipulation_sedebugprivilege_filter,search *
windows_access_token_manipulation_winlogon_duplicate_token_handle_filter,search *
windows_access_token_winlogon_duplicate_handle_in_uncommon_path_filter,search *
windows_account_discovery_for_none_disable_user_account_filter,search *
windows_account_discovery_for_sam_account_name_filter,search *
windows_account_discovery_with_netuser_preauthnotrequire_filter,search *
windows_ad_abnormal_object_access_activity_filter,search *
windows_ad_adminsdholder_acl_modified_filter,search *
windows_ad_cross_domain_sid_history_addition_filter,search *
windows_ad_domain_controller_audit_policy_disabled_filter,search *
windows_ad_domain_controller_promotion_filter,search *
windows_ad_domain_replication_acl_addition_filter,search *
windows_ad_dsrm_account_changes_filter,search *
windows_ad_dsrm_password_reset_filter,search *
windows_ad_privileged_account_sid_history_addition_filter,search *
windows_ad_privileged_object_access_activity_filter,search *
windows_ad_replication_request_initiated_by_user_account_filter,search *
windows_ad_replication_request_initiated_from_unsanctioned_location_filter,search *
windows_ad_replication_service_traffic_filter,search *
windows_ad_rogue_domain_controller_network_activity_filter,search *
windows_ad_same_domain_sid_history_addition_filter,search *
windows_ad_serviceprincipalname_added_to_domain_account_filter,search *
windows_ad_short_lived_domain_account_serviceprincipalname_filter,search *
windows_ad_short_lived_domain_controller_spn_attribute_filter,search *
windows_ad_short_lived_server_object_filter,search *
windows_ad_sid_history_attribute_modified_filter,search *
windows_adfind_exe_filter,search *
windows_admin_permission_discovery_filter,search *
windows_administrative_shares_accessed_on_multiple_hosts_filter,search *
windows_admon_default_group_policy_object_modified_filter,search *
windows_admon_group_policy_object_created_filter,search *
windows_alternate_datastream___base64_content_filter,search *
windows_alternate_datastream___executable_content_filter,search *
windows_alternate_datastream___process_execution_filter,search *
windows_apache_benchmark_binary_filter,search *
windows_app_layer_protocol_qakbot_namedpipe_filter,search *
windows_app_layer_protocol_wermgr_connect_to_namedpipe_filter,search *
windows_application_layer_protocol_rms_radmin_tool_namedpipe_filter,search *
windows_archive_collected_data_via_powershell_filter,search *
windows_archive_collected_data_via_rar_filter,search *
windows_autoit3_execution_filter,search *
windows_autostart_execution_lsass_driver_registry_modification_filter,search *
windows_binary_proxy_execution_mavinject_dll_injection_filter,search *
windows_boot_or_logon_autostart_execution_in_startup_folder_filter,search *
windows_bootloader_inventory_filter,search *
windows_bypass_uac_via_pkgmgr_tool_filter,search *
windows_cab_file_on_disk_filter,search *
windows_cached_domain_credentials_reg_query_filter,search *
windows_change_default_file_association_for_no_file_ext_filter,search *
windows_clipboard_data_via_get_clipboard_filter,search *
windows_com_hijacking_inprocserver32_modification_filter,search *
windows_command_and_scripting_interpreter_hunting_path_traversal_filter,search *
windows_command_and_scripting_interpreter_path_traversal_exec_filter,search *
windows_command_shell_dcrat_forkbomb_payload_filter,search *
windows_command_shell_fetch_env_variables_filter,search *
windows_common_abused_cmd_shell_risk_behavior_filter,search *
windows_computer_account_created_by_computer_account_filter,search *
windows_computer_account_requesting_kerberos_ticket_filter,search *
windows_computer_account_with_spn_filter,search *
windows_conhost_with_headless_argument_filter,search *
windows_connhost_exe_started_forcefully_filter,search *
windows_create_local_account_filter,search *
windows_credential_dumping_lsass_memory_createdump_filter,search *
windows_credentials_from_password_stores_chrome_extension_access_filter,search *
windows_credentials_from_password_stores_chrome_localstate_access_filter,search *
windows_credentials_from_password_stores_chrome_login_data_access_filter,search *
windows_credentials_from_password_stores_creation_filter,search *
windows_credentials_from_password_stores_deletion_filter,search *
windows_credentials_from_password_stores_query_filter,search *
windows_credentials_in_registry_reg_query_filter,search *
windows_curl_download_to_suspicious_path_filter,search *
windows_curl_upload_to_remote_destination_filter,search *
windows_data_destruction_recursive_exec_files_deletion_filter,search *
windows_defacement_modify_transcodedwallpaper_file_filter,search *
windows_default_group_policy_object_modified_filter,search *
windows_default_group_policy_object_modified_with_gpme_filter,search *
windows_defender_asr_audit_events_filter,search *
windows_defender_asr_block_events_filter,search *
windows_defender_asr_registry_modification_filter,search *
windows_defender_asr_rule_disabled_filter,search *
windows_defender_asr_rules_stacking_filter,search *
windows_defender_exclusion_registry_entry_filter,search *
windows_delete_or_modify_system_firewall_filter,search *
windows_deleted_registry_by_a_non_critical_process_file_path_filter,search *
windows_disable_change_password_through_registry_filter,search *
windows_disable_lock_workstation_feature_through_registry_filter,search *
windows_disable_logoff_button_through_registry_filter,search *
windows_disable_memory_crash_dump_filter,search *
windows_disable_notification_center_filter,search *
windows_disable_or_modify_tools_via_taskkill_filter,search *
windows_disable_shutdown_button_through_registry_filter,search *
windows_disable_windows_event_logging_disable_http_logging_filter,search *
windows_disable_windows_group_policy_features_through_registry_filter,search *
windows_disableantispyware_registry_filter,search *
windows_diskcryptor_usage_filter,search *
windows_diskshadow_proxy_execution_filter,search *
windows_dism_remove_defender_filter,search *
windows_dll_search_order_hijacking_hunt_filter,search *
windows_dll_search_order_hijacking_hunt_with_sysmon_filter,search *
windows_dll_search_order_hijacking_with_iscsicpl_filter,search *
windows_dll_side_loading_in_calc_filter,search *
windows_dll_side_loading_process_child_of_calc_filter,search *
windows_dns_gather_network_info_filter,search *
windows_dnsadmins_new_member_added_filter,search *
windows_domain_account_discovery_via_get_netcomputer_filter,search *
windows_domain_admin_impersonation_indicator_filter,search *
windows_dotnet_binary_in_non_standard_path_filter,search *
windows_driver_inventory_filter,search *
windows_driver_load_non_standard_path_filter,search *
windows_drivers_loaded_by_signature_filter,search *
windows_enable_win32_scheduledjob_via_registry_filter,search *
windows_event_for_service_disabled_filter,search *
windows_event_log_cleared_filter,search *
windows_event_triggered_image_file_execution_options_injection_filter,search *
windows_excessive_disabled_services_event_filter,search *
windows_exchange_autodiscover_ssrf_abuse_filter,search *
windows_executable_in_loaded_modules_filter,search *
windows_execute_arbitrary_commands_with_msdt_filter,search *
windows_exfiltration_over_c2_via_invoke_restmethod_filter,search *
windows_exfiltration_over_c2_via_powershell_uploadstring_filter,search *
windows_export_certificate_filter,search *
windows_file_share_discovery_with_powerview_filter,search *
windows_file_transfer_protocol_in_non_common_process_path_filter,search *
windows_file_without_extension_in_critical_folder_filter,search *
windows_files_and_dirs_access_rights_modification_via_icacls_filter,search *
windows_find_domain_organizational_units_with_getdomainou_filter,search *
windows_find_interesting_acl_with_findinterestingdomainacl_filter,search *
windows_findstr_gpp_discovery_filter,search *
windows_forest_discovery_with_getforestdomain_filter,search *
windows_gather_victim_host_information_camera_filter,search *
windows_gather_victim_identity_sam_info_filter,search *
windows_gather_victim_network_info_through_ip_check_web_services_filter,search *
windows_get_adcomputer_unconstrained_delegation_discovery_filter,search *
windows_get_local_admin_with_findlocaladminaccess_filter,search *
windows_group_policy_object_created_filter,search *
windows_hidden_schedule_task_settings_filter,search *
windows_hide_notification_features_through_registry_filter,search *
windows_high_file_deletion_frequency_filter,search *
windows_hijack_execution_flow_version_dll_side_load_filter,search *
windows_hosts_file_modification_filter,search *
windows_hunting_system_account_targeting_lsass_filter,search *
windows_identify_protocol_handlers_filter,search *
windows_iis_components_add_new_module_filter,search *
windows_iis_components_get_webglobalmodule_module_query_filter,search *
windows_iis_components_module_failed_to_load_filter,search *
windows_iis_components_new_module_added_filter,search *
windows_impair_defense_add_xml_applocker_rules_filter,search *
windows_impair_defense_change_win_defender_health_check_intervals_filter,search *
windows_impair_defense_change_win_defender_quick_scan_interval_filter,search *
windows_impair_defense_change_win_defender_throttle_rate_filter,search *
windows_impair_defense_change_win_defender_tracing_level_filter,search *
windows_impair_defense_configure_app_install_control_filter,search *
windows_impair_defense_define_win_defender_threat_action_filter,search *
windows_impair_defense_delete_win_defender_context_menu_filter,search *
windows_impair_defense_delete_win_defender_profile_registry_filter,search *
windows_impair_defense_deny_security_software_with_applocker_filter,search *
windows_impair_defense_disable_controlled_folder_access_filter,search *
windows_impair_defense_disable_defender_firewall_and_network_filter,search *
windows_impair_defense_disable_defender_protocol_recognition_filter,search *
windows_impair_defense_disable_pua_protection_filter,search *
windows_impair_defense_disable_realtime_signature_delivery_filter,search *
windows_impair_defense_disable_web_evaluation_filter,search *
windows_impair_defense_disable_win_defender_app_guard_filter,search *
windows_impair_defense_disable_win_defender_compute_file_hashes_filter,search *
windows_impair_defense_disable_win_defender_gen_reports_filter,search *
windows_impair_defense_disable_win_defender_network_protection_filter,search *
windows_impair_defense_disable_win_defender_report_infection_filter,search *
windows_impair_defense_disable_win_defender_scan_on_update_filter,search *
windows_impair_defense_disable_win_defender_signature_retirement_filter,search *
windows_impair_defense_overide_win_defender_phishing_filter_filter,search *
windows_impair_defense_override_smartscreen_prompt_filter,search *
windows_impair_defense_set_win_defender_smart_screen_level_to_warn_filter,search *
windows_impair_defenses_disable_hvci_filter,search *
windows_impair_defenses_disable_win_defender_auto_logging_filter,search *
windows_indicator_removal_via_rmdir_filter,search *
windows_indirect_command_execution_via_forfiles_filter,search *
windows_indirect_command_execution_via_pcalua_filter,search *
windows_indirect_command_execution_via_series_of_forfiles_filter,search *
windows_information_discovery_fsutil_filter,search *
windows_ingress_tool_transfer_using_explorer_filter,search *
windows_input_capture_using_credential_ui_dll_filter,search *
windows_installutil_credential_theft_filter,search *
windows_installutil_in_non_standard_path_filter,search *
windows_installutil_remote_network_connection_filter,search *
windows_installutil_uninstall_option_filter,search *
windows_installutil_uninstall_option_with_network_filter,search *
windows_installutil_url_in_command_line_filter,search *
windows_iso_lnk_file_creation_filter,search *
windows_java_spawning_shells_filter,search *
windows_kerberos_local_successful_logon_filter,search *
windows_known_graphicalproton_loaded_modules_filter,search *
windows_krbrelayup_service_creation_filter,search *
windows_large_number_of_computer_service_tickets_requested_filter,search *
windows_lateral_tool_transfer_remcom_filter,search *
windows_ldifde_directory_object_behavior_filter,search *
windows_linked_policies_in_adsi_discovery_filter,search *
windows_local_administrator_credential_stuffing_filter,search *
windows_lsa_secrets_nolmhash_registry_filter,search *
windows_mail_protocol_in_non_common_process_path_filter,search *
windows_mark_of_the_web_bypass_filter,search *
windows_masquerading_explorer_as_child_process_filter,search *
windows_masquerading_msdtc_process_filter,search *
windows_mimikatz_binary_execution_filter,search *
windows_mimikatz_crypto_export_file_extensions_filter,search *
windows_modify_registry_authenticationleveloverride_filter,search *
windows_modify_registry_auto_minor_updates_filter,search *
windows_modify_registry_auto_update_notif_filter,search *
windows_modify_registry_default_icon_setting_filter,search *
windows_modify_registry_disable_restricted_admin_filter,search *
windows_modify_registry_disable_toast_notifications_filter,search *
windows_modify_registry_disable_win_defender_raw_write_notif_filter,search *
windows_modify_registry_disable_windefender_notifications_filter,search *
windows_modify_registry_disable_windows_security_center_notif_filter,search *
windows_modify_registry_disableremotedesktopantialias_filter,search *
windows_modify_registry_disablesecuritysettings_filter,search *
windows_modify_registry_disabling_wer_settings_filter,search *
windows_modify_registry_disallow_windows_app_filter,search *
windows_modify_registry_do_not_connect_to_win_update_filter,search *
windows_modify_registry_dontshowui_filter,search *
windows_modify_registry_enablelinkedconnections_filter,search *
windows_modify_registry_longpathsenabled_filter,search *
windows_modify_registry_maxconnectionperserver_filter,search *
windows_modify_registry_no_auto_reboot_with_logon_user_filter,search *
windows_modify_registry_no_auto_update_filter,search *
windows_modify_registry_nochangingwallpaper_filter,search *
windows_modify_registry_proxyenable_filter,search *
windows_modify_registry_proxyserver_filter,search *
windows_modify_registry_qakbot_binary_data_registry_filter,search *
windows_modify_registry_reg_restore_filter,search *
windows_modify_registry_regedit_silent_reg_import_filter,search *
windows_modify_registry_risk_behavior_filter,search *
windows_modify_registry_suppress_win_defender_notif_filter,search *
windows_modify_registry_tamper_protection_filter,search *
windows_modify_registry_updateserviceurlalternate_filter,search *
windows_modify_registry_usewuserver_filter,search *
windows_modify_registry_with_md5_reg_key_name_filter,search *
windows_modify_registry_wuserver_filter,search *
windows_modify_registry_wustatusserver_filter,search *
windows_modify_show_compress_color_and_info_tip_registry_filter,search *
windows_modify_system_firewall_with_notable_process_path_filter,search *
windows_mof_event_triggered_execution_via_wmi_filter,search *
windows_moveit_transfer_writing_aspx_filter,search *
windows_msexchange_management_mailbox_cmdlet_usage_filter,search *
windows_mshta_execution_in_registry_filter,search *
windows_msiexec_dllregisterserver_filter,search *
windows_msiexec_hidewindow_rundll32_execution_filter,search *
windows_msiexec_remote_download_filter,search *
windows_msiexec_spawn_discovery_command_filter,search *
windows_msiexec_spawn_windbg_filter,search *
windows_msiexec_unregister_dllregisterserver_filter,search *
windows_msiexec_with_network_connections_filter,search *
windows_multi_hop_proxy_tor_website_query_filter,search *
windows_multiple_disabled_users_failed_to_authenticate_wth_kerberos_filter,search *
windows_multiple_invalid_users_fail_to_authenticate_using_kerberos_filter,search *
windows_multiple_invalid_users_failed_to_authenticate_using_ntlm_filter,search *
windows_multiple_users_fail_to_authenticate_wth_explicitcredentials_filter,search *
windows_multiple_users_failed_to_authenticate_from_host_using_ntlm_filter,search *
windows_multiple_users_failed_to_authenticate_from_process_filter,search *
windows_multiple_users_failed_to_authenticate_using_kerberos_filter,search *
windows_multiple_users_remotely_failed_to_authenticate_from_host_filter,search *
windows_ngrok_reverse_proxy_usage_filter,search *
windows_nirsoft_advancedrun_filter,search *
windows_nirsoft_utilities_filter,search *
windows_njrat_fileless_storage_via_registry_filter,search *
windows_non_system_account_targeting_lsass_filter,search *
windows_odbcconf_hunting_filter,search *
windows_odbcconf_load_dll_filter,search *
windows_odbcconf_load_response_file_filter,search *
windows_office_product_spawning_msdt_filter,search *
windows_papercut_ng_spawn_shell_filter,search *
windows_parent_pid_spoofing_with_explorer_filter,search *
windows_password_managers_discovery_filter,search *
windows_phishing_pdf_file_executes_url_link_filter,search *
windows_phishing_recent_iso_exec_registry_filter,search *
windows_possible_credential_dumping_filter,search *
windows_post_exploitation_risk_behavior_filter,search *
windows_powershell_add_module_to_global_assembly_cache_filter,search *
windows_powershell_cryptography_namespace_filter,search *
windows_powershell_disable_http_logging_filter,search *
windows_powershell_export_certificate_filter,search *
windows_powershell_export_pfxcertificate_filter,search *
windows_powershell_get_ciminstance_remote_computer_filter,search *
windows_powershell_iis_components_webglobalmodule_usage_filter,search *
windows_powershell_import_applocker_policy_filter,search *
windows_powershell_remotesigned_file_filter,search *
windows_powershell_scheduletask_filter,search *
windows_powershell_wmi_win32_scheduledjob_filter,search *
windows_powersploit_gpp_discovery_filter,search *
windows_powerview_ad_access_control_list_enumeration_filter,search *
windows_powerview_constrained_delegation_discovery_filter,search *
windows_powerview_kerberos_service_ticket_request_filter,search *
windows_powerview_spn_discovery_filter,search *
windows_powerview_unconstrained_delegation_discovery_filter,search *
windows_private_keys_discovery_filter,search *
windows_process_commandline_discovery_filter,search *
windows_process_injection_in_non_service_searchindexer_filter,search *
windows_process_injection_into_notepad_filter,search *
windows_process_injection_of_wermgr_to_known_browser_filter,search *
windows_process_injection_remote_thread_filter,search *
windows_process_injection_wermgr_child_process_filter,search *
windows_process_injection_with_public_source_path_filter,search *
windows_process_with_namedpipe_commandline_filter,search *
windows_processes_killed_by_industroyer2_malware_filter,search *
windows_protocol_tunneling_with_plink_filter,search *
windows_proxy_via_netsh_filter,search *
windows_proxy_via_registry_filter,search *
windows_query_registry_browser_list_application_filter,search *
windows_query_registry_reg_save_filter,search *
windows_query_registry_uninstall_program_list_filter,search *
windows_raccine_scheduled_task_deletion_filter,search *
windows_rapid_authentication_on_multiple_hosts_filter,search *
windows_rasautou_dll_execution_filter,search *
windows_raw_access_to_disk_volume_partition_filter,search *
windows_raw_access_to_master_boot_record_drive_filter,search *
windows_rdp_connection_successful_filter,search *
windows_registry_bootexecute_modification_filter,search *
windows_registry_certificate_added_filter,search *
windows_registry_delete_task_sd_filter,search *
windows_registry_modification_for_safe_mode_persistence_filter,search *
windows_registry_payload_injection_filter,search *
windows_registry_sip_provider_modification_filter,search *
windows_regsvr32_renamed_binary_filter,search *
windows_remote_access_software_brc4_loaded_dll_filter,search *
windows_remote_access_software_hunt_filter,search *
windows_remote_access_software_rms_registry_filter,search *
windows_remote_assistance_spawning_process_filter,search *
windows_remote_create_service_filter,search *
windows_remote_service_rdpwinst_tool_execution_filter,search *
windows_remote_services_allow_rdp_in_firewall_filter,search *
windows_remote_services_allow_remote_assistance_filter,search *
windows_remote_services_rdp_enable_filter,search *
windows_replication_through_removable_media_filter,search *
windows_root_domain_linked_policies_discovery_filter,search *
windows_rundll32_apply_user_settings_changes_filter,search *
windows_rundll32_webdav_request_filter,search *
windows_rundll32_webdav_with_network_connection_filter,search *
windows_scheduled_task_created_via_xml_filter,search *
windows_scheduled_task_service_spawned_shell_filter,search *
windows_scheduled_task_with_highest_privileges_filter,search *
windows_schtasks_create_run_as_system_filter,search *
windows_screen_capture_via_powershell_filter,search *
windows_security_account_manager_stopped_filter,search *
windows_security_support_provider_reg_query_filter,search *
windows_server_software_component_gacutil_install_to_gac_filter,search *
windows_service_create_kernel_mode_driver_filter,search *
windows_service_create_remcomsvc_filter,search *
windows_service_create_sliverc2_filter,search *
windows_service_create_with_tscon_filter,search *
windows_service_created_with_suspicious_service_path_filter,search *
windows_service_created_within_public_path_filter,search *
windows_service_creation_on_remote_endpoint_filter,search *
windows_service_creation_using_registry_entry_filter,search *
windows_service_deletion_in_registry_filter,search *
windows_service_initiation_on_remote_endpoint_filter,search *
windows_service_stop_by_deletion_filter,search *
windows_service_stop_via_net__and_sc_application_filter,search *
windows_service_stop_win_updates_filter,search *
windows_shells,(Processes.process_name=cmd.exe OR Processes.process_name=powershell.exe OR Processes.process_name=pwsh.exe OR Processes.process_name=sh.exe OR Processes.process_name=bash.exe OR Processes.process_name=wscript.exe OR Processes.process_name=cscript.exe)
windows_sip_provider_inventory_filter,search *
windows_sip_winverifytrust_failed_trust_validation_filter,search *
windows_snake_malware_file_modification_crmlog_filter,search *
windows_snake_malware_kernel_driver_comadmin_filter,search *
windows_snake_malware_registry_modification_wav_openwithprogids_filter,search *
windows_snake_malware_service_create_filter,search *
windows_spearphishing_attachment_connect_to_none_ms_office_domain_filter,search *
windows_spearphishing_attachment_onenote_spawn_mshta_filter,search *
windows_special_privileged_logon_on_multiple_hosts_filter,search *
windows_sql_spawning_certutil_filter,search *
windows_steal_authentication_certificates___esc1_abuse_filter,search *
windows_steal_authentication_certificates___esc1_authentication_filter,search *
windows_steal_authentication_certificates_certificate_issued_filter,search *
windows_steal_authentication_certificates_certificate_request_filter,search *
windows_steal_authentication_certificates_certutil_backup_filter,search *
windows_steal_authentication_certificates_cryptoapi_filter,search *
windows_steal_authentication_certificates_cs_backup_filter,search *
windows_steal_authentication_certificates_export_certificate_filter,search *
windows_steal_authentication_certificates_export_pfxcertificate_filter,search *
windows_steal_or_forge_kerberos_tickets_klist_filter,search *
windows_suspect_process_with_authentication_traffic_filter,search *
windows_system_binary_proxy_execution_compiled_html_file_decompile_filter,search *
windows_system_discovery_using_ldap_nslookup_filter,search *
windows_system_discovery_using_qwinsta_filter,search *
windows_system_file_on_disk_filter,search *
windows_system_logoff_commandline_filter,search *
windows_system_network_config_discovery_display_dns_filter,search *
windows_system_network_connections_discovery_netsh_filter,search *
windows_system_reboot_commandline_filter,search *
windows_system_script_proxy_execution_syncappvpublishingserver_filter,search *
windows_system_shutdown_commandline_filter,search *
windows_system_time_discovery_w32tm_delay_filter,search *
windows_system_user_discovery_via_quser_filter,search *
windows_system_user_privilege_discovery_filter,search *
windows_terminating_lsass_process_filter,search *
windows_time_based_evasion_filter,search *
windows_uac_bypass_suspicious_child_process_filter,search *
windows_uac_bypass_suspicious_escalation_behavior_filter,search *
windows_unsigned_dll_side_loading_filter,search *
windows_unusual_count_of_disabled_users_failed_auth_using_kerberos_filter,search *
windows_unusual_count_of_invalid_users_fail_to_auth_using_kerberos_filter,search *
windows_unusual_count_of_invalid_users_failed_to_auth_using_ntlm_filter,search *
windows_unusual_count_of_users_fail_to_auth_wth_explicitcredentials_filter,search *
windows_unusual_count_of_users_failed_to_auth_using_kerberos_filter,search *
windows_unusual_count_of_users_failed_to_authenticate_from_process_filter,search *
windows_unusual_count_of_users_failed_to_authenticate_using_ntlm_filter,search *
windows_unusual_count_of_users_remotely_failed_to_auth_from_host_filter,search *
windows_user_execution_malicious_url_shortcut_file_filter,search *
windows_valid_account_with_never_expires_password_filter,search *
windows_vulnerable_3cx_software_filter,search *
windows_vulnerable_driver_loaded_filter,search *
windows_windbg_spawning_autoit3_filter,search *
windows_winlogon_with_public_network_connection_filter,search *
windows_wmi_impersonate_token_filter,search *
windows_wmi_process_and_service_list_filter,search *
windows_wmi_process_call_create_filter,search *
winevent_scheduled_task_created_to_spawn_shell_filter,search *
winevent_scheduled_task_created_within_public_path_filter,search *
winevent_windows_task_scheduler_event_action_started_filter,search *
wineventlog_application,"eventtype=wineventlog_application OR source=""XmlWinEventLog:Application"""
wineventlog_security,eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
wineventlog_system,eventtype=wineventlog_system
wineventlog_task_scheduler,"source=""WinEventLog:Microsoft-Windows-TaskScheduler/Operational"""
winhlp32_spawning_a_process_filter,search *
winrar_spawning_shell_application_filter,search *
winrm_spawning_a_process_filter,search *
winword_spawning_cmd_filter,search *
winword_spawning_powershell_filter,search *
winword_spawning_windows_script_host_filter,search *
wmi,"sourcetype=""wineventlog:microsoft-windows-wmi-activity/operational"""
wmi_permanent_event_subscription___sysmon_filter,search *
wmi_permanent_event_subscription_filter,search *
wmi_recon_running_process_or_services_filter,search *
wmi_temporary_event_subscription_filter,search *
wmic_group_discovery_filter,search *
wmic_noninteractive_app_uninstallation_filter,search *
wmic_xsl_execution_via_url_filter,search *
wmiprsve_lolbas_execution_process_spawn_filter,search *
ws_ftp_remote_code_execution_filter,search *
wscript_or_cscript_suspicious_child_process_filter,search *
wsmprovhost_lolbas_execution_process_spawn_filter,search *
wsreset_uac_bypass_filter,search *
xmrig_driver_loaded_filter,search *
xsl_script_execution_with_wmic_filter,search *
zeek_rpc,"index=zeek sourcetype=""zeek:rpc:json"""
zeek_ssl,"index=zeek sourcetype=""zeek:ssl:json"""
zeek_x509,"sourcetype=""zeek:x509:json"""
zeek_x509_certificate_with_punycode_filter,search *
7zip_commandline_to_smb_share_path_filter,search *
linux_audit_data,`randomdata` sourcetype=linux_audit
randomdata,index=main
srcheval(1),"if(pi()>10, ""search sourcetype=\""aws*\"""", ""search sourcetype=\""citrix*\"""")"
texp(2),sourcetype=$v1$
texp1(1),sourcetype=plunkd
